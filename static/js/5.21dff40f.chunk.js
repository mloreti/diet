/*! For license information please see 5.21dff40f.chunk.js.LICENSE.txt */
(this.webpackJsonpdiet=this.webpackJsonpdiet||[]).push([[5],{41:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=(r=n(20))&&"object"==typeof r&&"default"in r?r.default:r,s=n(22),u=n(13),a=n(21),h=n(42),c=o.SDK_VERSION,f=function(){function t(t){this.uid=t}return t.prototype.t=function(){return null!=this.uid},t.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();f.UNAUTHENTICATED=new f(null),f.i=new f("google-credentials-uid"),f.h=new f("first-party-uid");var l={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},p=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return i.__extends(e,t),e}(Error),d=function(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t},y=function(){function t(){this.u=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype._=function(){},t.prototype.l=function(t){this.u=t,t(f.UNAUTHENTICATED)},t.prototype.T=function(){this.u=null},t}(),v=function(){function t(t){var e=this;this.I=null,this.currentUser=f.UNAUTHENTICATED,this.R=!1,this.m=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.m++,e.currentUser=e.A(),e.R=!0,e.u&&e.u(e.currentUser)},this.m=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then((function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.m,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){if(t.m!==e)throw new p(l.ABORTED,"getToken aborted due to token change.");return n?(Ee("string"==typeof n.accessToken),new d(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype._=function(){this.forceRefresh=!0},t.prototype.l=function(t){this.u=t,this.R&&t(this.currentUser)},t.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},t.prototype.A=function(){var t=this.auth&&this.auth.getUid();return Ee(null===t||"string"==typeof t),new f(t)},t}(),g=function(){function t(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=f.h}return Object.defineProperty(t.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.g([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),m=function(){function t(t,e){this.P=t,this.V=e}return t.prototype.getToken=function(){return Promise.resolve(new g(this.P,this.V))},t.prototype.l=function(t){t(f.h)},t.prototype.T=function(){},t.prototype._=function(){},t}(),w=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new p(l.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new p(l.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new p(l.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new p(l.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.p=function(t){return this.seconds===t.seconds?Ie(this.nanoseconds,t.nanoseconds):Ie(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),b=function(){function t(t){this.timestamp=t}return t.v=function(e){return new t(e)},t.min=function(){return new t(new w(0,0))},t.prototype.S=function(t){return this.timestamp.p(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.C=function(){return this.timestamp},t}(),E=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&be(),void 0===n?n=t.length-e:n>t.length-e&&be(),this.segments=t,this.offset=e,this.F=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.N(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.k(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.$=function(t){return t=void 0===t?1:t,this.k(this.segments,this.offset+t,this.length-t)},t.prototype.M=function(){return this.k(this.segments,this.offset,this.length-1)},t.prototype.L=function(){return this.segments[this.offset]},t.prototype.O=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.B=function(){return 0===this.length},t.prototype.q=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},t.N=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.k=function(t,n,r){return new e(t,n,r)},e.prototype.j=function(){return this.W().join("/")},e.prototype.toString=function(){return this.j()},e.K=function(t){if(t.indexOf("//")>=0)throw new p(l.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter((function(t){return t.length>0})))},e}(E);_.G=new _([]);var T=/^[_a-zA-Z][_a-zA-Z0-9]*$/,I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.k=function(t,n,r){return new e(t,n,r)},e.H=function(t){return T.test(t)},e.prototype.j=function(){return this.W().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.H(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.j()},e.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},e.J=function(){return new e(["__name__"])},e.X=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new p(l.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new p(l.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new p(l.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new p(l.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e}(E);I.G=new I([]);var N=function(){function t(t){this.path=t}return t.Z=function(e){return new t(_.K(e).$(5))},t.prototype.tt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===_.N(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.N=function(t,e){return _.N(t.path,e.path)},t.et=function(t){return t.length%2==0},t.st=function(e){return new t(new _(e.slice()))},t}();function A(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function x(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function S(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}N.EMPTY=new N(new _([]));var k=function(){function t(t){this.it=t}return t.fromBase64String=function(e){return new t(pe.nt().atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return pe.nt().btoa(this.it)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},t.prototype.rt=function(){return 2*this.it.length},t.prototype.S=function(t){return Ie(this.it,t.it)},t.prototype.isEqual=function(t){return this.it===t.it},t}();function L(t){return null==t}function D(t){return-0===t&&1/t==-1/0}function R(t){return"number"==typeof t&&Number.isInteger(t)&&!D(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function O(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function P(t){var e=B(t.mapValue.fields.__local_write_time__.timestampValue);return new w(e.seconds,e.nanos)}k.ht=new k("");var C=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function V(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?O(t)?4:10:be()}function M(t,e){var n=V(t);if(n!==V(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return P(t).isEqual(P(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=B(t.timestampValue),r=B(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return z(t.bytesValue).isEqual(z(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return G(t.geoPointValue.latitude)===G(e.geoPointValue.latitude)&&G(t.geoPointValue.longitude)===G(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return G(t.integerValue)===G(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=G(t.doubleValue),r=G(e.doubleValue);return n===r?D(n)===D(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ne(t.arrayValue.values||[],e.arrayValue.values||[],M);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(A(n)!==A(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!M(n[i],r[i])))return!1;return!0}(t,e);default:return be()}}function U(t,e){return void 0!==(t.values||[]).find((function(t){return M(t,e)}))}function q(t,e){var n=V(t),r=V(e);if(n!==r)return Ie(n,r);switch(n){case 0:return 0;case 1:return Ie(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=G(t.integerValue||t.doubleValue),r=G(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return j(t.timestampValue,e.timestampValue);case 4:return j(P(t),P(e));case 5:return Ie(t.stringValue,e.stringValue);case 6:return function(t,e){var n=z(t),r=z(e);return n.S(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ie(n[i],r[i]);if(0!==o)return o}return Ie(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Ie(G(t.latitude),G(e.latitude));return 0!==n?n:Ie(G(t.longitude),G(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=q(n[i],r[i]);if(o)return o}return Ie(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ie(r[s],o[s]);if(0!==u)return u;var a=q(n[r[s]],i[o[s]]);if(0!==a)return a}return Ie(r.length,o.length)}(t.mapValue,e.mapValue);default:throw be()}}function j(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ie(t,e);var n=B(t),r=B(e),i=Ie(n.seconds,r.seconds);return 0!==i?i:Ie(n.nanos,r.nanos)}function F(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=B(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?z(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,N.Z(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=t(s)}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):be();var n,r}(t)}function B(t){if(Ee(!!t),"string"==typeof t){var e=0,n=C.exec(t);if(Ee(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:G(t.seconds),nanos:G(t.nanos)}}function G(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function z(t){return"string"==typeof t?k.fromBase64String(t):k.fromUint8Array(t)}function W(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function K(t){return!!t&&"integerValue"in t}function H(t){return!!t&&"arrayValue"in t}function X(t){return!!t&&"nullValue"in t}function Y(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Q(t){return!!t&&"mapValue"in t}var J=function(){function t(){}return t.prototype.ot=function(t,e){return function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(e,t)},t.prototype.at=function(t,e){return e},t.prototype.ut=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t}();J.instance=new J;var Z=function(){function t(t){this.elements=t}return t.prototype.ot=function(t,e){return this.apply(t)},t.prototype.at=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=et(t),n=function(t){e.some((function(e){return M(e,t)}))||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.ut=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&Ne(this.elements,e.elements,M)},t}(),$=function(){function t(t){this.elements=t}return t.prototype.ot=function(t,e){return this.apply(t)},t.prototype.at=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=et(t),n=function(t){e=e.filter((function(e){return!M(e,t)}))},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.ut=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&Ne(this.elements,e.elements,M)},t}(),tt=function(){function t(t,e){this.serializer=t,this.ct=e}return t.prototype.ot=function(t,e){var n=this.ut(t),r=this.asNumber(n)+this.asNumber(this.ct);return K(n)&&K(this.ct)?this.serializer._t(r):this.serializer.lt(r)},t.prototype.at=function(t,e){return e},t.prototype.ut=function(t){return K(e=t)||function(t){return!!t&&"doubleValue"in t}(e)?t:{integerValue:0};var e},t.prototype.isEqual=function(e){return e instanceof t&&M(this.ct,e.ct)},t.prototype.asNumber=function(t){return G(t.integerValue||t.doubleValue)},t}();function et(t){return H(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var nt=function(){function t(t){this.fields=t,t.sort(I.N)}return t.prototype.dt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].q(t))return!0;return!1},t.prototype.isEqual=function(t){return Ne(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),rt=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),it=function(t,e){this.version=t,this.transformResults=e},ot=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.ft=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Tt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.Et=function(t){return void 0!==this.updateTime?t instanceof mt&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof mt},t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}(),st=function(){function t(){}return t.prototype.It=function(t){},t.wt=function(t){return t instanceof mt?t.version:b.min()},t}(),ut=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Rt=r,i.type=0,i}return i.__extends(e,t),e.prototype.at=function(t,e){this.It(t);var n=e.version;return new mt(this.key,n,this.value,{hasCommittedMutations:!0})},e.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=st.wt(t);return new mt(this.key,r,this.value,{At:!0})},e.prototype.Pt=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},e}(st),at=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Vt=r,o.Rt=i,o.type=1,o}return i.__extends(e,t),e.prototype.at=function(t,e){if(this.It(t),!this.Rt.Et(t))return new bt(this.key,e.version);var n=this.gt(t);return new mt(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=st.wt(t),i=this.gt(t);return new mt(this.key,r,i,{At:!0})},e.prototype.Pt=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},e.prototype.gt=function(t){var e;return e=t instanceof mt?t.data():lt.empty(),this.pt(e)},e.prototype.pt=function(t){var e=this,n=new pt(t);return this.Vt.fields.forEach((function(t){if(!t.B()){var r=e.data.field(t);null!==r?n.set(t,r):n.delete(t)}})),n.yt()},e}(st),ht=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Rt=ot.exists(!0),r}return i.__extends(e,t),e.prototype.at=function(t,e){if(this.It(t),Ee(null!=e.transformResults),!this.Rt.Et(t))return new bt(this.key,e.version);var n=this.bt(t),r=this.vt(t,e.transformResults),i=e.version,o=this.St(n.data(),r);return new mt(this.key,i,o,{hasCommittedMutations:!0})},e.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=this.bt(t),i=this.Dt(n,t,e),o=this.St(r.data(),i);return new mt(this.key,r.version,o,{At:!0})},e.prototype.Pt=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof mt?t.field(i.field):void 0,s=i.transform.ut(o||null);null!=s&&(e=null==e?(new pt).set(i.field,s):e.set(i.field,s))}return e?e.yt():null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&Ne(this.fieldTransforms,t.fieldTransforms,(function(t,e){return t.isEqual(e)}))&&this.Rt.isEqual(t.Rt)},e.prototype.bt=function(t){return t},e.prototype.vt=function(t,e){var n=[];Ee(this.fieldTransforms.length===e.length);for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof mt&&(s=t.field(i.field)),n.push(o.at(s,e[r]))}return n},e.prototype.Dt=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],u=s.transform,a=null;e instanceof mt&&(a=e.field(s.field)),null===a&&n instanceof mt&&(a=n.field(s.field)),r.push(u.ot(a,t))}return r},e.prototype.St=function(t,e){for(var n=new pt(t),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.yt()},e}(st),ct=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Rt=n,r.type=3,r}return i.__extends(e,t),e.prototype.at=function(t,e){return this.It(t),new wt(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.ot=function(t,e,n){return this.It(t),this.Rt.Et(t)?new wt(this.key,b.min()):t},e.prototype.Pt=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},e}(st),ft=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Rt=n,r.type=4,r}return i.__extends(e,t),e.prototype.at=function(t,e){be()},e.prototype.ot=function(t,e,n){be()},e.prototype.Pt=function(t){be()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},e}(st),lt=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.B())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Q(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},t.prototype.isEqual=function(t){return M(this.proto,t.proto)},t}(),pt=function(){function t(t){void 0===t&&(t=lt.empty()),this.Ct=t,this.Ft=new Map}return t.prototype.set=function(t,e){return this.Nt(t,e),this},t.prototype.delete=function(t){return this.Nt(t,null),this},t.prototype.Nt=function(t,e){for(var n=this.Ft,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===V(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.O(),e)},t.prototype.yt=function(){var t=this.kt(I.G,this.Ft);return null!=t?new lt(t):this.Ct},t.prototype.kt=function(t,e){var n=this,r=!1,i=this.Ct.field(t),o=Q(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.kt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function dt(t){var e=[];return x(t.fields||{},(function(t,n){var r=new I([t]);if(Q(n)){var i=dt(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)})),new nt(e)}var yt,vt,gt=function(t,e){this.key=t,this.version=e},mt=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).$t=r,o.At=!!i.At,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return i.__extends(e,t),e.prototype.field=function(t){return this.$t.field(t)},e.prototype.data=function(){return this.$t},e.prototype.Mt=function(){return this.$t.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.$t.isEqual(t.$t)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.$t.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e}(gt),wt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return i.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(gt),bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(gt),Et=function(){function t(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Lt=null}return t.prototype.canonicalId=function(){if(null===this.Lt){var t=this.path.j();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map((function(t){return t.canonicalId()})).join(","),t+="|ob:",t+=this.orderBy.map((function(t){return t.canonicalId()})).join(","),L(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Lt=t}return this.Lt},t.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),L(this.limit)||(t+=", limit: "+this.limit),this.orderBy.length>0&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},t.prototype.xt=function(){return N.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}(),_t=function(){function t(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Ot=n,this.filters=r,this.limit=i,this.Bt=o,this.startAt=s,this.endAt=u,this.qt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}return t.Wt=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.qt){this.qt=[];var t=this.jt(),e=this.Kt();if(null!==t&&null===e)t.Y()||this.qt.push(new Lt(t)),this.qt.push(new Lt(I.J(),"asc"));else{for(var n=!1,r=0,i=this.Ot;r<i.length;r++){var o=i[r];this.qt.push(o),o.field.Y()&&(n=!0)}if(!n){var s=this.Ot.length>0?this.Ot[this.Ot.length-1].dir:"asc";this.qt.push(new Lt(I.J(),s))}}}return this.qt},enumerable:!0,configurable:!0}),t.prototype.Gt=function(e){var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.Ot.slice(),n,this.limit,this.Bt,this.startAt,this.endAt)},t.prototype.zt=function(e){var n=this.Ot.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},t.prototype.Ht=function(e){return new t(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),e,"F",this.startAt,this.endAt)},t.prototype.Yt=function(e){return new t(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),e,"L",this.startAt,this.endAt)},t.prototype.Jt=function(e){return new t(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),this.limit,this.Bt,e,this.endAt)},t.prototype.Xt=function(e){return new t(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,e)},t.prototype.Zt=function(e){return new t(e,null,this.Ot.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},t.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ot.length||1===this.Ot.length&&this.Ot[0].field.Y())},t.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.Bt},t.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.Bt+")"},t.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.Bt===t.Bt},t.prototype.se=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},t.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},t.prototype.oe=function(){return!L(this.limit)&&"F"===this.Bt},t.prototype.ae=function(){return!L(this.limit)&&"L"===this.Bt},t.prototype.Kt=function(){return this.Ot.length>0?this.Ot[0].field:null},t.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Tt&&n.ue())return n.field}return null},t.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Tt&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.xt=function(){return this.ee().xt()},t.prototype._e=function(){return null!==this.collectionGroup},t.prototype.ee=function(){if(!this.Ut)if("F"===this.Bt)this.Ut=new Et(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new Lt(r.field,i))}var o=this.endAt?new kt(this.endAt.position,!this.endAt.before):null,s=this.startAt?new kt(this.startAt.position,!this.startAt.before):null;this.Ut=new Et(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},t.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.q(e):N.et(this.path)?this.path.isEqual(e):this.path.U(e)},t.prototype.ne=function(t){for(var e=0,n=this.Ot;e<n.length;e++){var r=n[e];if(!r.field.Y()&&null===t.field(r.field))return!1}return!0},t.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.he=function(t){return!(this.startAt&&!this.startAt.le(this.orderBy,t)||this.endAt&&this.endAt.le(this.orderBy,t))},t.prototype.Qt=function(t){},t}(),Tt=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return i.__extends(e,t),e.create=function(t,n,r){if(t.Y())return"in"===n?new Nt(t,r):new It(t,n,r);if(X(r)){if("=="!==n)throw new p(l.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(Y(r)){if("=="!==n)throw new p(l.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return"array-contains"===n?new At(t,r):"in"===n?new xt(t,r):"array-contains-any"===n?new St(t,r):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&V(this.value)===V(e)&&this.de(q(e,this.value))},e.prototype.de=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return t>0;case">=":return t>=0;default:return be()}},e.prototype.ue=function(){return["<","<=",">",">="].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+F(this.value)},e.prototype.isEqual=function(t){return t instanceof e&&this.op===t.op&&this.field.isEqual(t.field)&&M(this.value,t.value)},e.prototype.toString=function(){return this.field.j()+" "+this.op+" "+F(this.value)},e}((function(){})),It=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=N.Z(r.referenceValue),i}return i.__extends(e,t),e.prototype.matches=function(t){var e=N.N(t.key,this.key);return this.de(e)},e}(Tt),Nt=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=(n.arrayValue.values||[]).map((function(t){return N.Z(t.referenceValue)})),r}return i.__extends(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Tt),At=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return i.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return H(e)&&U(e.arrayValue,this.value)},e}(Tt),xt=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return i.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&U(this.value.arrayValue,e)},e}(Tt),St=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return i.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!H(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return U(e.value.arrayValue,t)}))},e}(Tt),kt=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map((function(t){return F(t)})).join(",")},t.prototype.le=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(n=i.field.Y()?N.N(N.Z(o.referenceValue),e.key):q(o,e.field(i.field)),"desc"===i.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!M(this.position[e],t.position[e]))return!1;return!0},t}(),Lt=function(){function t(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.fe=t.Y()}return t.prototype.compare=function(t,e){var n=this.fe?N.N(t.key,e.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?q(r,i):be()}(this.field,t,e);switch(this.dir){case"asc":return n;case"desc":return-1*n;default:return be()}},t.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},t.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),Dt=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=b.min()),void 0===o&&(o=b.min()),void 0===s&&(s=k.ht),this.target=t,this.targetId=e,this.Te=n,this.sequenceNumber=r,this.Ee=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Ie=function(e){return new t(this.target,this.targetId,this.Te,e,this.Ee,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.we=function(e,n){return new t(this.target,this.targetId,this.Te,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Re=function(e){return new t(this.target,this.targetId,this.Te,this.sequenceNumber,this.Ee,e,this.resumeToken)},t}(),Rt=function(t){this.count=t};function Ot(t){switch(t){case l.OK:return be();case l.CANCELLED:case l.UNKNOWN:case l.DEADLINE_EXCEEDED:case l.RESOURCE_EXHAUSTED:case l.INTERNAL:case l.UNAVAILABLE:case l.UNAUTHENTICATED:return!1;case l.INVALID_ARGUMENT:case l.NOT_FOUND:case l.ALREADY_EXISTS:case l.PERMISSION_DENIED:case l.FAILED_PRECONDITION:case l.ABORTED:case l.OUT_OF_RANGE:case l.UNIMPLEMENTED:case l.DATA_LOSS:return!0;default:return be()}}function Pt(t){if(void 0===t)return me("GRPC error has no .code"),l.UNKNOWN;switch(t){case yt.OK:return l.OK;case yt.CANCELLED:return l.CANCELLED;case yt.UNKNOWN:return l.UNKNOWN;case yt.DEADLINE_EXCEEDED:return l.DEADLINE_EXCEEDED;case yt.RESOURCE_EXHAUSTED:return l.RESOURCE_EXHAUSTED;case yt.INTERNAL:return l.INTERNAL;case yt.UNAVAILABLE:return l.UNAVAILABLE;case yt.UNAUTHENTICATED:return l.UNAUTHENTICATED;case yt.INVALID_ARGUMENT:return l.INVALID_ARGUMENT;case yt.NOT_FOUND:return l.NOT_FOUND;case yt.ALREADY_EXISTS:return l.ALREADY_EXISTS;case yt.PERMISSION_DENIED:return l.PERMISSION_DENIED;case yt.FAILED_PRECONDITION:return l.FAILED_PRECONDITION;case yt.ABORTED:return l.ABORTED;case yt.OUT_OF_RANGE:return l.OUT_OF_RANGE;case yt.UNIMPLEMENTED:return l.UNIMPLEMENTED;case yt.DATA_LOSS:return l.DATA_LOSS;default:return be()}}(vt=yt||(yt={}))[vt.OK=0]="OK",vt[vt.CANCELLED=1]="CANCELLED",vt[vt.UNKNOWN=2]="UNKNOWN",vt[vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",vt[vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",vt[vt.NOT_FOUND=5]="NOT_FOUND",vt[vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",vt[vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",vt[vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",vt[vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",vt[vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",vt[vt.ABORTED=10]="ABORTED",vt[vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",vt[vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",vt[vt.INTERNAL=13]="INTERNAL",vt[vt.UNAVAILABLE=14]="UNAVAILABLE",vt[vt.DATA_LOSS=15]="DATA_LOSS";var Ct=function(){function t(t,e){this.N=t,this.root=e||Mt.EMPTY}return t.prototype.me=function(e,n){return new t(this.N,this.root.me(e,n,this.N).Ae(null,null,Mt.Pe,null,null))},t.prototype.remove=function(e){return new t(this.N,this.root.remove(e,this.N).Ae(null,null,Mt.Pe,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.B();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.B();){var r=this.N(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.B=function(){return this.root.B()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.Ve=function(){return this.root.Ve()},t.prototype.ge=function(){return this.root.ge()},t.prototype.pe=function(t){return this.root.pe(t)},t.prototype.forEach=function(t){this.pe((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.pe((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.ye=function(t){return this.root.ye(t)},t.prototype.be=function(){return new Vt(this.root,null,this.N,!1)},t.prototype.ve=function(t){return new Vt(this.root,t,this.N,!1)},t.prototype.Se=function(){return new Vt(this.root,null,this.N,!0)},t.prototype.De=function(t){return new Vt(this.root,t,this.N,!0)},t}(),Vt=function(){function t(t,e,n,r){this.Ce=r,this.Fe=[];for(var i=1;!t.B();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ce?t.left:t.right;else{if(0===i){this.Fe.push(t);break}this.Fe.push(t),t=this.Ce?t.right:t.left}}return t.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.Ce)for(t=t.left;!t.B();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.B();)this.Fe.push(t),t=t.left;return e},t.prototype.ke=function(){return this.Fe.length>0},t.prototype.$e=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},t}(),Mt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.Ae=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.B=function(){return!1},t.prototype.pe=function(t){return this.left.pe(t)||t(this.key,this.value)||this.right.pe(t)},t.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},t.prototype.min=function(){return this.left.B()?this:this.left.min()},t.prototype.Ve=function(){return this.min().key},t.prototype.ge=function(){return this.right.B()?this.key:this.right.ge()},t.prototype.me=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.Ae(null,null,null,r.left.me(t,e,n),null):0===i?r.Ae(null,e,null,null,null):r.Ae(null,null,null,null,r.right.me(t,e,n))).Me()},t.prototype.Le=function(){if(this.left.B())return t.EMPTY;var e=this;return e.left.xe()||e.left.left.xe()||(e=e.Oe()),(e=e.Ae(null,null,null,e.left.Le(),null)).Me()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.B()||i.left.xe()||i.left.left.xe()||(i=i.Oe()),i=i.Ae(null,null,null,i.left.remove(e,n),null);else{if(i.left.xe()&&(i=i.Be()),i.right.B()||i.right.xe()||i.right.left.xe()||(i=i.qe()),0===n(e,i.key)){if(i.right.B())return t.EMPTY;r=i.right.min(),i=i.Ae(r.key,r.value,null,null,i.right.Le())}i=i.Ae(null,null,null,null,i.right.remove(e,n))}return i.Me()},t.prototype.xe=function(){return this.color},t.prototype.Me=function(){var t=this;return t.right.xe()&&!t.left.xe()&&(t=t.Ue()),t.left.xe()&&t.left.left.xe()&&(t=t.Be()),t.left.xe()&&t.right.xe()&&(t=t.Qe()),t},t.prototype.Oe=function(){var t=this.Qe();return t.right.left.xe()&&(t=(t=(t=t.Ae(null,null,null,null,t.right.Be())).Ue()).Qe()),t},t.prototype.qe=function(){var t=this.Qe();return t.left.left.xe()&&(t=(t=t.Be()).Qe()),t},t.prototype.Ue=function(){var e=this.Ae(null,null,t.RED,null,this.right.left);return this.right.Ae(null,null,this.color,e,null)},t.prototype.Be=function(){var e=this.Ae(null,null,t.RED,this.left.right,null);return this.left.Ae(null,null,this.color,null,e)},t.prototype.Qe=function(){var t=this.left.Ae(null,null,!this.left.color,null,null),e=this.right.Ae(null,null,!this.right.color,null,null);return this.Ae(null,null,!this.color,t,e)},t.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},t.prototype.je=function(){if(this.xe()&&this.left.xe())throw be();if(this.right.xe())throw be();var t=this.left.je();if(t!==this.right.je())throw be();return t+(this.xe()?0:1)},t}();Mt.EMPTY=null,Mt.RED=!0,Mt.Pe=!1,Mt.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw be()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw be()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw be()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw be()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw be()},enumerable:!0,configurable:!0}),t.prototype.Ae=function(t,e,n,r,i){return this},t.prototype.me=function(t,e,n){return new Mt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.B=function(){return!0},t.prototype.pe=function(t){return!1},t.prototype.ye=function(t){return!1},t.prototype.Ve=function(){return null},t.prototype.ge=function(){return null},t.prototype.xe=function(){return!1},t.prototype.We=function(){return!0},t.prototype.je=function(){return 0},t}());var Ut=function(){function t(t){this.N=t,this.data=new Ct(this.N)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Ve()},t.prototype.last=function(){return this.data.ge()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.pe((function(e,n){return t(e),!1}))},t.prototype.Ke=function(t,e){for(var n=this.data.ve(t[0]);n.ke();){var r=n.Ne();if(this.N(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ge=function(t,e){var n;for(n=void 0!==e?this.data.ve(e):this.data.be();n.ke();)if(!t(n.Ne().key))return},t.prototype.ze=function(t){var e=this.data.ve(t);return e.ke()?e.Ne().key:null},t.prototype.be=function(){return new qt(this.data.be())},t.prototype.ve=function(t){return new qt(this.data.ve(t))},t.prototype.add=function(t){return this.Ae(this.data.remove(t).me(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.Ae(this.data.remove(t)):this},t.prototype.B=function(){return this.data.B()},t.prototype.He=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.be(),r=e.data.be();n.ke();){var i=n.Ne().key,o=r.Ne().key;if(0!==this.N(i,o))return!1}return!0},t.prototype.W=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.Ae=function(e){var n=new t(this.N);return n.data=e,n},t}(),qt=function(){function t(t){this.Ye=t}return t.prototype.Ne=function(){return this.Ye.Ne().key},t.prototype.ke=function(){return this.Ye.ke()},t}(),jt=new Ct(N.N);function Ft(){return jt}function Bt(){return Ft()}var Gt=new Ct(N.N);function zt(){return Gt}var Wt=new Ct(N.N);function Kt(){return Wt}var Ht=new Ut(N.N);function Xt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ht,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Yt=new Ut(Ie);function Qt(){return Yt}var Jt=function(){function t(t){this.N=t?function(e,n){return t(e,n)||N.N(e.key,n.key)}:function(t,e){return N.N(t.key,e.key)},this.Je=zt(),this.Xe=new Ct(this.N)}return t.Ze=function(e){return new t(e.N)},t.prototype.has=function(t){return null!=this.Je.get(t)},t.prototype.get=function(t){return this.Je.get(t)},t.prototype.first=function(){return this.Xe.Ve()},t.prototype.last=function(){return this.Xe.ge()},t.prototype.B=function(){return this.Xe.B()},t.prototype.indexOf=function(t){var e=this.Je.get(t);return e?this.Xe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Xe.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.Xe.pe((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.Ae(e.Je.me(t.key,t),e.Xe.me(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.Ae(this.Je.remove(t),this.Xe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Xe.be(),r=e.Xe.be();n.ke();){var i=n.Ne().key,o=r.Ne().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.Ae=function(e,n){var r=new t;return r.N=this.N,r.Je=e,r.Xe=n,r},t}(),Zt=function(){function t(){this.ts=new Ct(N.N)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);n?0!==t.type&&3===n.type?this.ts=this.ts.me(e,t):3===t.type&&1!==n.type?this.ts=this.ts.me(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.me(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.me(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.me(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.me(e,{type:2,doc:t.doc}):be():this.ts=this.ts.me(e,t)},t.prototype.es=function(){var t=[];return this.ts.pe((function(e,n){t.push(n)})),t},t}(),$t=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=r,this.ns=i,this.fromCache=o,this.rs=s,this.hs=u}return t.os=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Jt.Ze(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.ns.B()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),te=function(){function t(t,e,n,r,i){this.Ee=t,this.as=e,this.us=n,this.cs=r,this._s=i}return t.ls=function(e,n){var r=new Map;return r.set(e,ee.ds(e,n)),new t(b.min(),r,Qt(),Ft(),Xt())},t}(),ee=function(){function t(t,e,n,r,i){this.resumeToken=t,this.fs=e,this.Ts=n,this.Es=r,this.Is=i}return t.ds=function(e,n){return new t(k.ht,n,Xt(),Xt(),Xt())},t}(),ne=function(t,e,n,r){this.ws=t,this.removedTargetIds=e,this.key=n,this.Rs=r},re=function(t,e){this.targetId=t,this.ms=e},ie=function(t,e,n,r){void 0===n&&(n=k.ht),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},oe=function(){function t(){this.As=0,this.Ps=ae(),this.Vs=k.ht,this.gs=!1,this.ps=!0}return Object.defineProperty(t.prototype,"fs",{get:function(){return this.gs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ys",{get:function(){return 0!==this.As},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bs",{get:function(){return this.ps},enumerable:!0,configurable:!0}),t.prototype.vs=function(t){t.rt()>0&&(this.ps=!0,this.Vs=t)},t.prototype.Ss=function(){var t=Xt(),e=Xt(),n=Xt();return this.Ps.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:be()}})),new ee(this.Vs,this.gs,t,e,n)},t.prototype.Ds=function(){this.ps=!1,this.Ps=ae()},t.prototype.Cs=function(t,e){this.ps=!0,this.Ps=this.Ps.me(t,e)},t.prototype.Fs=function(t){this.ps=!0,this.Ps=this.Ps.remove(t)},t.prototype.Ns=function(){this.As+=1},t.prototype.ks=function(){this.As-=1},t.prototype.$s=function(){this.ps=!0,this.gs=!0},t}(),se=function(){function t(t){this.Ms=t,this.Ls=new Map,this.xs=Ft(),this.Os=ue(),this.Bs=new Ut(Ie)}return t.prototype.qs=function(t){for(var e=0,n=t.ws;e<n.length;e++){var r=n[e];t.Rs instanceof mt?this.Us(r,t.Rs):t.Rs instanceof wt&&this.Qs(r,t.key,t.Rs)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Qs(s,t.key,t.Rs)}},t.prototype.Ws=function(t){var e=this;this.js(t,(function(n){var r=e.Ks(n);switch(t.state){case 0:e.Gs(n)&&r.vs(t.resumeToken);break;case 1:r.ks(),r.ys||r.Ds(),r.vs(t.resumeToken);break;case 2:r.ks(),r.ys||e.removeTarget(n);break;case 3:e.Gs(n)&&(r.$s(),r.vs(t.resumeToken));break;case 4:e.Gs(n)&&(e.zs(n),r.vs(t.resumeToken));break;default:be()}}))},t.prototype.js=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Ls.forEach((function(t,r){n.Gs(r)&&e(r)}))},t.prototype.Hs=function(t){var e=t.targetId,n=t.ms.count,r=this.Ys(e);if(r){var i=r.target;if(i.xt())if(0===n){var o=new N(i.path);this.Qs(e,o,new wt(o,b.min()))}else Ee(1===n);else this.Js(e)!==n&&(this.zs(e),this.Bs=this.Bs.add(e))}},t.prototype.Xs=function(t){var e=this,n=new Map;this.Ls.forEach((function(r,i){var o=e.Ys(i);if(o){if(r.fs&&o.target.xt()){var s=new N(o.target.path);null!==e.xs.get(s)||e.Zs(i,s)||e.Qs(i,s,new wt(s,t))}r.bs&&(n.set(i,r.Ss()),r.Ds())}}));var r=Xt();this.Os.forEach((function(t,n){var i=!0;n.Ge((function(t){var n=e.Ys(t);return!n||2===n.Te||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new te(t,n,this.Bs,this.xs,r);return this.xs=Ft(),this.Os=ue(),this.Bs=new Ut(Ie),i},t.prototype.Us=function(t,e){if(this.Gs(t)){var n=this.Zs(t,e.key)?2:0;this.Ks(t).Cs(e.key,n),this.xs=this.xs.me(e.key,e),this.Os=this.Os.me(e.key,this.ti(e.key).add(t))}},t.prototype.Qs=function(t,e,n){if(this.Gs(t)){var r=this.Ks(t);this.Zs(t,e)?r.Cs(e,1):r.Fs(e),this.Os=this.Os.me(e,this.ti(e).delete(t)),n&&(this.xs=this.xs.me(e,n))}},t.prototype.removeTarget=function(t){this.Ls.delete(t)},t.prototype.Js=function(t){var e=this.Ks(t).Ss();return this.Ms.ei(t).size+e.Ts.size-e.Is.size},t.prototype.Ns=function(t){this.Ks(t).Ns()},t.prototype.Ks=function(t){var e=this.Ls.get(t);return e||(e=new oe,this.Ls.set(t,e)),e},t.prototype.ti=function(t){var e=this.Os.get(t);return e||(e=new Ut(Ie),this.Os=this.Os.me(t,e)),e},t.prototype.Gs=function(t){var e=null!==this.Ys(t);return e||ge("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ys=function(t){var e=this.Ls.get(t);return e&&e.ys?null:this.Ms.si(t)},t.prototype.zs=function(t){var e=this;this.Ls.set(t,new oe),this.Ms.ei(t).forEach((function(n){e.Qs(t,n,null)}))},t.prototype.Zs=function(t,e){return this.Ms.ei(t).has(e)},t}();function ue(){return new Ct(N.N)}function ae(){return new Ct(N.N)}var he={asc:"ASCENDING",desc:"DESCENDING"},ce={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fe=function(){function t(t,e){this.ii=t,this.options=e}return t.prototype.ni=function(t){var e=void 0===t.code?l.UNKNOWN:Pt(t.code);return new p(e,t.message||"")},t.prototype.ri=function(t){return this.options.hi||L(t)?t:{value:t}},t.prototype.oi=function(t){var e;return L(e="object"==typeof t?t.value:t)?null:e},t.prototype._t=function(t){return{integerValue:""+t}},t.prototype.lt=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:D(t)?"-0":t}},t.prototype.ai=function(t){return R(t)?this._t(t):this.lt(t)},t.prototype.C=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.v=function(t){var e=B(t);return new w(e.seconds,e.nanos)},t.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},t.prototype.ci=function(t){return this.options.hi?(Ee(void 0===t||"string"==typeof t),k.fromBase64String(t||"")):(Ee(void 0===t||t instanceof Uint8Array),k.fromUint8Array(t||new Uint8Array))},t.prototype.toVersion=function(t){return this.C(t.C())},t.prototype.fromVersion=function(t){return Ee(!!t),b.v(this.v(t))},t.prototype._i=function(t,e){return this.li(e||this.ii).child("documents").child(t).j()},t.prototype.di=function(t){var e=_.K(t);return Ee(le(e)),e},t.prototype.fi=function(t){return this._i(t.path)},t.prototype.Z=function(t){var e=this.di(t);return Ee(e.get(1)===this.ii.projectId),Ee(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new N(this.Ti(e))},t.prototype.Ei=function(t){return this._i(t)},t.prototype.Ii=function(t){var e=this.di(t);return 4===e.length?_.G:this.Ti(e)},Object.defineProperty(t.prototype,"wi",{get:function(){return new _(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),t.prototype.li=function(t){return new _(["projects",t.projectId,"databases",t.database])},t.prototype.Ti=function(t){return Ee(t.length>4&&"documents"===t.get(4)),t.$(5)},t.prototype.Ri=function(t,e){return{name:this.fi(t),fields:e.proto.mapValue.fields}},t.prototype.mi=function(t){return{name:this.fi(t.key),fields:t.Mt().mapValue.fields,updateTime:this.C(t.version.C())}},t.prototype.Ai=function(t,e){var n=this.Z(t.name),r=this.fromVersion(t.updateTime),i=new lt({mapValue:{fields:t.fields}});return new mt(n,r,i,{hasCommittedMutations:!!e})},t.prototype.Pi=function(t){Ee(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),r=new lt({mapValue:{fields:t.found.fields}});return new mt(e,n,r,{})},t.prototype.Vi=function(t){Ee(!!t.missing),Ee(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new wt(e,n)},t.prototype.gi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):be()},t.prototype.pi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.yi(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=this.ci(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this.ni(o);e=new ie(n,r,i,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var a=this.Z(u.document.name),h=this.fromVersion(u.document.updateTime),c=new lt({mapValue:{fields:u.document.fields}}),f=new mt(a,h,c,{}),l=u.targetIds||[],p=u.removedTargetIds||[];e=new ne(l,p,f.key,f)}else if("documentDelete"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.Z(d.document),v=d.readTime?this.fromVersion(d.readTime):b.min(),g=new wt(y,v),m=d.removedTargetIds||[];e=new ne([],m,g.key,g)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var E=this.Z(w.document),_=w.removedTargetIds||[];e=new ne([],_,E,null)}else{if(!("filter"in t))return be();t.filter;var T=t.filter;T.targetId;var I=T.count||0,N=new Rt(I),A=T.targetId;e=new re(A,N)}return e},t.prototype.yi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:be()},t.prototype.bi=function(t){if(!("targetChange"in t))return b.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?b.min():e.readTime?this.fromVersion(e.readTime):b.min()},t.prototype.vi=function(t){var e,n=this;if(t instanceof ut)e={update:this.Ri(t.key,t.value)};else if(t instanceof ct)e={delete:this.fi(t.key)};else if(t instanceof at)e={update:this.Ri(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof ht)e={transform:{document:this.fi(t.key),fieldTransforms:t.fieldTransforms.map((function(t){return n.Di(t)}))}};else{if(!(t instanceof ft))return be();e={verify:this.fi(t.key)}}return t.Rt.Tt||(e.currentDocument=this.Ci(t.Rt)),e},t.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):ot.ft();if(t.update){t.update.name;var r=this.Z(t.update.name),i=new lt({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.ki(t.updateMask);return new at(r,i,o,n)}return new ut(r,i,n)}if(t.delete){var s=this.Z(t.delete);return new ct(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map((function(t){return e.$i(t)}));return Ee(!0===n.exists),new ht(u,a)}if(t.verify){var h=this.Z(t.verify);return new ft(h,n)}return be()},t.prototype.Ci=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:be()},t.prototype.Ni=function(t){return void 0!==t.updateTime?ot.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?ot.exists(t.exists):ot.ft()},t.prototype.Mi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(b.min())&&(n=this.fromVersion(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new it(n,r)},t.prototype.Li=function(t,e){var n=this;return t&&t.length>0?(Ee(void 0!==e),t.map((function(t){return n.Mi(t,e)}))):[]},t.prototype.Di=function(t){var e=t.transform;if(e instanceof J)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof Z)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof $)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof tt)return{fieldPath:t.field.j(),increment:e.ct};throw be()},t.prototype.$i=function(t){var e=null;if("setToServerValue"in t)Ee("REQUEST_TIME"===t.setToServerValue),e=J.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new Z(n)}else if("removeAllFromArray"in t){var r=t.removeAllFromArray.values||[];e=new $(r)}else"increment"in t?e=new tt(this,t.increment):be();var i=I.X(t.fieldPath);return new rt(i,e)},t.prototype.xi=function(t){return{documents:[this.Ei(t.path)]}},t.prototype.Oi=function(t){Ee(1===t.documents.length);var e=t.documents[0];return _t.Wt(this.Ii(e)).ee()},t.prototype.Bi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ei(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ei(n.M()),e.structuredQuery.from=[{collectionId:n.O()}]);var r=this.qi(t.filters);r&&(e.structuredQuery.where=r);var i=this.Ui(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},t.prototype.Wi=function(t){var e=this.Ii(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Ee(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.ji(n.where));var u=[];n.orderBy&&(u=this.Ki(n.orderBy));var a=null;n.limit&&(a=this.oi(n.limit));var h=null;n.startAt&&(h=this.Gi(n.startAt));var c=null;return n.endAt&&(c=this.Gi(n.endAt)),new _t(e,i,u,s,a,"F",h,c).ee()},t.prototype.zi=function(t){var e=this.Hi(t.Te);return null==e?null:{"goog-listen-tags":e}},t.prototype.Hi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return be()}},t.prototype.ee=function(t){var e,n=t.target;return(e=n.xt()?{documents:this.xi(n)}:{query:this.Bi(n)}).targetId=t.targetId,t.resumeToken.rt()>0&&(e.resumeToken=this.ui(t.resumeToken)),e},t.prototype.qi=function(t){var e=this;if(0!==t.length){var n=t.map((function(t){return t instanceof Tt?e.Yi(t):be()}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Ji(t)]:void 0!==t.fieldFilter?[this.Xi(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return e.ji(t)})).reduce((function(t,e){return t.concat(e)})):be():[]},t.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map((function(t){return e.Zi(t)}))},t.prototype.Ki=function(t){var e=this;return t.map((function(t){return e.tn(t)}))},t.prototype.Qi=function(t){return{before:t.before,values:t.position}},t.prototype.Gi=function(t){var e=!!t.before,n=t.values||[];return new kt(n,e)},t.prototype.en=function(t){return he[t]},t.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},t.prototype.nn=function(t){return ce[t]},t.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return be()}},t.prototype.hn=function(t){return{fieldPath:t.j()}},t.prototype.on=function(t){return I.X(t.fieldPath)},t.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},t.prototype.tn=function(t){return new Lt(this.on(t.field),this.sn(t.direction))},t.prototype.Xi=function(t){return Tt.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},t.prototype.Yi=function(t){if("=="===t.op){if(Y(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(X(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},t.prototype.Ji=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return Tt.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return Tt.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return be()}},t.prototype.Si=function(t){var e=[];return t.fields.forEach((function(t){return e.push(t.j())})),{fieldPaths:e}},t.prototype.ki=function(t){var e=t.fieldPaths||[];return new nt(e.map((function(t){return I.X(t)})))},t}();function le(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var pe=function(){function t(){}return t.an=function(e){t.platform&&be(),t.platform=e},t.nt=function(){return t.platform||be(),t.platform},t}(),de=new s.Logger("@firebase/firestore");function ye(){return de.logLevel}function ve(t){de.logLevel=t}function ge(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(de.logLevel<=s.LogLevel.DEBUG){var r=e.map(we);de.debug.apply(de,i.__spreadArrays(["Firestore ("+c+"): "+t],r))}}function me(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(de.logLevel<=s.LogLevel.ERROR){var r=e.map(we);de.error.apply(de,i.__spreadArrays(["Firestore ("+c+"): "+t],r))}}function we(t){if("string"==typeof t)return t;var e=pe.nt();try{return e.un(t)}catch(e){return t}}function be(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+c+") INTERNAL ASSERTION FAILED: "+t;throw me(e),new Error(e)}function Ee(t,e){t||be()}function _e(t,e){return t}var Te=function(){function t(){}return t.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=pe.nt()._n(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Ie(t,e){return t<e?-1:t>e?1:0}function Ne(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Ae(t){return t+"\0"}var xe=function(t,e,n,r,i){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},Se=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"ln",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.S=function(t){return Ie(this.projectId,t.projectId)||Ie(this.database,t.database)},t}(),ke=function(){function t(t){this.dn=t,this.fn={}}return t.prototype.get=function(t){var e=this.dn(t),n=this.fn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(s.isEqual(t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.dn(t),r=this.fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.fn[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.dn(t),n=this.fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.fn[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){x(this.fn,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}}))},t.prototype.B=function(){return S(this.fn)},t}(),Le=function(){function t(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}return t.prototype.at=function(t,e,n){for(var r=n.En,i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var s=r[i];e=o.at(e,s)}}return e},t.prototype.ot=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.ot(e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.Tn))}return e},t.prototype.In=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.ot(r.key,t.get(r.key));i&&(n=n.me(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Xt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ne(this.mutations,t.mutations,(function(t,e){return t.isEqual(e)}))&&Ne(this.baseMutations,t.baseMutations,(function(t,e){return t.isEqual(e)}))},t}(),De=function(){function t(t,e,n,r,i){this.batch=t,this.wn=e,this.En=n,this.streamToken=r,this.Rn=i}return t.from=function(e,n,r,i){Ee(e.mutations.length===r.length);for(var o=Kt(),s=e.mutations,u=0;u<s.length;u++)o=o.me(s[u].key,r[u].version);return new t(e,n,r,i,o)},t}(),Re=function(){function t(){this.mn=new Ut(Oe.An),this.Pn=new Ut(Oe.Vn)}return t.prototype.B=function(){return this.mn.B()},t.prototype.gn=function(t,e){var n=new Oe(t,e);this.mn=this.mn.add(n),this.Pn=this.Pn.add(n)},t.prototype.pn=function(t,e){var n=this;t.forEach((function(t){return n.gn(t,e)}))},t.prototype.yn=function(t,e){this.bn(new Oe(t,e))},t.prototype.vn=function(t,e){var n=this;t.forEach((function(t){return n.yn(t,e)}))},t.prototype.Sn=function(t){var e=this,n=N.EMPTY,r=new Oe(n,t),i=new Oe(n,t+1),o=[];return this.Pn.Ke([r,i],(function(t){e.bn(t),o.push(t.key)})),o},t.prototype.Dn=function(){var t=this;this.mn.forEach((function(e){return t.bn(e)}))},t.prototype.bn=function(t){this.mn=this.mn.delete(t),this.Pn=this.Pn.delete(t)},t.prototype.Cn=function(t){var e=N.EMPTY,n=new Oe(e,t),r=new Oe(e,t+1),i=Xt();return this.Pn.Ke([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Fn=function(t){var e=new Oe(t,0),n=this.mn.ze(e);return null!==n&&t.isEqual(n.key)},t}(),Oe=function(){function t(t,e){this.key=t,this.Nn=e}return t.An=function(t,e){return N.N(t.key,e.key)||Ie(t.Nn,e.Nn)},t.Vn=function(t,e){return Ie(t.Nn,e.Nn)||N.N(t.key,e.key)},t}(),Pe=function(){function t(t){var e=this;this.kn=null,this.$n=null,this.result=void 0,this.error=void 0,this.Mn=!1,this.Ln=!1,t((function(t){e.Mn=!0,e.result=t,e.kn&&e.kn(t)}),(function(t){e.Mn=!0,e.error=t,e.$n&&e.$n(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Ln&&be(),this.Ln=!0,this.Mn?this.error?this.xn(n,this.error):this.On(e,this.result):new t((function(t,i){r.kn=function(n){r.On(e,n).next(t,i)},r.$n=function(e){r.xn(n,e).next(t,i)}}))},t.prototype.Bn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.qn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.On=function(e,n){return e?this.qn((function(){return e(n)})):t.resolve(n)},t.prototype.xn=function(e,n){return e?this.qn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.Un=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Qn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.Un(r)},t}(),Ce=function(){function t(){this.Wn=new ke((function(t){return t.toString()})),this.jn=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.Kn},set:function(t){this.Kn=t},enumerable:!0,configurable:!0}),t.prototype.Gn=function(t,e){this.zn(),this.readTime=e,this.Wn.set(t.key,t)},t.prototype.Hn=function(t,e){this.zn(),e&&(this.readTime=e),this.Wn.set(t,null)},t.prototype.Yn=function(t,e){this.zn();var n=this.Wn.get(e);return void 0!==n?Pe.resolve(n):this.Jn(t,e)},t.prototype.getEntries=function(t,e){return this.Xn(t,e)},t.prototype.apply=function(t){return this.zn(),this.jn=!0,this.Zn(t)},t.prototype.zn=function(){},t}(),Ve="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Me=function(){function t(){this.tr=[]}return t.prototype.er=function(t){this.tr.push(t)},t.prototype.sr=function(){this.tr.forEach((function(t){return t()}))},t}(),Ue=function(){function t(t,e,n){this.ir=t,this.nr=e,this.rr=n}return t.prototype.hr=function(t,e){var n=this;return this.nr.or(t,e).next((function(r){return n.ar(t,e,r)}))},t.prototype.ar=function(t,e,n){return this.ir.Yn(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ot(e,t);return t}))},t.prototype.ur=function(t,e,n){var r=Bt();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ot(t,e);r=r.me(t,e)})),r},t.prototype.cr=function(t,e){var n=this;return this.ir.getEntries(t,e).next((function(e){return n._r(t,e)}))},t.prototype._r=function(t,e){var n=this;return this.nr.lr(t,e).next((function(r){var i=n.ur(t,e,r),o=Ft();return i.forEach((function(t,e){e||(e=new wt(t,b.min())),o=o.me(t,e)})),o}))},t.prototype.dr=function(t,e,n){return e.xt()?this.Tr(t,e.path):e._e()?this.Er(t,e,n):this.Ir(t,e,n)},t.prototype.Tr=function(t,e){return this.hr(t,new N(e)).next((function(t){var e=zt();return t instanceof mt&&(e=e.me(t.key,t)),e}))},t.prototype.Er=function(t,e,n){var r=this,i=e.collectionGroup,o=zt();return this.rr.wr(t,i).next((function(s){return Pe.forEach(s,(function(s){var u=e.Zt(s.child(i));return r.Ir(t,u,n).next((function(t){t.forEach((function(t,e){o=o.me(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Ir=function(t,e,n){var r,i,o=this;return this.ir.dr(t,e,n).next((function(n){return r=n,o.nr.Rr(t,e)})).next((function(e){return i=e,o.mr(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],h=a.key,c=r.get(h),f=a.ot(c,c,o.Tn);r=f instanceof mt?r.me(h,f):r.remove(h)}}))})).next((function(){return r.forEach((function(t,n){e.matches(n)||(r=r.remove(t))})),r}))},t.prototype.mr=function(t,e,n){for(var r=Xt(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof at&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.ir.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof mt&&(h=h.me(t,e))})),h}))},t}(),qe=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.Ar=n,this.Pr=r}return t.Vr=function(e,n){for(var r=Xt(),i=Xt(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),je=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.gr=function(t){return n.pr(t)},this.yr=function(t){return e.br(t)})}return t.prototype.pr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.yr&&this.yr(t),t},t}();je.vr=-1;var Fe=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Be=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Sr=t,this.Dr=e,this.Cr=n,this.Fr=r,this.Nr=i,this.kr=0,this.$r=null,this.Mr=Date.now(),this.reset()}return t.prototype.reset=function(){this.kr=0},t.prototype.Lr=function(){this.kr=this.Nr},t.prototype.xr=function(t){var e=this;this.cancel();var n=Math.floor(this.kr+this.Or()),r=Math.max(0,Date.now()-this.Mr),i=Math.max(0,n-r);i>0&&ge("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.kr+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.$r=this.Sr.Br(this.Dr,i,(function(){return e.Mr=Date.now(),t()})),this.kr*=this.Fr,this.kr<this.Cr&&(this.kr=this.Cr),this.kr>this.Nr&&(this.kr=this.Nr)},t.prototype.cancel=function(){null!==this.$r&&(this.$r.cancel(),this.$r=null)},t.prototype.Or=function(){return(Math.random()-.5)*this.kr},t}(),Ge=function(){function t(t,e,n,r,i){this.qr=t,this.Dr=e,this.Ur=n,this.op=r,this.Qr=i,this.Wr=new Fe,this.then=this.Wr.promise.then.bind(this.Wr.promise),this.catch=this.Wr.promise.catch.bind(this.Wr.promise),this.Wr.promise.catch((function(t){}))}return t.jr=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.Kr=setTimeout((function(){return e.Gr()}),t)},t.prototype.zr=function(){return this.Gr()},t.prototype.cancel=function(t){null!==this.Kr&&(this.clearTimeout(),this.Wr.reject(new p(l.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Gr=function(){var t=this;this.qr.Hr((function(){return null!==t.Kr?(t.clearTimeout(),t.op().then((function(e){return t.Wr.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.Kr&&(this.Qr(this),clearTimeout(this.Kr),this.Kr=null)},t}(),ze=function(){function t(){var t=this;this.Yr=Promise.resolve(),this.Jr=Promise.resolve(),this.Xr=!1,this.Zr=[],this.th=null,this.eh=!1,this.sh=[],this.ih=new Be(this,"async_queue_retry"),this.nh=function(){t.rh("async_queue_retry")};var e=pe.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.nh)}return Object.defineProperty(t.prototype,"hh",{get:function(){return this.Xr},enumerable:!0,configurable:!0}),t.prototype.Hr=function(t){this.enqueue(t)},t.prototype.oh=function(t){this.ah(),this.uh(t)},t.prototype._h=function(t){return this.ah(),this.uh(t)},t.prototype.lh=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return this.ah(),this.Xr?[3,2]:(this.Xr=!0,(e=pe.nt().window)&&e.removeEventListener("visibilitychange",this.nh),[4,this._h(t)]);case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.enqueue=function(t){return this.ah(),this.Xr?new Promise((function(t){})):this.uh(t)},t.prototype.dh=function(t){var e=this;this.ah(),this.Xr||(this.Jr=this.Jr.then((function(){var n=new Fe;return e.Hr((function r(){return i.__awaiter(e,void 0,void 0,(function(){var e;return i.__generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t()];case 1:return i.sent(),n.resolve(),this.ih.reset(),[3,3];case 2:if("IndexedDbTransactionError"!==(e=i.sent()).name)throw n.resolve(),e;return ge("AsyncQueue","Operation failed with retryable error: "+e),this.ih.xr(r),[3,3];case 3:return[2]}}))}))})),n.promise})))},t.prototype.uh=function(t){var e=this,n=this.Yr.then((function(){return e.eh=!0,t().catch((function(t){throw e.th=t,e.eh=!1,me("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t})).then((function(t){return e.eh=!1,t}))}));return this.Yr=n,n},t.prototype.Br=function(t,e,n){var r=this;this.ah(),this.sh.indexOf(t)>-1&&(e=0);var i=Ge.jr(this,t,e,n,(function(t){return r.fh(t)}));return this.Zr.push(i),i},t.prototype.ah=function(){this.th&&be()},t.prototype.Th=function(){},t.prototype.Eh=function(){return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(e){switch(e.label){case 0:return[4,t=this.Yr];case 1:e.sent(),e.label=2;case 2:if(t!==this.Yr)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Ih=function(t){for(var e=0,n=this.Zr;e<n.length;e++)if(n[e].Dr===t)return!0;return!1},t.prototype.rh=function(t){var e=this;return this.Eh().then((function(){e.Zr.sort((function(t,e){return t.Ur-e.Ur}));for(var n=0,r=e.Zr;n<r.length;n++){var i=r[n];if(i.zr(),"all"!==t&&i.Dr===t)break}return e.Eh()}))},t.prototype.wh=function(t){this.sh.push(t)},t.prototype.fh=function(t){var e=this.Zr.indexOf(t);this.Zr.splice(e,1)},t}();function We(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ie(n,i);return 0===s?Ie(r,o):s}var Ke=function(){function t(t){this.Rh=t,this.buffer=new Ut(We),this.mh=0}return t.prototype.Ah=function(){return++this.mh},t.prototype.Ph=function(t){var e=[t,this.Ah()];if(this.buffer.size<this.Rh)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();We(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),He={Vh:!1,gh:0,ph:0,yh:0},Xe=function(){function t(t,e,n){this.bh=t,this.vh=e,this.Sh=n}return t.Dh=function(e){return new t(e,t.Ch,t.Fh)},t}();Xe.Nh=-1,Xe.kh=1048576,Xe.$h=41943040,Xe.Ch=10,Xe.Fh=1e3,Xe.Mh=new Xe(Xe.$h,Xe.Ch,Xe.Fh),Xe.DISABLED=new Xe(Xe.Nh,0,0);var Ye=function(){function t(t,e){this.Lh=t,this.qr=e,this.xh=!1,this.Oh=null}return t.prototype.start=function(t){this.Lh.Bh.bh!==Xe.Nh&&this.qh(t)},t.prototype.stop=function(){this.Oh&&(this.Oh.cancel(),this.Oh=null)},Object.defineProperty(t.prototype,"Uh",{get:function(){return null!==this.Oh},enumerable:!0,configurable:!0}),t.prototype.qh=function(t){var e=this,n=this.xh?3e5:6e4;ge("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.Oh=this.qr.Br("lru_garbage_collection",n,(function(){return i.__awaiter(e,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:this.Oh=null,this.xh=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Qh(this.Lh)];case 2:return n.sent(),[3,7];case 3:return"IndexedDbTransactionError"!==(e=n.sent()).name?[3,4]:(ge("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]);case 4:return[4,or(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.qh(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Qe=function(){function t(t,e){this.Wh=t,this.Bh=e}return t.prototype.jh=function(t,e){return this.Wh.Kh(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Gh=function(t,e){var n=this;if(0===e)return Pe.resolve(je.vr);var r=new Ke(e);return this.Wh.js(t,(function(t){return r.Ph(t.sequenceNumber)})).next((function(){return n.Wh.zh(t,(function(t){return r.Ph(t)}))})).next((function(){return r.maxValue}))},t.prototype.Hh=function(t,e,n){return this.Wh.Hh(t,e,n)},t.prototype.Yh=function(t,e){return this.Wh.Yh(t,e)},t.prototype.Jh=function(t,e){var n=this;return this.Bh.bh===Xe.Nh?(ge("LruGarbageCollector","Garbage collection skipped; disabled"),Pe.resolve(He)):this.Xh(t).next((function(r){return r<n.Bh.bh?(ge("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.Bh.bh),He):n.Zh(t,e)}))},t.prototype.Xh=function(t){return this.Wh.Xh(t)},t.prototype.Zh=function(t,e){var n,r,i,o,u,a,h,c=this,f=Date.now();return this.jh(t,this.Bh.vh).next((function(e){return e>c.Bh.Sh?(ge("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.Bh.Sh+" from "+e),r=c.Bh.Sh):r=e,o=Date.now(),c.Gh(t,r)})).next((function(r){return n=r,u=Date.now(),c.Hh(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.Yh(t,n)})).next((function(t){return h=Date.now(),ye()<=s.LogLevel.DEBUG&&ge("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-f)+"ms\n\tDetermined least recently used "+r+" in "+(u-o)+"ms\n\tRemoved "+i+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),Pe.resolve({Vh:!0,gh:r,ph:i,yh:t})}))},t}();function Je(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=$e(e)),e=Ze(t.get(n),e);return $e(e)}function Ze(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function $e(t){return t+"\x01\x01"}function tn(t){var e=t.length;if(Ee(e>=2),2===e)return Ee("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),_.G;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&be(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:be()}o=s+2}return new _(r)}var en=function(){function t(e){this.db=e,12.2===t.to(u.getUA())&&me("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.eo=function(e,n,r){return ge("SimpleDb","Opening database:",e),new Pe((function(i,o){var s=window.indexedDB.open(e,n);s.onsuccess=function(e){var n=e.target.result;i(new t(n))},s.onblocked=function(){o(new p(l.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new p(l.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},s.onupgradeneeded=function(t){ge("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;r.createOrUpgrade(n,s.transaction,t.oldVersion,kn).next((function(){ge("SimpleDb","Database upgrade to version "+kn+" complete")}))}})).Bn()},t.delete=function(t){return ge("SimpleDb","Removing database:",t),un(window.indexedDB.deleteDatabase(t)).Bn()},t.so=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(t.io())return!0;if(void 0===window.navigator)return!1;var e=u.getUA(),n=t.to(e),r=0<n&&n<10,i=t.no(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.io=function(){var t;return"undefined"!=typeof __PRIVATE_process&&"YES"===(null===(t=__PRIVATE_process.__PRIVATE_env)||void 0===t?void 0:t.ro)},t.ho=function(t,e){return t.store(e)},t.to=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.no=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.oo=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,o,s,u,a;return i.__generator(this,(function(h){switch(h.label){case 0:r="readonly"===t,o=0,s=function(){var t,s,a,h,c;return i.__generator(this,(function(i){switch(i.label){case 0:++o,t=on.open(u.db,r?"readonly":"readwrite",e),i.label=1;case 1:return i.trys.push([1,3,,4]),s=n(t).catch((function(e){return t.abort(e),Pe.reject(e)})).Bn(),a={},s.catch((function(){})),[4,t.ao];case 2:return[2,(a.value=(i.sent(),s),a)];case 3:return h=i.sent(),c="FirebaseError"!==h.name&&o<3,ge("SimpleDb","Transaction failed with error: %s. Retrying: %s.",h.message,c),c?[3,4]:[2,{value:Promise.reject(h)}];case 4:return[2]}}))},u=this,h.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=h.sent()))return[2,a.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db.close()},t}(),nn=function(){function t(t){this.uo=t,this.co=!1,this._o=null}return Object.defineProperty(t.prototype,"Mn",{get:function(){return this.co},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lo",{get:function(){return this._o},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.uo=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.co=!0},t.prototype.do=function(t){this._o=t},t.prototype.delete=function(){return un(this.uo.delete())},t}(),rn=function(t){function e(e){var n=this;return(n=t.call(this,l.UNAVAILABLE,"IndexedDB transaction failed: "+e)||this).name="IndexedDbTransactionError",n}return i.__extends(e,t),e}(p),on=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.fo=new Fe,this.transaction.oncomplete=function(){e.fo.resolve()},this.transaction.onabort=function(){t.error?e.fo.reject(new rn(t.error)):e.fo.resolve()},this.transaction.onerror=function(t){var n=hn(t.target.error);e.fo.reject(new rn(n))}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"ao",{get:function(){return this.fo.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.fo.reject(t),this.aborted||(ge("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new sn(e)},t}(),sn=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(ge("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(ge("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),un(n)},t.prototype.add=function(t){return ge("SimpleDb","ADD",this.store.name,t,t),un(this.store.add(t))},t.prototype.get=function(t){var e=this;return un(this.store.get(t)).next((function(n){return void 0===n&&(n=null),ge("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return ge("SimpleDb","DELETE",this.store.name,t),un(this.store.delete(t))},t.prototype.count=function(){return ge("SimpleDb","COUNT",this.store.name),un(this.store.count())},t.prototype.To=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Eo(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Io=function(t,e){ge("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.wo=!1;var r=this.cursor(n);return this.Eo(r,(function(t,e,n){return n.delete()}))},t.prototype.Ro=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Eo(r,e)},t.prototype.mo=function(t){var e=this.cursor({});return new Pe((function(n,r){e.onerror=function(t){var e=hn(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.Eo=function(t,e){var n=[];return new Pe((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new nn(i),s=e(i.primaryKey,i.value,o);if(s instanceof Pe){var u=s.catch((function(t){return o.done(),Pe.reject(t)}));n.push(u)}o.Mn?r():null===o.lo?i.continue():i.continue(o.lo)}else r()}})).next((function(){return Pe.Un(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.wo?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function un(t){return new Pe((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=hn(t.target.error);n(e)}}))}var an=!1;function hn(t){var e=en.to(u.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new p("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return an||(an=!0,setTimeout((function(){throw r}),0)),r}}return t}var cn=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.rr=n,this.Ao=r,this.Po={}}return t.Vo=function(e,n,r,i){return Ee(""!==e.uid),new t(e.t()?e.uid:"",n,r,i)},t.prototype.po=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return pn(t).Ro({index:Pn.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.yo=function(t,e,n){return this.bo(t).next((function(e){return e.lastStreamToken=n.toBase64(),yn(t).put(e)}))},t.prototype.vo=function(t){return this.bo(t).next((function(t){return k.fromBase64String(t.lastStreamToken)}))},t.prototype.So=function(t,e){return this.bo(t).next((function(n){return n.lastStreamToken=e.toBase64(),yn(t).put(n)}))},t.prototype.Do=function(t,e,n,r){var i=this,o=dn(t),s=pn(t);return s.add({}).next((function(u){Ee("number"==typeof u);for(var a=new Le(u,e,n,r),h=i.serializer.Co(i.userId,a),c=[],f=new Ut((function(t,e){return Ie(t.j(),e.j())})),l=0,p=r;l<p.length;l++){var d=p[l],y=Cn.key(i.userId,d.key.path,u);f=f.add(d.key.path.M()),c.push(s.put(h)),c.push(o.put(y,Cn.PLACEHOLDER))}return f.forEach((function(e){c.push(i.rr.Fo(t,e))})),t.er((function(){i.Po[u]=a.keys()})),Pe.Un(c).next((function(){return a}))}))},t.prototype.No=function(t,e){var n=this;return pn(t).get(e).next((function(t){return t?(Ee(t.userId===n.userId),n.serializer.ko(t)):null}))},t.prototype.$o=function(t,e){var n=this;return this.Po[e]?Pe.resolve(this.Po[e]):this.No(t,e).next((function(t){if(t){var r=t.keys();return n.Po[e]=r,r}return null}))},t.prototype.Mo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return pn(t).Ro({index:Pn.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Ee(e.batchId>=r),o=n.serializer.ko(e)),i.done()})).next((function(){return o}))},t.prototype.Lo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return pn(t).Ro({index:Pn.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.xo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return pn(t).To(Pn.userMutationsIndex,n).next((function(t){return t.map((function(t){return e.serializer.ko(t)}))}))},t.prototype.or=function(t,e){var n=this,r=Cn.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return dn(t).Ro({range:i},(function(r,i,s){var u=r[0],a=r[1],h=r[2],c=tn(a);if(u===n.userId&&e.path.isEqual(c))return pn(t).get(h).next((function(t){if(!t)throw be();Ee(t.userId===n.userId),o.push(n.serializer.ko(t))}));s.done()})).next((function(){return o}))},t.prototype.lr=function(t,e){var n=this,r=new Ut(Ie),i=[];return e.forEach((function(e){var o=Cn.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=dn(t).Ro({range:s},(function(t,i,o){var s=t[0],u=t[1],a=t[2],h=tn(u);s===n.userId&&e.path.isEqual(h)?r=r.add(a):o.done()}));i.push(u)})),Pe.Un(i).next((function(){return n.Oo(t,r)}))},t.prototype.Rr=function(t,e){var n=this,r=e.path,i=r.length+1,o=Cn.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Ut(Ie);return dn(t).Ro({range:s},(function(t,e,o){var s=t[0],a=t[1],h=t[2],c=tn(a);s===n.userId&&r.q(c)?c.length===i&&(u=u.add(h)):o.done()})).next((function(){return n.Oo(t,u)}))},t.prototype.Oo=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(pn(t).get(e).next((function(t){if(null===t)throw be();Ee(t.userId===n.userId),r.push(n.serializer.ko(t))})))})),Pe.Un(i).next((function(){return r}))},t.prototype.Bo=function(t,e){var n=this;return ln(t.qo,this.userId,e).next((function(r){return t.er((function(){n.Uo(e.batchId)})),Pe.forEach(r,(function(e){return n.Ao.Qo(t,e)}))}))},t.prototype.Uo=function(t){delete this.Po[t]},t.prototype.Wo=function(t){var e=this;return this.po(t).next((function(n){if(!n)return Pe.resolve();var r=IDBKeyRange.lowerBound(Cn.prefixForUser(e.userId)),i=[];return dn(t).Ro({range:r},(function(t,n,r){if(t[0]===e.userId){var o=tn(t[1]);i.push(o)}else r.done()})).next((function(){Ee(0===i.length)}))}))},t.prototype.Fn=function(t,e){return fn(t,this.userId,e)},t.prototype.bo=function(t){var e=this;return yn(t).get(this.userId).next((function(t){return t||new On(e.userId,-1,"")}))},t}();function fn(t,e,n){var r=Cn.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return dn(t).Ro({range:o,wo:!0},(function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()})).next((function(){return s}))}function ln(t,e,n){var r=t.store(Pn.store),i=t.store(Cn.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Ro({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){Ee(1===u)})));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Cn.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return Pe.Un(o).next((function(){return h}))}function pn(t){return Zn.ho(t,Pn.store)}function dn(t){return Zn.ho(t,Cn.store)}function yn(t){return Zn.ho(t,On.store)}var vn=function(){function t(t){this.jo=t}return t.prototype.next=function(){return this.jo+=2,this.jo},t.Ko=function(){return new t(0)},t.Go=function(){return new t(-1)},t}(),gn=function(){function t(t,e){this.Ao=t,this.serializer=e}return t.prototype.zo=function(t){var e=this;return this.Ho(t).next((function(n){var r=new vn(n.highestTargetId);return n.highestTargetId=r.next(),e.Yo(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Jo=function(t){return this.Ho(t).next((function(t){return b.v(new w(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Xo=function(t){return bn(t.qo)},t.prototype.Zo=function(t,e,n){var r=this;return this.Ho(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.C()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Yo(t,i)}))},t.prototype.ta=function(t,e){var n=this;return this.ea(t,e).next((function(){return n.Ho(t).next((function(r){return r.targetCount+=1,n.sa(e,r),n.Yo(t,r)}))}))},t.prototype.ia=function(t,e){return this.ea(t,e)},t.prototype.na=function(t,e){var n=this;return this.ra(t,e.targetId).next((function(){return mn(t).delete(e.targetId)})).next((function(){return n.Ho(t)})).next((function(e){return Ee(e.targetCount>0),e.targetCount-=1,n.Yo(t,e)}))},t.prototype.Hh=function(t,e,n){var r=this,i=0,o=[];return mn(t).Ro((function(s,u){var a=r.serializer.ha(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.na(t,a)))})).next((function(){return Pe.Un(o)})).next((function(){return i}))},t.prototype.js=function(t,e){var n=this;return mn(t).Ro((function(t,r){var i=n.serializer.ha(r);e(i)}))},t.prototype.Ho=function(t){return wn(t.qo)},t.prototype.Yo=function(t,e){return(n=t,Zn.ho(n,Bn.store)).put(Bn.key,e);var n},t.prototype.ea=function(t,e){return mn(t).put(this.serializer.oa(e))},t.prototype.sa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.aa=function(t){return this.Ho(t).next((function(t){return t.targetCount}))},t.prototype.ua=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return mn(t).Ro({range:i,index:jn.queryTargetsIndexName},(function(t,r,i){var s=n.serializer.ha(r);e.isEqual(s.target)&&(o=s,i.done())})).next((function(){return o}))},t.prototype.ca=function(t,e,n){var r=this,i=[],o=En(t);return e.forEach((function(e){var s=Je(e.path);i.push(o.put(new Fn(n,s))),i.push(r.Ao.gn(t,e))})),Pe.Un(i)},t.prototype._a=function(t,e,n){var r=this,i=En(t);return Pe.forEach(e,(function(e){var o=Je(e.path);return Pe.Un([i.delete([n,o]),r.Ao.yn(t,e)])}))},t.prototype.ra=function(t,e){var n=En(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.la=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=En(t),i=Xt();return r.Ro({range:n,wo:!0},(function(t,e,n){var r=tn(t[1]),o=new N(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Fn=function(t,e){var n=Je(e.path),r=IDBKeyRange.bound([n],[Ae(n)],!1,!0),i=0;return En(t).Ro({index:Fn.documentTargetsIndex,wo:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.si=function(t,e){var n=this;return mn(t).get(e).next((function(t){return t?n.serializer.ha(t):null}))},t}();function mn(t){return Zn.ho(t,jn.store)}function wn(t){return en.ho(t,Bn.store).get(Bn.key).next((function(t){return Ee(null!==t),t}))}function bn(t){return wn(t).next((function(t){return t.highestListenSequenceNumber}))}function En(t){return Zn.ho(t,Fn.store)}var _n=function(){function t(t,e){this.serializer=t,this.rr=e}return t.prototype.Gn=function(t,e,n){return In(t).put(Nn(e),n)},t.prototype.Hn=function(t,e){var n=In(t),r=Nn(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.da(t,r)}))},t.prototype.Yn=function(t,e){var n=this;return In(t).get(Nn(e)).next((function(t){return n.fa(t)}))},t.prototype.Ta=function(t,e){var n=this;return In(t).get(Nn(e)).next((function(t){var e=n.fa(t);return e?{Ea:e,size:An(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Bt();return this.Ia(t,e,(function(t,e){var i=n.fa(e);r=r.me(t,i)})).next((function(){return r}))},t.prototype.wa=function(t,e){var n=this,r=Bt(),i=new Ct(N.N);return this.Ia(t,e,(function(t,e){var o=n.fa(e);o?(r=r.me(t,o),i=i.me(t,An(e))):(r=r.me(t,null),i=i.me(t,0))})).next((function(){return{Ra:r,ma:i}}))},t.prototype.Ia=function(t,e,n){if(e.B())return Pe.resolve();var r=IDBKeyRange.bound(e.first().path.W(),e.last().path.W()),i=e.be(),o=i.Ne();return In(t).Ro({range:r},(function(t,e,r){for(var s=N.st(t);o&&N.N(o,s)<0;)n(o,null),o=i.Ne();o&&o.isEqual(s)&&(n(o,e),o=i.ke()?i.Ne():null),o?r.do(o.path.W()):r.done()})).next((function(){for(;o;)n(o,null),o=i.ke()?i.Ne():null}))},t.prototype.dr=function(t,e,n){var r=this,i=zt(),o=e.path.length+1,s={};if(n.isEqual(b.min())){var u=e.path.W();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.W(),h=this.serializer.Aa(n);s.range=IDBKeyRange.lowerBound([a,h],!0),s.index=Un.collectionReadTimeIndex}return In(t).Ro(s,(function(t,n,s){if(t.length===o){var u=r.serializer.Pa(n);e.path.q(u.key.path)?u instanceof mt&&e.matches(u)&&(i=i.me(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.Va=function(t,e){var n=this,r=Ft(),i=this.serializer.Aa(e),o=In(t),s=IDBKeyRange.lowerBound(i,!0);return o.Ro({index:Un.readTimeIndex,range:s},(function(t,e){var o=n.serializer.Pa(e);r=r.me(o.key,o),i=e.readTime})).next((function(){return{ga:r,readTime:n.serializer.pa(i)}}))},t.prototype.ya=function(t){var e=this,n=In(t),r=b.min();return n.Ro({index:Un.readTimeIndex,reverse:!0},(function(t,n,i){n.readTime&&(r=e.serializer.pa(n.readTime)),i.done()})).next((function(){return r}))},t.prototype.ba=function(e){return new t.va(this,!!e&&e.Sa)},t.prototype.Da=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Tn(t).get(qn.key).next((function(t){return Ee(!!t),t}))},t.prototype.da=function(t,e){return Tn(t).put(qn.key,e)},t.prototype.fa=function(t){if(t){var e=this.serializer.Pa(t);return e instanceof wt&&e.version.isEqual(b.min())?null:e}return null},t}();function Tn(t){return Zn.ho(t,qn.store)}function In(t){return Zn.ho(t,Un.store)}function Nn(t){return t.path.W()}function An(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw be();e=t.noDocument}return JSON.stringify(e).length}_n.va=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ca=e,r.Sa=n,r.Fa=new ke((function(t){return t.toString()})),r}return i.__extends(e,t),e.prototype.Zn=function(t){var e=this,n=[],r=0,i=new Ut((function(t,e){return Ie(t.j(),e.j())}));return this.Wn.forEach((function(o,s){var u=e.Fa.get(o);if(s){var a=e.Ca.serializer.Na(s,e.readTime);i=i.add(o.path.M());var h=An(a);r+=h-u,n.push(e.Ca.Gn(t,o,a))}else if(r-=u,e.Sa){var c=e.Ca.serializer.Na(new wt(o,b.min()),e.readTime);n.push(e.Ca.Gn(t,o,c))}else n.push(e.Ca.Hn(t,o))})),i.forEach((function(r){n.push(e.Ca.rr.Fo(t,r))})),n.push(this.Ca.updateMetadata(t,r)),Pe.Un(n)},e.prototype.Jn=function(t,e){var n=this;return this.Ca.Ta(t,e).next((function(t){return null===t?(n.Fa.set(e,0),null):(n.Fa.set(e,t.size),t.Ea)}))},e.prototype.Xn=function(t,e){var n=this;return this.Ca.wa(t,e).next((function(t){var e=t.Ra;return t.ma.forEach((function(t,e){n.Fa.set(t,e)})),e}))},e}(Ce);var xn=function(){function t(){this.ka=new Sn}return t.prototype.Fo=function(t,e){return this.ka.add(e),Pe.resolve()},t.prototype.wr=function(t,e){return Pe.resolve(this.ka.getEntries(e))},t}(),Sn=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.O(),n=t.M(),r=this.index[e]||new Ut(_.N),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.O(),n=t.M(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Ut(_.N)).W()},t}(),kn=10,Ln=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Ee(n<r&&n>=0&&r<=kn);var o=new on(e);n<1&&r>=1&&(function(t){t.createObjectStore(Rn.store)}(t),function(t){t.createObjectStore(On.store,{keyPath:On.keyPath}),t.createObjectStore(Pn.store,{keyPath:Pn.keyPath,autoIncrement:!0}).createIndex(Pn.userMutationsIndex,Pn.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Cn.store)}(t),zn(t),function(t){t.createObjectStore(Un.store)}(t));var s=Pe.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Fn.store),t.deleteObjectStore(jn.store),t.deleteObjectStore(Bn.store)}(t),zn(t)),s=s.next((function(){return function(t){var e=t.store(Bn.store),n=new Bn(0,0,b.min().C(),0);return e.put(Bn.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Pn.store).To().next((function(n){t.deleteObjectStore(Pn.store),t.createObjectStore(Pn.store,{keyPath:Pn.keyPath,autoIncrement:!0}).createIndex(Pn.userMutationsIndex,Pn.userMutationsKeyPath,{unique:!0});var r=e.store(Pn.store),i=n.map((function(t){return r.put(t)}));return Pe.Un(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Wn.store,{keyPath:Wn.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(qn.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Un.store);e.createIndex(Un.readTimeIndex,Un.readTimeIndexPath,{unique:!1}),e.createIndex(Un.collectionReadTimeIndex,Un.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Un.store).Ro((function(t,n){e+=An(n)})).next((function(){var n=new qn(e);return t.store(qn.store).put(qn.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(On.store),r=t.store(Pn.store);return n.To().next((function(n){return Pe.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.To(Pn.userMutationsIndex,i).next((function(r){return Pe.forEach(r,(function(r){Ee(r.userId===n.userId);var i=e.serializer.ko(r);return ln(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Fn.store),n=t.store(Un.store);return bn(t).next((function(t){var r=[];return n.Ro((function(n,i){var o=new _(n),s=function(t){return[0,Je(t)]}(o);r.push(e.get(s).next((function(n){return n?Pe.resolve():function(n){return e.put(new Fn(0,Je(n),t))}(o)})))})).next((function(){return Pe.Un(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Gn.store,{keyPath:Gn.keyPath});var n=e.store(Gn.store),r=new Sn,i=function(t){if(r.add(t)){var e=t.O(),i=t.M();return n.put({collectionId:e,parent:Je(i)})}};return e.store(Un.store).Ro({wo:!0},(function(t,e){var n=new _(t);return i(n.M())})).next((function(){return e.store(Cn.store).Ro({wo:!0},(function(t,e){t[0];var n=t[1],r=(t[2],tn(n));return i(r.M())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(jn.store);return n.Ro((function(t,r){var i=e.serializer.ha(r),o=e.serializer.oa(i);return n.put(o)}))},t}(),Dn=function(t,e){this.seconds=t,this.nanoseconds=e},Rn=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Rn.store="owner",Rn.key="owner";var On=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};On.store="mutationQueues",On.keyPath="userId";var Pn=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Pn.store="mutations",Pn.keyPath="batchId",Pn.userMutationsIndex="userMutationsIndex",Pn.userMutationsKeyPath=["userId","batchId"];var Cn=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Je(e)]},t.key=function(t,e,n){return[t,Je(e),n]},t}();Cn.store="documentMutations",Cn.PLACEHOLDER=new Cn;var Vn=function(t,e){this.path=t,this.readTime=e},Mn=function(t,e){this.path=t,this.version=e},Un=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Un.store="remoteDocuments",Un.readTimeIndex="readTimeIndex",Un.readTimeIndexPath="readTime",Un.collectionReadTimeIndex="collectionReadTimeIndex",Un.collectionReadTimeIndexPath=["parentPath","readTime"];var qn=function(t){this.byteSize=t};qn.store="remoteDocumentGlobal",qn.key="remoteDocumentGlobalKey";var jn=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};jn.store="targets",jn.keyPath="targetId",jn.queryTargetsIndexName="queryTargetsIndex",jn.queryTargetsKeyPath=["canonicalId","targetId"];var Fn=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Fn.store="targetDocuments",Fn.keyPath=["targetId","path"],Fn.documentTargetsIndex="documentTargetsIndex",Fn.documentTargetsKeyPath=["path","targetId"];var Bn=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Bn.key="targetGlobalKey",Bn.store="targetGlobal";var Gn=function(t,e){this.collectionId=t,this.parent=e};function zn(t){t.createObjectStore(Fn.store,{keyPath:Fn.keyPath}).createIndex(Fn.documentTargetsIndex,Fn.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(jn.store,{keyPath:jn.keyPath}).createIndex(jn.queryTargetsIndexName,jn.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Bn.store)}Gn.store="collectionParents",Gn.keyPath=["collectionId","parent"];var Wn=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Wn.store="clientMetadata",Wn.keyPath="clientId";var Kn=i.__spreadArrays(i.__spreadArrays(i.__spreadArrays([On.store,Pn.store,Cn.store,Un.store,jn.store,Rn.store,Bn.store,Fn.store],[Wn.store]),[qn.store]),[Gn.store]),Hn=function(){function t(){this.$a=new Sn}return t.prototype.Fo=function(t,e){var n=this;if(!this.$a.has(e)){var r=e.O(),i=e.M();t.er((function(){n.$a.add(e)}));var o={collectionId:r,parent:Je(i)};return Xn(t).put(o)}return Pe.resolve()},t.prototype.wr=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Ae(e),""],!1,!0);return Xn(t).To(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(tn(o.parent))}return n}))},t}();function Xn(t){return Zn.ho(t,Gn.store)}var Yn=function(){function t(t){this.Ma=t}return t.prototype.Pa=function(t){if(t.document)return this.Ma.Ai(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=N.st(t.noDocument.path),n=this.La(t.noDocument.readTime);return new wt(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var r=N.st(t.unknownDocument.path),i=this.La(t.unknownDocument.version);return new bt(r,i)}return be()},t.prototype.Na=function(t,e){var n=this.Aa(e),r=t.key.path.M().W();if(t instanceof mt){var i=this.Ma.mi(t),o=t.hasCommittedMutations;return new Un(null,null,i,o,n,r)}if(t instanceof wt){var s=t.key.path.W(),u=this.xa(t.version),a=t.hasCommittedMutations;return new Un(null,new Vn(s,u),null,a,n,r)}if(t instanceof bt){var h=t.key.path.W(),c=this.xa(t.version);return new Un(new Mn(h,c),null,null,!0,n,r)}return be()},t.prototype.Aa=function(t){var e=t.C();return[e.seconds,e.nanoseconds]},t.prototype.pa=function(t){var e=new w(t[0],t[1]);return b.v(e)},t.prototype.xa=function(t){var e=t.C();return new Dn(e.seconds,e.nanoseconds)},t.prototype.La=function(t){var e=new w(t.seconds,t.nanoseconds);return b.v(e)},t.prototype.Co=function(t,e){var n=this,r=e.baseMutations.map((function(t){return n.Ma.vi(t)})),i=e.mutations.map((function(t){return n.Ma.vi(t)}));return new Pn(t,e.batchId,e.Tn.toMillis(),r,i)},t.prototype.ko=function(t){var e=this,n=(t.baseMutations||[]).map((function(t){return e.Ma.Fi(t)})),r=t.mutations.map((function(t){return e.Ma.Fi(t)})),i=w.fromMillis(t.localWriteTimeMs);return new Le(t.batchId,i,n,r)},t.prototype.ha=function(t){var e,n=this.La(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.La(t.lastLimboFreeSnapshotVersion):b.min();return e=void 0!==t.query.documents?this.Ma.Oi(t.query):this.Ma.Wi(t.query),new Dt(e,t.targetId,0,t.lastListenSequenceNumber,n,r,k.fromBase64String(t.resumeToken))},t.prototype.oa=function(t){var e,n=this.xa(t.Ee),r=this.xa(t.lastLimboFreeSnapshotVersion);e=t.target.xt()?this.Ma.xi(t.target):this.Ma.Bi(t.target);var i=t.resumeToken.toBase64();return new jn(t.targetId,t.target.canonicalId(),n,i,t.sequenceNumber,r,e)},t}(),Qn="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Jn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).qo=e,r.Oa=n,r}return i.__extends(e,t),e}(Me),Zn=function(){function t(e,n,r,i,o,s,u,a){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Sr=s,this.Ba=a,this.qa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ua=null,this.inForeground=!1,this.Qa=null,this.Wa=null,this.ja=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!t.so())throw new p(l.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");if(this.Ao=new er(this,o),this.Ga=n+t.za,this.serializer=new Yn(u),this.document=i.document,this.Ha=new gn(this.Ao,this.serializer),this.rr=new Hn,this.ir=new _n(this.serializer,this.rr),!i.window||!i.window.localStorage)throw new p(l.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.Ya=this.window.localStorage}return t.ho=function(t,e){if(t instanceof Jn)return en.ho(t.qo,e);throw be()},t.prototype.start=function(){var t=this;return en.eo(this.Ga,kn,new Ln(this.serializer)).then((function(e){return t.Ja=e,t.Xa()})).then((function(){return t.Za(),t.tu(),t.eu(),t.Ja.runTransaction("readonly",[Bn.store],(function(t){return bn(t)}))})).then((function(e){t.su=new je(e,t.Ba)})).then((function(){t.qa=!0})).catch((function(e){return t.Ja&&t.Ja.close(),Promise.reject(e)}))},t.prototype.iu=function(t){var e=this;return this.Ka=function(n){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(e){return this.Uh?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.nu=function(t){var e=this;this.Ja.oo((function(n){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.ru=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Sr.Hr((function(){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.Uh?[4,this.Xa()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.Xa=function(){var t=this;return this.Ja.runTransaction("readwrite",Kn,(function(e){return tr(e).put(new Wn(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.hu(e).next((function(e){e||(t.isPrimary=!1,t.Sr.Hr((function(){return t.Ka(!1)})))}))})).next((function(){return t.ou(e)})).next((function(n){return t.isPrimary&&!n?t.au(e).next((function(){return!1})):!!n&&t.uu(e).next((function(){return!0}))}))})).catch((function(e){if(!t.allowTabSynchronization)throw e;return ge("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Sr.Hr((function(){return t.Ka(e)})),t.isPrimary=e}))},t.prototype.hu=function(t){var e=this;return $n(t).get(Rn.key).next((function(t){return Pe.resolve(e.cu(t))}))},t.prototype._u=function(t){return tr(t).delete(this.clientId)},t.prototype.lu=function(){return i.__awaiter(this,void 0,void 0,(function(){var e=this;return i.__generator(this,(function(n){switch(n.label){case 0:return!this.isPrimary||this.du(this.ja,18e5)?[3,2]:(this.ja=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(n){var r=t.ho(n,Wn.store);return r.To().next((function(t){var n=e.fu(t,18e5),i=t.filter((function(t){return-1===n.indexOf(t)}));return Pe.forEach(i,(function(t){return r.delete(t.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}))]);case 1:n.sent().forEach((function(t){e.window.localStorage.removeItem(e.Tu(t.clientId))})),n.label=2;case 2:return[2]}}))}))},t.prototype.eu=function(){var t=this;this.Wa=this.Sr.Br("client_metadata_refresh",4e3,(function(){return t.Xa().then((function(){return t.lu()})).then((function(){return t.eu()}))}))},t.prototype.cu=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.ou=function(t){var e=this;return $n(t).get(Rn.key).next((function(n){if(null!==n&&e.du(n.leaseTimestampMs,5e3)&&!e.Eu(n.ownerId)){if(e.cu(n)&&e.networkEnabled)return!0;if(!e.cu(n)){if(!n.allowTabSynchronization)throw new p(l.FAILED_PRECONDITION,Qn);return!1}}return!(!e.networkEnabled||!e.inForeground)||tr(t).To().next((function(t){return void 0===e.fu(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&ge("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.Iu=function(){return i.__awaiter(this,void 0,void 0,(function(){var t=this;return i.__generator(this,(function(e){switch(e.label){case 0:return this.qa=!1,this.wu(),this.Wa&&(this.Wa.cancel(),this.Wa=null),this.Ru(),this.mu(),[4,this.Ja.runTransaction("readwrite",[Rn.store,Wn.store],(function(e){return t.au(e).next((function(){return t._u(e)}))}))];case 1:return e.sent(),this.Ja.close(),this.Au(),[2]}}))}))},t.prototype.fu=function(t,e){var n=this;return t.filter((function(t){return n.du(t.updateTimeMs,e)&&!n.Eu(t.clientId)}))},t.prototype.Pu=function(){var t=this;return this.Ja.runTransaction("readonly",[Wn.store],(function(e){return tr(e).To().next((function(e){return t.fu(e,18e5).map((function(t){return t.clientId}))}))}))},t.clearPersistence=function(e){return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(r){switch(r.label){case 0:return t.so()?(n=e+t.za,[4,en.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"Uh",{get:function(){return this.qa},enumerable:!0,configurable:!0}),t.prototype.Vu=function(t){return cn.Vo(t,this.serializer,this.rr,this.Ao)},t.prototype.gu=function(){return this.Ha},t.prototype.pu=function(){return this.ir},t.prototype.yu=function(){return this.rr},t.prototype.runTransaction=function(t,e,n){var r=this;ge("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Ja.runTransaction(o,Kn,(function(o){return i=new Jn(o,r.su.next()),"readwrite-primary"===e?r.hu(o).next((function(t){return!!t||r.ou(o)})).next((function(e){if(!e)throw me("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Sr.Hr((function(){return r.Ka(!1)})),new p(l.FAILED_PRECONDITION,Ve);return n(i)})).next((function(t){return r.uu(o).next((function(){return t}))})):r.bu(o).next((function(){return n(i)}))})).then((function(t){return i.sr(),t}))},t.prototype.bu=function(t){var e=this;return $n(t).get(Rn.key).next((function(t){if(null!==t&&e.du(t.leaseTimestampMs,5e3)&&!e.Eu(t.ownerId)&&!e.cu(t)&&!t.allowTabSynchronization)throw new p(l.FAILED_PRECONDITION,Qn)}))},t.prototype.uu=function(t){var e=new Rn(this.clientId,this.allowTabSynchronization,Date.now());return $n(t).put(Rn.key,e)},t.so=function(){return en.so()},t.vu=function(t){var e=t.ii.projectId;return t.ii.ln||(e+="."+t.ii.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.au=function(t){var e=this,n=$n(t);return n.get(Rn.key).next((function(t){return e.cu(t)?(ge("IndexedDbPersistence","Releasing primary lease."),n.delete(Rn.key)):Pe.resolve()}))},t.prototype.du=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(me("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Za=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Qa=function(){t.Sr.Hr((function(){return t.inForeground="visible"===t.document.visibilityState,t.Xa()}))},this.document.addEventListener("visibilitychange",this.Qa),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Ru=function(){this.Qa&&(this.document.removeEventListener("visibilitychange",this.Qa),this.Qa=null)},t.prototype.tu=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.Ua=function(){t.wu(),t.Sr.Hr((function(){return t.Iu()}))},this.window.addEventListener("unload",this.Ua))},t.prototype.mu=function(){this.Ua&&(this.window.removeEventListener("unload",this.Ua),this.Ua=null)},t.prototype.Eu=function(t){try{var e=null!==this.Ya.getItem(this.Tu(t));return ge("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return me("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.wu=function(){try{this.Ya.setItem(this.Tu(this.clientId),String(Date.now()))}catch(t){me("Failed to set zombie client id.",t)}},t.prototype.Au=function(){try{this.Ya.removeItem(this.Tu(this.clientId))}catch(t){}},t.prototype.Tu=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function $n(t){return t.store(Rn.store)}function tr(t){return t.store(Wn.store)}Zn.za="main";var er=function(){function t(t,e){this.db=t,this.Su=null,this.Lh=new Qe(this,e)}return t.prototype.Kh=function(t){var e=this.Du(t);return this.db.gu().aa(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Du=function(t){var e=0;return this.zh(t,(function(t){e++})).next((function(){return e}))},t.prototype.js=function(t,e){return this.db.gu().js(t,e)},t.prototype.zh=function(t,e){return this.Cu(t,(function(t,n){return e(n)}))},t.prototype.Fu=function(t){this.Su=t},t.prototype.gn=function(t,e){return nr(t,e)},t.prototype.yn=function(t,e){return nr(t,e)},t.prototype.Hh=function(t,e,n){return this.db.gu().Hh(t,e,n)},t.prototype.Qo=function(t,e){return nr(t,e)},t.prototype.Nu=function(t,e){return this.Su.Fn(e)?Pe.resolve(!0):function(t,e){var n=!1;return yn(t).mo((function(r){return fn(t,r,e).next((function(t){return t&&(n=!0),Pe.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.Yh=function(t,e){var n=this,r=this.db.pu().ba(),i=[],o=0;return this.Cu(t,(function(s,u){if(u<=e){var a=n.Nu(t,s).next((function(e){if(!e)return o++,r.Yn(t,s).next((function(){return r.Hn(s),En(t).delete([0,Je(s.path)])}))}));i.push(a)}})).next((function(){return Pe.Un(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.Ie(t.Oa);return this.db.gu().ia(t,n)},t.prototype.ku=function(t,e){return nr(t,e)},t.prototype.Cu=function(t,e){var n,r=En(t),i=je.vr;return r.Ro({index:Fn.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==je.vr&&e(new N(tn(n)),i),i=u,n=s):i=je.vr})).next((function(){i!==je.vr&&e(new N(tn(n)),i)}))},t.prototype.Xh=function(t){return this.db.pu().Da(t)},t}();function nr(t,e){return En(t).put(function(t,e){return new Fn(0,Je(t.path),e)}(e,t.Oa))}var rr=function(){function t(t,e,n){this.persistence=t,this.$u=e,this.Mu=new Re,this.Lu=new Ct(Ie),this.xu=new ke((function(t){return t.canonicalId()})),this.Ou=b.min(),this.persistence.Ao.Fu(this.Mu),this.nr=t.Vu(n),this.Bu=t.pu(),this.Ha=t.gu(),this.qu=new Ue(this.Bu,this.nr,this.persistence.yu()),this.$u.Uu(this.qu)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Qu=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o=this;return i.__generator(this,(function(i){switch(i.label){case 0:return e=this.nr,n=this.qu,[4,this.persistence.runTransaction("Handle user change","readonly",(function(r){var i;return o.nr.xo(r).next((function(s){return i=s,e=o.persistence.Vu(t),n=new Ue(o.Bu,e,o.persistence.yu()),e.xo(r)})).next((function(t){for(var e=[],o=[],s=Xt(),u=0,a=i;u<a.length;u++){var h=a[u];e.push(h.batchId);for(var c=0,f=h.mutations;c<f.length;c++){var l=f[c];s=s.add(l.key)}}for(var p=0,d=t;p<d.length;p++){var y=d[p];o.push(y.batchId);for(var v=0,g=y.mutations;v<g.length;v++){var m=g[v];s=s.add(m.key)}}return n.cr(r,s).next((function(t){return{Wu:t,ju:e,Ku:o}}))}))}))];case 1:return r=i.sent(),[2,(this.nr=e,this.qu=n,this.$u.Uu(this.qu),r)]}}))}))},t.prototype.Gu=function(t){var e,n=this,r=w.now(),i=t.reduce((function(t,e){return t.add(e.key)}),Xt());return this.persistence.runTransaction("Locally write mutations","readwrite",(function(o){return n.qu.cr(o,i).next((function(i){e=i;for(var s=[],u=0,a=t;u<a.length;u++){var h=a[u],c=h.Pt(e.get(h.key));null!=c&&s.push(new at(h.key,c,dt(c.proto.mapValue),ot.exists(!0)))}return n.nr.Do(o,r,s,t)}))})).then((function(t){var n=t.In(e);return{batchId:t.batchId,Wn:n}}))},t.prototype.yo=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(n){var r=t.batch.keys(),i=e.Bu.ba({Sa:!0});return e.nr.yo(n,t.batch,t.streamToken).next((function(){return e.zu(n,t,i)})).next((function(){return i.apply(n)})).next((function(){return e.nr.Wo(n)})).next((function(){return e.qu.cr(n,r)}))}))},t.prototype.Hu=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",(function(n){var r;return e.nr.No(n,t).next((function(t){return Ee(null!==t),r=t.keys(),e.nr.Bo(n,t)})).next((function(){return e.nr.Wo(n)})).next((function(){return e.qu.cr(n,r)}))}))},t.prototype.Lo=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.nr.Lo(e)}))},t.prototype.vo=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",(function(e){return t.nr.vo(e)}))},t.prototype.So=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",(function(n){return e.nr.So(n,t)}))},t.prototype.Jo=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Ha.Jo(e)}))},t.prototype.Yu=function(e){var n=this,r=e.Ee,i=this.Lu;return this.persistence.runTransaction("Apply remote event","readwrite-primary",(function(o){var s=n.Bu.ba({Sa:!0});i=n.Lu;var u=[];e.as.forEach((function(e,s){var a=i.get(s);if(a){u.push(n.Ha._a(o,e.Is,s).next((function(){return n.Ha.ca(o,e.Ts,s)})));var h=e.resumeToken;if(h.rt()>0){var c=a.we(h,r).Ie(o.Oa);i=i.me(s,c),t.Ju(a,c,e)&&u.push(n.Ha.ia(o,c))}}}));var a=Ft(),h=Xt();if(e.cs.forEach((function(t,e){h=h.add(t)})),u.push(s.getEntries(o,h).next((function(t){e.cs.forEach((function(i,h){var c=t.get(i);h instanceof wt&&h.version.isEqual(b.min())?(s.Hn(i,r),a=a.me(i,h)):null==c||h.version.S(c.version)>0||0===h.version.S(c.version)&&c.hasPendingWrites?(s.Gn(h,r),a=a.me(i,h)):ge("LocalStore","Ignoring outdated watch update for ",i,". Current version:",c.version," Watch version:",h.version),e._s.has(i)&&u.push(n.persistence.Ao.ku(o,i))}))}))),!r.isEqual(b.min())){var c=n.Ha.Jo(o).next((function(t){return n.Ha.Zo(o,o.Oa,r)}));u.push(c)}return Pe.Un(u).next((function(){return s.apply(o)})).next((function(){return n.qu._r(o,a)}))})).then((function(t){return n.Lu=i,t}))},t.Ju=function(t,e,n){return Ee(e.resumeToken.rt()>0),0===t.resumeToken.rt()||e.Ee.D()-t.Ee.D()>=this.Xu||n.Ts.size+n.Es.size+n.Is.size>0},t.prototype.Zu=function(t){for(var e=this,n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(this.Mu.pn(i.Ar,o),this.Mu.vn(i.Pr,o),!i.fromCache){var s=this.Lu.get(o),u=s.Ee,a=s.Re(u);this.Lu=this.Lu.me(o,a)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(n){return Pe.forEach(t,(function(t){return Pe.forEach(t.Pr,(function(t){return e.persistence.Ao.yn(n,t)}))}))}))},t.prototype.tc=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",(function(n){return void 0===t&&(t=-1),e.nr.Mo(n,t)}))},t.prototype.ec=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",(function(n){return e.qu.hr(n,t)}))},t.prototype.sc=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite",(function(n){var r;return e.Ha.ua(n,t).next((function(i){return i?(r=i,Pe.resolve(r)):e.Ha.zo(n).next((function(i){return r=new Dt(t,i,0,n.Oa),e.Ha.ta(n,r).next((function(){return r}))}))}))})).then((function(n){return null===e.Lu.get(n.targetId)&&(e.Lu=e.Lu.me(n.targetId,n),e.xu.set(t,n.targetId)),n}))},t.prototype.ua=function(t,e){var n=this.xu.get(e);return void 0!==n?Pe.resolve(this.Lu.get(n)):this.Ha.ua(t,e)},t.prototype.ic=function(t,e){var n=this,r=this.Lu.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,(function(i){var o=n.Mu.Sn(t);return e?Pe.resolve():Pe.forEach(o,(function(t){return n.persistence.Ao.yn(i,t)})).next((function(){n.persistence.Ao.removeTarget(i,r)}))})).then((function(){n.Lu=n.Lu.remove(t),n.xu.delete(r.target)}))},t.prototype.nc=function(t,e){var n=this,r=b.min(),i=Xt();return this.persistence.runTransaction("Execute query","readonly",(function(o){return n.ua(o,t.ee()).next((function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.Ha.la(o,t.targetId).next((function(t){i=t}))})).next((function(){return n.$u.dr(o,t,e?r:b.min(),e?i:Xt())})).next((function(t){return{documents:t,rc:i}}))}))},t.prototype.hc=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly",(function(n){return e.Ha.la(n,t)}))},t.prototype.zu=function(t,e,n){var r=this,i=e.batch,o=i.keys(),s=Pe.resolve();return o.forEach((function(r){s=s.next((function(){return n.Yn(t,r)})).next((function(t){var o=t,s=e.Rn.get(r);Ee(null!==s),(!o||o.version.S(s)<0)&&(o=i.at(r,o,e))&&n.Gn(o,e.wn)}))})),s.next((function(){return r.nr.Bo(t,i)}))},t.prototype.Qh=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Jh(n,e.Lu)}))},t}();rr.Xu=3e8;var ir=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).persistence=e,i.nr=e.Vu(r),i.Bu=e.pu(),i.Ha=e.gu(),i}return i.__extends(e,t),e.prototype.start=function(){return this.oc()},e.prototype.ac=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",(function(n){return e.nr.$o(n,t).next((function(t){return t?e.qu.cr(n,t):Pe.resolve(null)}))}))},e.prototype.uc=function(t){this.nr.Uo(t)},e.prototype.ru=function(t){this.persistence.ru(t)},e.prototype.Pu=function(){return this.persistence.Pu()},e.prototype.cc=function(t){var e=this,n=this.Lu.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly",(function(n){return e.Ha.si(n,t).next((function(t){return t?t.target:null}))}))},e.prototype.Va=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",(function(e){return t.Bu.Va(e,t.Ou)})).then((function(e){var n=e.ga,r=e.readTime;return t.Ou=r,n}))},e.prototype.oc=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e=this;return i.__generator(this,(function(n){switch(n.label){case 0:return t=this,[4,this.persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return e.Bu.ya(t)}))];case 1:return t.Ou=n.sent(),[2]}}))}))},e}(rr);function or(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){if(t.code!==l.FAILED_PRECONDITION||t.message!==Ve)throw t;return ge("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function sr(t,e){if(0!==e.length)throw new p(l.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Tr(e.length,"argument")+".")}function ur(t,e,n){if(e.length!==n)throw new p(l.INVALID_ARGUMENT,"Function "+t+"() requires "+Tr(n,"argument")+", but was called with "+Tr(e.length,"argument")+".")}function ar(t,e,n){if(e.length<n)throw new p(l.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Tr(n,"argument")+", but was called with "+Tr(e.length,"argument")+".")}function hr(t,e,n,r){if(e.length<n||e.length>r)throw new p(l.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Tr(e.length,"argument")+".")}function cr(t,e,n,r){yr(t,e,_r(n)+" argument",r)}function fr(t,e,n,r){void 0!==r&&cr(t,e,n,r)}function lr(t,e,n,r){yr(t,e,n+" option",r)}function pr(t,e,n,r){void 0!==r&&lr(t,e,n,r)}function dr(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,u=i;s<u.length;s++){var a=u[s];if(a===r)return;o.push(gr(a))}var h=gr(r);throw new p(l.INVALID_ARGUMENT,"Invalid value "+h+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function yr(t,e,n,r){if(!("object"===e?vr(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=gr(r);throw new p(l.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function vr(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function gr(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":be()}function mr(t,e,n){if(void 0===n)throw new p(l.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+_r(e)+" argument, but it was undefined.")}function wr(t,e,n){x(e,(function(e,r){if(n.indexOf(e)<0)throw new p(l.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function br(t,e,n,r){var i=gr(r);return new p(l.INVALID_ARGUMENT,"Function "+t+"() requires its "+_r(n)+" argument to be a "+e+", but it was: "+i)}function Er(t,e,n){if(n<=0)throw new p(l.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+_r(e)+" argument to be a positive number, but it was: "+n+".")}function _r(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Tr(t,e){return t+" "+e+(1===t?"":"s")}function Ir(){if("undefined"==typeof Uint8Array)throw new p(l.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Nr(){if(!pe.nt()._c)throw new p(l.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ar=function(){function t(t){Nr(),this.lc=t}return t.fromBase64String=function(e){ur("Blob.fromBase64String",arguments,1),cr("Blob.fromBase64String","string",1,e),Nr();try{return new t(k.fromBase64String(e))}catch(e){throw new p(l.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if(ur("Blob.fromUint8Array",arguments,1),Ir(),!(e instanceof Uint8Array))throw br("Blob.fromUint8Array","Uint8Array",1,e);return new t(k.fromUint8Array(e))},t.prototype.toBase64=function(){return ur("Blob.toBase64",arguments,0),Nr(),this.lc.toBase64()},t.prototype.toUint8Array=function(){return ur("Blob.toUint8Array",arguments,0),Ir(),this.lc.toUint8Array()},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.lc.isEqual(t.lc)},t}(),xr=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new p(l.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+Tr(1,"element")+".")}(0,t);for(var n=0;n<t.length;++n)if(cr("FieldPath","string",n,t[n]),0===t[n].length)throw new p(l.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.dc=new I(t)}return t.documentId=function(){return t.fc},t.prototype.isEqual=function(e){if(!(e instanceof t))throw br("isEqual","FieldPath",1,e);return this.dc.isEqual(e.dc)},t}();xr.fc=new xr(I.J().j());var Sr=new RegExp("[~\\*/\\[\\]]"),kr=function(t){this.Tc=t},Lr=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return i.__extends(e,t),e.prototype.Di=function(t){if(2!==t.Ec)throw 1===t.Ec?t.Ic("FieldValue.delete() can only appear at the top level of your update data"):t.Ic("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(kr),Dr=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return i.__extends(e,t),e.prototype.Di=function(t){return new rt(t.path,J.instance)},e.prototype.isEqual=function(t){return t instanceof e},e}(kr),Rr=function(t){function e(e){var n=this;return(n=t.call(this,"FieldValue.arrayUnion")||this).wc=e,n}return i.__extends(e,t),e.prototype.Di=function(t){var e=t.Rc({Ec:3,methodName:this.Tc}),n=this.wc.map((function(t,n){return Br(t,e.mc(n))})),r=new Z(n);return new rt(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(kr),Or=function(t){function e(e){var n=this;return(n=t.call(this,"FieldValue.arrayRemove")||this).wc=e,n}return i.__extends(e,t),e.prototype.Di=function(t){var e=t.Rc({Ec:3,methodName:this.Tc}),n=this.wc.map((function(t,n){return Br(t,e.mc(n))})),r=new $(n);return new rt(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(kr),Pr=function(t){function e(e){var n=this;return(n=t.call(this,"FieldValue.increment")||this).Ac=e,n}return i.__extends(e,t),e.prototype.Di=function(t){t.Rc({methodName:this.Tc});var e=Br(this.Ac,t),n=new tt(t.serializer,e);return new rt(t.path,n)},e.prototype.isEqual=function(t){return this===t},e}(kr),Cr=function(){function t(t,e){if(ur("GeoPoint",arguments,2),cr("GeoPoint","number",1,t),cr("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new p(l.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new p(l.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Pc=t,this.Vc=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.Pc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.Vc},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this.Pc===t.Pc&&this.Vc===t.Vc},t.prototype.p=function(t){return Ie(this.Pc,t.Pc)||Ie(this.Vc,t.Vc)},t}(),Vr=/^__.*__$/,Mr=function(){function t(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}return t.prototype.gc=function(t,e){var n=[];return null!==this.Vt?n.push(new at(t,this.data,this.Vt,e)):n.push(new ut(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new ht(t,this.fieldTransforms)),n},t}(),Ur=function(){function t(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}return t.prototype.gc=function(t,e){var n=[new at(t,this.data,this.Vt,e)];return this.fieldTransforms.length>0&&n.push(new ht(t,this.fieldTransforms)),n},t}();function qr(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw be()}}var jr=function(){function t(t,e,n,r,i){this.settings=t,this.ii=e,this.serializer=n,void 0===r&&this.pc(),this.fieldTransforms=r||[],this.Vt=i||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Ec",{get:function(){return this.settings.Ec},enumerable:!0,configurable:!0}),t.prototype.Rc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.ii,this.serializer,this.fieldTransforms,this.Vt)},t.prototype.yc=function(t){var e=null==this.path?null:this.path.child(t),n=this.Rc({path:e,bc:!1});return n.vc(t),n},t.prototype.Sc=function(t){var e=null==this.path?null:this.path.child(t),n=this.Rc({path:e,bc:!1});return n.pc(),n},t.prototype.mc=function(t){return this.Rc({path:null,bc:!0})},t.prototype.Ic=function(t){var e=null===this.path||this.path.B()?"":" (found in field "+this.path.toString()+")";return new p(l.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.Vt.find((function(e){return t.q(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.q(e.field)}))},t.prototype.pc=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.vc(this.path.get(t))},t.prototype.vc=function(t){if(0===t.length)throw this.Ic("Document fields must not be empty");if(qr(this.Ec)&&Vr.test(t))throw this.Ic('Document fields cannot begin and end with "__"')},t}(),Fr=function(){function t(t,e){this.ii=t,this.serializer=e||pe.nt().Dc(t)}return t.prototype.Cc=function(t,e){var n=this.Fc(0,t);Wr("Data must be an object, but it was:",n,e);var r=Gr(e,n);return new Mr(new lt(r),null,n.fieldTransforms)},t.prototype.Nc=function(t,e,n){var r=this.Fc(2,t);Wr("Data must be an object, but it was:",r,e);var i,o,s=Gr(e,r);if(n){for(var u=[],a=0,h=n;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof xr)f=c.dc;else{if("string"!=typeof c)throw be();f=Hr(t,c)}if(!r.contains(f))throw new p(l.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Xr(u,f)||u.push(f)}i=new nt(u),o=r.fieldTransforms.filter((function(t){return i.dt(t.field)}))}else i=new nt(r.Vt),o=r.fieldTransforms;return new Mr(new lt(s),i,o)},t.prototype.kc=function(t,e){var n=this.Fc(1,t);Wr("Data must be an object, but it was:",n,e);var r=[],i=new pt;x(e,(function(e,o){var s=Hr(t,e),u=n.Sc(s);if(o instanceof Lr)r.push(s);else{var a=Br(o,u);null!=a&&(r.push(s),i.set(s,a))}}));var o=new nt(r);return new Ur(i.yt(),o,n.fieldTransforms)},t.prototype.$c=function(t,e,n,r){var i=this.Fc(1,t),o=[Kr(t,e)],s=[n];if(r.length%2!=0)throw new p(l.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<r.length;u+=2)o.push(Kr(t,r[u])),s.push(r[u+1]);for(var a=[],h=new pt,c=o.length-1;c>=0;--c)if(!Xr(a,o[c])){var f=o[c],d=s[c],y=i.Sc(f);if(d instanceof Lr)a.push(f);else{var v=Br(d,y);null!=v&&(a.push(f),h.set(f,v))}}var g=new nt(a);return new Ur(h.yt(),g,i.fieldTransforms)},t.prototype.Fc=function(t,e){return new jr({Ec:t,methodName:e,path:I.G,bc:!1},this.ii,this.serializer)},t.prototype.Mc=function(t,e,n){return void 0===n&&(n=!1),Br(e,this.Fc(n?4:3,t))},t}();function Br(t,e){if(zr(t))return Wr("Unsupported field value:",e,t),Gr(t,e);if(t instanceof kr)return function(t,e){if(!qr(e.Ec))throw e.Ic(t.Tc+"() can only be used with update() and set()");if(null===e.path)throw e.Ic(t.Tc+"() is not currently supported inside arrays");var n=t.Di(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Vt.push(e.path),t instanceof Array){if(e.settings.bc&&4!==e.Ec)throw e.Ic("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Br(o[i],e.mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=w.fromDate(t);return{timestampValue:e.serializer.C(n)}}if(t instanceof w){var r=new w(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.C(r)}}if(t instanceof Cr)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ar)return{bytesValue:e.serializer.ui(t)};if(t instanceof Fi){var i=e.ii,o=t.firestore.Lc;if(!o.isEqual(i))throw e.Ic("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:e.serializer._i(t.xc.path,t.firestore.Lc)}}throw e.Ic("Unsupported field value: "+gr(t))}(t,e)}function Gr(t,e){var n={};return S(t)?e.path&&e.path.length>0&&e.Vt.push(e.path):x(t,(function(t,r){var i=Br(r,e.yc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function zr(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof w||t instanceof Cr||t instanceof Ar||t instanceof Fi||t instanceof kr)}function Wr(t,e,n){if(!zr(n)||!vr(n)){var r=gr(n);throw"an object"===r?e.Ic(t+" a custom object"):e.Ic(t+" "+r)}}function Kr(t,e){if(e instanceof xr)return e.dc;if("string"==typeof e)return Hr(t,e);throw new p(l.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Hr(t,e){try{return function(t){if(t.search(Sr)>=0)throw new p(l.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(xr.bind.apply(xr,i.__spreadArrays([void 0],t.split("."))))}catch(i){throw new p(l.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).dc}catch(e){var n=(r=e)instanceof Error?r.message:r.toString();throw new p(l.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}var r}function Xr(t,e){return t.some((function(t){return t.isEqual(e)}))}var Yr=function(){function t(t,e,n,r,i,o){this.Sr=t,this.Oc=n,this.Bc=r,this.qc=i,this.listener=o,this.state=0,this.Uc=0,this.Qc=null,this.stream=null,this.ih=new Be(t,e)}return t.prototype.Wc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.jc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Kc()},t.prototype.stop=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.Wc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Gc=function(){this.state=0,this.ih.reset()},t.prototype.zc=function(){var t=this;this.jc()&&null===this.Qc&&(this.Qc=this.Sr.Br(this.Oc,6e4,(function(){return t.Hc()})))},t.prototype.Yc=function(t){this.Jc(),this.stream.send(t)},t.prototype.Hc=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){return this.jc()?[2,this.close(0)]:[2]}))}))},t.prototype.Jc=function(){this.Qc&&(this.Qc.cancel(),this.Qc=null)},t.prototype.close=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(n){switch(n.label){case 0:return this.Jc(),this.ih.cancel(),this.Uc++,3!==t?this.ih.reset():e&&e.code===l.RESOURCE_EXHAUSTED?(me(e.toString()),me("Using maximum backoff delay to prevent overloading the backend."),this.ih.Lr()):e&&e.code===l.UNAUTHENTICATED&&this.qc._(),null!==this.stream&&(this.Xc(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Zc(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.Xc=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.t_(this.Uc),n=this.Uc;this.qc.getToken().then((function(e){t.Uc===n&&t.e_(e)}),(function(n){e((function(){var e=new p(l.UNKNOWN,"Fetching auth token failed: "+n.message);return t.s_(e)}))}))},t.prototype.e_=function(t){var e=this,n=this.t_(this.Uc);this.stream=this.i_(t),this.stream.n_((function(){n((function(){return e.state=2,e.listener.n_()}))})),this.stream.Zc((function(t){n((function(){return e.s_(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Kc=function(){var t=this;this.state=4,this.ih.xr((function(){return i.__awaiter(t,void 0,void 0,(function(){return i.__generator(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.s_=function(t){return ge("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.t_=function(t){var e=this;return function(n){e.Sr.Hr((function(){return e.Uc===t?n():(ge("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Qr=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return i.__extends(e,t),e.prototype.i_=function(t){return this.Bc.r_("Listen",t)},e.prototype.onMessage=function(t){this.ih.reset();var e=this.serializer.pi(t),n=this.serializer.bi(t);return this.listener.h_(e,n)},e.prototype.o_=function(t){var e={};e.database=this.serializer.wi,e.addTarget=this.serializer.ee(t);var n=this.serializer.zi(t);n&&(e.labels=n),this.Yc(e)},e.prototype.a_=function(t){var e={};e.database=this.serializer.wi,e.removeTarget=t,this.Yc(e)},e}(Yr),Jr=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.u_=!1,s.lastStreamToken=k.ht,s}return i.__extends(e,t),Object.defineProperty(e.prototype,"c_",{get:function(){return this.u_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.u_=!1,t.prototype.start.call(this)},e.prototype.Xc=function(){this.u_&&this.__([])},e.prototype.i_=function(t){return this.Bc.r_("Write",t)},e.prototype.onMessage=function(t){if(Ee(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.u_){this.ih.reset();var e=this.serializer.Li(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.l_(n,e)}return Ee(!t.writeResults||0===t.writeResults.length),this.u_=!0,this.listener.d_()},e.prototype.f_=function(){var t={};t.database=this.serializer.wi,this.Yc(t)},e.prototype.__=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map((function(t){return e.serializer.vi(t)}))};this.Yc(n)},e}(Yr),Zr=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Bc=e,i.credentials=n,i.serializer=r,i}return i.__extends(e,t),e.prototype.E_=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.Bc.E_(t,e,r)})).catch((function(t){throw t.code===l.UNAUTHENTICATED&&n.credentials._(),t}))},e.prototype.I_=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.Bc.I_(t,e,r)})).catch((function(t){throw t.code===l.UNAUTHENTICATED&&n.credentials._(),t}))},e}((function(){this.T_=void 0})),$r=function(){function t(t){this.w_=t,this.R_=Kt(),this.mutations=[],this.m_=!1,this.A_=null,this.P_=new Set}return t.prototype.V_=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n=this;return i.__generator(this,(function(r){switch(r.label){case 0:if(this.g_(),this.mutations.length>0)throw new p(l.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,s,u;return i.__generator(this,(function(i){switch(i.label){case 0:return n=_e(t),r={database:n.serializer.wi,documents:e.map((function(t){return n.serializer.fi(t)}))},[4,n.I_("BatchGetDocuments",r)];case 1:return o=i.sent(),s=new Map,o.forEach((function(t){var e=n.serializer.gi(t);s.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=s.get(t.toString());Ee(!!e),u.push(e)})),u)]}}))}))}(this.w_,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof wt||t instanceof mt?n.p_(t):be()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.gc(t,this.Rt(t))),this.P_.add(t)},t.prototype.update=function(t,e){try{this.write(e.gc(t,this.y_(t)))}catch(t){this.A_=t}this.P_.add(t)},t.prototype.delete=function(t){this.write([new ct(t,this.Rt(t))]),this.P_.add(t)},t.prototype.commit=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e=this;return i.__generator(this,(function(n){switch(n.label){case 0:if(this.g_(),this.A_)throw this.A_;return t=this.R_,this.mutations.forEach((function(e){t=t.remove(e.key)})),t.forEach((function(t,n){e.mutations.push(new ft(t,e.Rt(t)))})),[4,function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o;return i.__generator(this,(function(i){switch(i.label){case 0:return n=_e(t),r={database:n.serializer.wi,writes:e.map((function(t){return n.serializer.vi(t)}))},[4,n.E_("Commit",r)];case 1:return o=i.sent(),[2,n.serializer.Li(o.writeResults,o.commitTime)]}}))}))}(this.w_,this.mutations)];case 1:return n.sent(),this.m_=!0,[2]}}))}))},t.prototype.p_=function(t){var e;if(t instanceof mt)e=t.version;else{if(!(t instanceof wt))throw be();e=b.min()}var n=this.R_.get(t.key);if(null!==n){if(!e.isEqual(n))throw new p(l.ABORTED,"Document version changed between two reads.")}else this.R_=this.R_.me(t.key,e)},t.prototype.Rt=function(t){var e=this.R_.get(t);return!this.P_.has(t)&&e?ot.updateTime(e):ot.ft()},t.prototype.y_=function(t){var e=this.R_.get(t);if(!this.P_.has(t)&&e){if(e.isEqual(b.min()))throw new p(l.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ot.updateTime(e)}return ot.exists(!0)},t.prototype.write=function(t){this.g_(),this.mutations=this.mutations.concat(t)},t.prototype.g_=function(){},t}(),ti=function(){function t(t,e){this.qr=t,this.b_=e,this.state="Unknown",this.v_=0,this.S_=null,this.D_=!0}return t.prototype.C_=function(){var t=this;0===this.v_&&(this.F_("Unknown"),this.S_=this.qr.Br("online_state_timeout",1e4,(function(){return t.S_=null,t.N_("Backend didn't respond within 10 seconds."),t.F_("Offline"),Promise.resolve()})))},t.prototype.k_=function(t){"Online"===this.state?this.F_("Unknown"):(this.v_++,this.v_>=1&&(this.M_(),this.N_("Connection failed 1 times. Most recent error: "+t.toString()),this.F_("Offline")))},t.prototype.set=function(t){this.M_(),this.v_=0,"Online"===t&&(this.D_=!1),this.F_(t)},t.prototype.F_=function(t){t!==this.state&&(this.state=t,this.b_(t))},t.prototype.N_=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.D_?(me(e),this.D_=!1):ge("OnlineStateTracker",e)},t.prototype.M_=function(){null!==this.S_&&(this.S_.cancel(),this.S_=null)},t}(),ei=function(){function t(t,e,n,r,o){var s=this;this.L_=t,this.w_=e,this.qr=n,this.x_=[],this.O_=new Map,this.B_=null,this.networkEnabled=!1,this.isPrimary=!1,this.q_=!1,this.U_=o,this.U_.Q_((function(t){n.Hr((function(){return i.__awaiter(s,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.W_()?(ge("RemoteStore","Restarting streams for network reachability change."),[4,this.j_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.K_=new ti(n,r),this.G_=function(t,e,n){var r=_e(t);return new Qr(e,r.Bc,r.credentials,r.serializer,n)}(this.w_,n,{n_:this.z_.bind(this),Zc:this.H_.bind(this),h_:this.Y_.bind(this)}),this.J_=function(t,e,n){var r=_e(t);return new Jr(e,r.Bc,r.credentials,r.serializer,n)}(this.w_,n,{n_:this.X_.bind(this),Zc:this.Z_.bind(this),d_:this.tl.bind(this),l_:this.l_.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.el()},t.prototype.el=function(){return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(e){switch(e.label){case 0:return this.W_()?(t=this.J_,[4,this.L_.vo()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.sl()?this.il():this.K_.set("Unknown"),[4,this.nl()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},t.prototype.disableNetwork=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.rl()];case 1:return t.sent(),this.K_.set("Offline"),[2]}}))}))},t.prototype.rl=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return[4,this.J_.stop()];case 1:return t.sent(),[4,this.G_.stop()];case 2:return t.sent(),this.x_.length>0&&(ge("RemoteStore","Stopping write stream with "+this.x_.length+" pending writes"),this.x_=[]),this.hl(),[2]}}))}))},t.prototype.Iu=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return ge("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.rl()];case 1:return t.sent(),this.U_.Iu(),this.K_.set("Unknown"),[2]}}))}))},t.prototype.listen=function(t){this.O_.has(t.targetId)||(this.O_.set(t.targetId,t),this.sl()?this.il():this.G_.jc()&&this.ol(t))},t.prototype.al=function(t){this.O_.delete(t),this.G_.jc()&&this.ul(t),0===this.O_.size&&(this.G_.jc()?this.G_.zc():this.W_()&&this.K_.set("Unknown"))},t.prototype.si=function(t){return this.O_.get(t)||null},t.prototype.ei=function(t){return this.cl.ei(t)},t.prototype.ol=function(t){this.B_.Ns(t.targetId),this.G_.o_(t)},t.prototype.ul=function(t){this.B_.Ns(t),this.G_.a_(t)},t.prototype.il=function(){this.B_=new se(this),this.G_.start(),this.K_.C_()},t.prototype.sl=function(){return this.W_()&&!this.G_.Wc()&&this.O_.size>0},t.prototype.W_=function(){return!this.q_&&this.isPrimary&&this.networkEnabled},t.prototype.hl=function(){this.B_=null},t.prototype.z_=function(){return i.__awaiter(this,void 0,void 0,(function(){var t=this;return i.__generator(this,(function(e){return this.O_.forEach((function(e,n){t.ol(e)})),[2]}))}))},t.prototype.H_=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return this.hl(),this.sl()?(this.K_.k_(t),this.il()):this.K_.set("Unknown"),[2]}))}))},t.prototype.Y_=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o;return i.__generator(this,(function(i){switch(i.label){case 0:if(this.K_.set("Online"),!(t instanceof ie&&2===t.state&&t.cause))return[3,6];i.label=1;case 1:return i.trys.push([1,3,,5]),[4,this._l(t)];case 2:return i.sent(),[3,5];case 3:return n=i.sent(),ge("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),[4,this.ll(n)];case 4:return i.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof ne?this.B_.qs(t):t instanceof re?this.B_.Hs(t):this.B_.Ws(t),e.isEqual(b.min()))return[3,13];i.label=7;case 7:return i.trys.push([7,11,,13]),[4,this.L_.Jo()];case 8:return r=i.sent(),e.S(r)>=0?[4,this.dl(e)]:[3,10];case 9:i.sent(),i.label=10;case 10:return[3,13];case 11:return ge("RemoteStore","Failed to raise snapshot:",o=i.sent()),[4,this.ll(o)];case 12:return i.sent(),[3,13];case 13:return[2]}}))}))},t.prototype.ll=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e=this;return i.__generator(this,(function(n){switch(n.label){case 0:if("IndexedDbTransactionError"!==t.name)throw t;return this.q_=!0,[4,this.rl()];case 1:return n.sent(),this.K_.set("Offline"),this.qr.dh((function(){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return ge("RemoteStore","Retrying IndexedDB access"),[4,this.L_.Jo()];case 1:return t.sent(),this.q_=!1,[4,this.el()];case 2:return t.sent(),[2]}}))}))})),[2]}}))}))},t.prototype.dl=function(t){var e=this,n=this.B_.Xs(t);return n.as.forEach((function(n,r){if(n.resumeToken.rt()>0){var i=e.O_.get(r);i&&e.O_.set(r,i.we(n.resumeToken,t))}})),n.us.forEach((function(t){var n=e.O_.get(t);if(n){e.O_.set(t,n.we(k.ht,n.Ee)),e.ul(t);var r=new Dt(n.target,t,1,n.sequenceNumber);e.ol(r)}})),this.cl.Yu(n)},t.prototype._l=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o;return i.__generator(this,(function(i){switch(i.label){case 0:e=t.cause,n=0,r=t.targetIds,i.label=1;case 1:return n<r.length?(o=r[n],this.O_.has(o)?[4,this.cl.fl(o,e)]:[3,3]):[3,5];case 2:i.sent(),this.O_.delete(o),this.B_.removeTarget(o),i.label=3;case 3:i.label=4;case 4:return n++,[3,1];case 5:return[2]}}))}))},t.prototype.nl=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e;return i.__generator(this,(function(n){switch(n.label){case 0:return this.Tl()?(t=this.x_.length>0?this.x_[this.x_.length-1].batchId:-1,[4,this.L_.tc(t)]):[3,5];case 1:return null!==(e=n.sent())?[3,2]:(0===this.x_.length&&this.J_.zc(),[3,4]);case 2:return this.El(e),[4,this.nl()];case 3:n.sent(),n.label=4;case 4:n.label=5;case 5:return this.Il()&&this.wl(),[2]}}))}))},t.prototype.Tl=function(){return this.W_()&&this.x_.length<10},t.prototype.Rl=function(){return this.x_.length},t.prototype.El=function(t){this.x_.push(t),this.J_.jc()&&this.J_.c_&&this.J_.__(t.mutations)},t.prototype.Il=function(){return this.W_()&&!this.J_.Wc()&&this.x_.length>0},t.prototype.wl=function(){this.J_.start()},t.prototype.X_=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){return this.J_.f_(),[2]}))}))},t.prototype.tl=function(){var t=this;return this.L_.So(this.J_.lastStreamToken).then((function(){for(var e=0,n=t.x_;e<n.length;e++){var r=n[e];t.J_.__(r.mutations)}})).catch(or)},t.prototype.l_=function(t,e){var n=this,r=this.x_.shift(),i=De.from(r,t,e,this.J_.lastStreamToken);return this.cl.ml(i).then((function(){return n.nl()}))},t.prototype.Z_=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return t&&this.x_.length>0?this.J_.c_?[4,this.Al(t)]:[3,2]:[3,5];case 1:return e.sent(),[3,4];case 2:return[4,this.Pl(t)];case 3:e.sent(),e.label=4;case 4:this.Il()&&this.wl(),e.label=5;case 5:return[2]}}))}))},t.prototype.Pl=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return Ot(t.code)?[2,(ge("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.J_.lastStreamToken),this.J_.lastStreamToken=k.ht,this.L_.So(k.ht).catch(or))]:[2]}))}))},t.prototype.Al=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r=this;return i.__generator(this,(function(i){return Ot(n=t.code)&&n!==l.ABORTED?(e=this.x_.shift(),[2,(this.J_.Gc(),this.cl.Vl(e.batchId,t).then((function(){return r.nl()})))]):[2]}))}))},t.prototype.gl=function(){return new $r(this.w_)},t.prototype.j_=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.rl()];case 1:return t.sent(),this.K_.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}}))}))},t.prototype.pl=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.W_()?(ge("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.j_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.yl=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,5];case 2:return t?[3,4]:[4,this.rl()];case 3:e.sent(),this.K_.set("Unknown"),e.label=4;case 4:e.label=5;case 5:return[2]}}))}))},t}();function ni(t,e){return"firestore_clients_"+t+"_"+e}function ri(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.t()&&(r+="_"+e.uid),r}function ii(t,e){return"firestore_targets_"+t+"_"+e}var oi=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.bl=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new p(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(me("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.vl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),si=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.bl=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new p(r.error.code,r.error.message)),i?new t(e,r.state,o):(me("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.vl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ui=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.bl=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Qt(),s=0;i&&s<r.activeTargetIds.length;++s)i=R(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(me("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),ai=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.bl=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(me("SharedClientState","Failed to parse online state: "+e),null)},t}(),hi=function(){function t(){this.activeTargetIds=Qt()}return t.prototype.Sl=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Dl=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.vl=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),ci=function(){function t(e,n,r,i,o){if(this.Sr=e,this.platform=n,this.persistenceKey=r,this.Cl=i,this.cl=null,this.b_=null,this.gr=null,this.Fl=this.Nl.bind(this),this.kl=new Ct(Ie),this.Uh=!1,this.$l=[],!t.so(this.platform))throw new p(l.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.Ml=ni(this.persistenceKey,this.Cl),this.Ll=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.kl=this.kl.me(this.Cl,new hi),this.xl=new RegExp("^firestore_clients_"+s+"_([^_]*)$"),this.Ol=new RegExp("^firestore_mutations_"+s+"_(\\d+)(?:_(.*))?$"),this.Bl=new RegExp("^firestore_targets_"+s+"_(\\d+)$"),this.ql=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.platform.window.addEventListener("storage",this.Fl)}return t.so=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,o,s,u,a,h,c,f,l=this;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this.cl.Pu()];case 1:for(t=i.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Cl&&(o=this.getItem(ni(this.persistenceKey,r)))&&(s=ui.bl(r,o))&&(this.kl=this.kl.me(s.clientId,s));for(this.Ul(),(u=this.storage.getItem(this.ql))&&(a=this.Ql(u))&&this.Wl(a),h=0,c=this.$l;h<c.length;h++)f=c[h],this.Nl(f);return this.$l=[],this.platform.window.addEventListener("unload",(function(){return l.Iu()})),this.Uh=!0,[2]}}))}))},t.prototype.br=function(t){this.setItem(this.Ll,JSON.stringify(t))},t.prototype.jl=function(){return this.Kl(this.kl)},t.prototype.Gl=function(t){var e=!1;return this.kl.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.zl=function(t){this.Hl(t,"pending")},t.prototype.Yl=function(t,e,n){this.Hl(t,e,n),this.Jl(t)},t.prototype.Xl=function(t){var e="not-current";if(this.Gl(t)){var n=this.storage.getItem(ii(this.persistenceKey,t));if(n){var r=si.bl(t,n);r&&(e=r.state)}}return this.Zl.Sl(t),this.Ul(),e},t.prototype.td=function(t){this.Zl.Dl(t),this.Ul()},t.prototype.ed=function(t){return this.Zl.activeTargetIds.has(t)},t.prototype.sd=function(t){this.removeItem(ii(this.persistenceKey,t))},t.prototype.nd=function(t,e,n){this.rd(t,e,n)},t.prototype.Qu=function(t,e,n){var r=this;e.forEach((function(t){r.Jl(t)})),this.currentUser=t,n.forEach((function(t){r.zl(t)}))},t.prototype.hd=function(t){this.od(t)},t.prototype.Iu=function(){this.Uh&&(this.platform.window.removeEventListener("storage",this.Fl),this.removeItem(this.Ml),this.Uh=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return ge("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){ge("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){ge("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Nl=function(t){var e=this;if(t.storageArea===this.storage){if(ge("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ml)return void me("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Sr.dh((function(){return i.__awaiter(e,void 0,void 0,(function(){var e,n,r,o,s,u;return i.__generator(this,(function(i){if(this.Uh){if(null!==t.key)if(this.xl.test(t.key)){if(null==t.newValue)return e=this.ad(t.key),[2,this.ud(e,null)];if(n=this._d(t.key,t.newValue))return[2,this.ud(n.clientId,n)]}else if(this.Ol.test(t.key)){if(null!==t.newValue&&(r=this.ld(t.key,t.newValue)))return[2,this.dd(r)]}else if(this.Bl.test(t.key)){if(null!==t.newValue&&(o=this.fd(t.key,t.newValue)))return[2,this.Td(o)]}else if(t.key===this.ql){if(null!==t.newValue&&(s=this.Ql(t.newValue)))return[2,this.Wl(s)]}else t.key===this.Ll&&(u=function(t){var e=je.vr;if(null!=t)try{var n=JSON.parse(t);Ee("number"==typeof n),e=n}catch(t){me("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==je.vr&&this.gr(u)}else this.$l.push(t);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Zl",{get:function(){return this.kl.get(this.Cl)},enumerable:!0,configurable:!0}),t.prototype.Ul=function(){this.setItem(this.Ml,this.Zl.vl())},t.prototype.Hl=function(t,e,n){var r=new oi(this.currentUser,t,e,n),i=ri(this.persistenceKey,this.currentUser,t);this.setItem(i,r.vl())},t.prototype.Jl=function(t){var e=ri(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.od=function(t){var e={clientId:this.Cl,onlineState:t};this.storage.setItem(this.ql,JSON.stringify(e))},t.prototype.rd=function(t,e,n){var r=ii(this.persistenceKey,t),i=new si(t,e,n);this.setItem(r,i.vl())},t.prototype.ad=function(t){var e=this.xl.exec(t);return e?e[1]:null},t.prototype._d=function(t,e){var n=this.ad(t);return ui.bl(n,e)},t.prototype.ld=function(t,e){var n=this.Ol.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return oi.bl(new f(i),r,e)},t.prototype.fd=function(t,e){var n=this.Bl.exec(t),r=Number(n[1]);return si.bl(r,e)},t.prototype.Ql=function(t){return ai.bl(t)},t.prototype.dd=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.cl.Ed(t.batchId,t.state,t.error)]:(ge("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.Td=function(t){return this.cl.Id(t.targetId,t.state,t.error)},t.prototype.ud=function(t,e){var n=this,r=e?this.kl.me(t,e):this.kl.remove(t),i=this.Kl(this.kl),o=this.Kl(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.cl.wd(s,u).then((function(){n.kl=r}))},t.prototype.Wl=function(t){this.kl.get(t.clientId)&&this.b_(t.onlineState)},t.prototype.Kl=function(t){var e=Qt();return t.forEach((function(t,n){e=e.He(n.activeTargetIds)})),e},t}(),fi=function(){function t(){this.Rd=new hi,this.md={},this.cl=null,this.b_=null,this.gr=null}return t.prototype.zl=function(t){},t.prototype.Yl=function(t,e,n){},t.prototype.Xl=function(t){return this.Rd.Sl(t),this.md[t]||"not-current"},t.prototype.nd=function(t,e,n){this.md[t]=e},t.prototype.td=function(t){this.Rd.Dl(t)},t.prototype.ed=function(t){return this.Rd.activeTargetIds.has(t)},t.prototype.sd=function(t){delete this.md[t]},t.prototype.jl=function(){return this.Rd.activeTargetIds},t.prototype.Gl=function(t){return this.Rd.activeTargetIds.has(t)},t.prototype.start=function(){return this.Rd=new hi,Promise.resolve()},t.prototype.Qu=function(t,e,n){},t.prototype.hd=function(t){},t.prototype.Iu=function(){},t.prototype.br=function(t){},t}(),li=function(t){this.key=t},pi=function(t){this.key=t},di=function(){function t(t,e){this.query=t,this.Ad=e,this.Pd=null,this.fs=!1,this.Vd=Xt(),this.ns=Xt(),this.gd=new Jt(t.se.bind(t))}return Object.defineProperty(t.prototype,"pd",{get:function(){return this.Ad},enumerable:!0,configurable:!0}),t.prototype.yd=function(t,e){var n=this,r=e?e.bd:new Zt,i=e?e.gd:this.gd,o=e?e.ns:this.ns,s=i,u=!1,a=this.query.oe()&&i.size===this.query.limit?i.last():null,h=this.query.ae()&&i.size===this.query.limit?i.first():null;if(t.pe((function(t,e){var c=i.get(t),f=e instanceof mt?e:null;f&&(f=n.query.matches(f)?f:null);var l=!!c&&n.ns.has(c.key),p=!!f&&(f.At||n.ns.has(f.key)&&f.hasCommittedMutations),d=!1;c&&f?c.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.vd(c,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.query.se(f,a)>0||h&&n.query.se(f,h)<0)&&(u=!0)):!c&&f?(r.track({type:0,doc:f}),d=!0):c&&!f&&(r.track({type:1,doc:c}),d=!0,(a||h)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),this.query.oe()||this.query.ae())for(;s.size>this.query.limit;){var c=this.query.oe()?s.last():s.first();s=s.delete(c.key),o=o.delete(c.key),r.track({type:1,doc:c})}return{gd:s,bd:r,Sd:u,ns:o}},t.prototype.vd=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},t.prototype.Zn=function(t,e,n){var r=this,i=this.gd;this.gd=t.gd,this.ns=t.ns;var o=t.bd.es();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return be()}};return n(t)-n(e)}(t.type,e.type)||r.query.se(t.doc,e.doc)})),this.Dd(n);var s=e?this.Cd():[],u=0===this.Vd.size&&this.fs?1:0,a=u!==this.Pd;return this.Pd=u,0!==o.length||a?{snapshot:new $t(this.query,t.gd,i,o,t.ns,0===u,a,!1),Fd:s}:{Fd:s}},t.prototype.Nd=function(t){return this.fs&&"Offline"===t?(this.fs=!1,this.Zn({gd:this.gd,bd:new Zt,ns:this.ns,Sd:!1},!1)):{Fd:[]}},t.prototype.kd=function(t){return!this.Ad.has(t)&&!!this.gd.has(t)&&!this.gd.get(t).At},t.prototype.Dd=function(t){var e=this;t&&(t.Ts.forEach((function(t){return e.Ad=e.Ad.add(t)})),t.Es.forEach((function(t){})),t.Is.forEach((function(t){return e.Ad=e.Ad.delete(t)})),this.fs=t.fs)},t.prototype.Cd=function(){var t=this;if(!this.fs)return[];var e=this.Vd;this.Vd=Xt(),this.gd.forEach((function(e){t.kd(e.key)&&(t.Vd=t.Vd.add(e.key))}));var n=[];return e.forEach((function(e){t.Vd.has(e)||n.push(new pi(e))})),this.Vd.forEach((function(t){e.has(t)||n.push(new li(t))})),n},t.prototype.$d=function(t){this.Ad=t.rc,this.Vd=Xt();var e=this.yd(t.documents);return this.Zn(e,!0)},t.prototype.Md=function(){return $t.os(this.query,this.gd,this.ns,0===this.Pd)},t}(),yi=function(){function t(t,e,n,r){this.qr=t,this.Ld=e,this.updateFunction=n,this.Wr=r,this.xd=5,this.ih=new Be(this.qr,"transaction_retry")}return t.prototype.Od=function(){this.Bd()},t.prototype.Bd=function(){var t=this;this.ih.xr((function(){return i.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return i.__generator(this,(function(r){return t=this.Ld.gl(),(e=this.qd(t))&&e.then((function(e){n.qr.Hr((function(){return t.commit().then((function(){n.Wr.resolve(e)})).catch((function(t){n.Ud(t)}))}))})).catch((function(t){n.Ud(t)})),[2]}))}))}))},t.prototype.qd=function(t){try{var e=this.updateFunction(t);return!L(e)&&e.catch&&e.then?e:(this.Wr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Wr.reject(t),null}},t.prototype.Ud=function(t){var e=this;this.xd>0&&this.Qd(t)?(this.xd-=1,this.qr.Hr((function(){return e.Bd(),Promise.resolve()}))):this.Wr.reject(t)},t.prototype.Qd=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ot(e)}return!1},t}(),vi=function(t,e,n){this.query=t,this.targetId=e,this.view=n},gi=function(t){this.key=t,this.Wd=!1},mi=function(){function t(t,e,n,r,i){this.L_=t,this.Ld=e,this.jd=n,this.currentUser=r,this.Kd=i,this.Gd=null,this.zd=new ke((function(t){return t.canonicalId()})),this.Hd=new Map,this.Yd=[],this.Jd=new Ct(N.N),this.Xd=new Map,this.Zd=new Re,this.tf={},this.ef=new Map,this.sf=vn.Go(),this.onlineState="Unknown"}return Object.defineProperty(t.prototype,"if",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){this.Gd=t},t.prototype.listen=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o,s;return i.__generator(this,(function(i){switch(i.label){case 0:return this.nf("listen()"),(r=this.zd.get(t))?(e=r.targetId,this.jd.Xl(e),n=r.view.Md(),[3,4]):[3,1];case 1:return[4,this.L_.sc(t.ee())];case 2:return o=i.sent(),s=this.jd.Xl(o.targetId),e=o.targetId,[4,this.rf(t,e,"current"===s)];case 3:n=i.sent(),this.if&&this.Ld.listen(o),i.label=4;case 4:return[2,n]}}))}))},t.prototype.rf=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,o,s,u,a,h;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this.L_.nc(t,!0)];case 1:return r=i.sent(),o=new di(t,r.rc),s=o.yd(r.documents),u=ee.ds(e,n&&"Offline"!==this.onlineState),a=o.Zn(s,this.if,u),this.hf(e,a.Fd),h=new vi(t,e,o),[2,(this.zd.set(t,h),this.Hd.has(e)?this.Hd.get(e).push(t):this.Hd.set(e,[t]),a.snapshot)]}}))}))},t.prototype.al=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r=this;return i.__generator(this,(function(i){switch(i.label){case 0:return this.nf("unlisten()"),e=this.zd.get(t),(n=this.Hd.get(e.targetId)).length>1?[2,(this.Hd.set(e.targetId,n.filter((function(e){return!e.isEqual(t)}))),void this.zd.delete(t))]:this.if?(this.jd.td(e.targetId),this.jd.Gl(e.targetId)?[3,2]:[4,this.L_.ic(e.targetId,!1).then((function(){r.jd.sd(e.targetId),r.Ld.al(e.targetId),r.af(e.targetId)})).catch(or)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.af(e.targetId),[4,this.L_.ic(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},t.prototype.write=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r;return i.__generator(this,(function(i){switch(i.label){case 0:this.nf("write()"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.L_.Gu(t)];case 2:return n=i.sent(),[3,4];case 3:if("IndexedDbTransactionError"===(r=i.sent()).name)return[2,(me("SyncEngine","Dropping write that cannot be persisted: "+r),void e.reject(new p(l.UNAVAILABLE,"Failed to persist write: "+r)))];throw r;case 4:return this.jd.zl(n.batchId),this.uf(n.batchId,e),[4,this.cf(n.Wn)];case 5:return i.sent(),[4,this.Ld.nl()];case 6:return i.sent(),[2]}}))}))},t.prototype.runTransaction=function(t,e,n){new yi(t,this.Ld,e,n).Od()},t.prototype.Yu=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n=this;return i.__generator(this,(function(r){switch(r.label){case 0:this.nf("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.L_.Yu(t)];case 2:return e=r.sent(),t.as.forEach((function(t,e){var r=n.Xd.get(e);r&&(Ee(t.Ts.size+t.Es.size+t.Is.size<=1),t.Ts.size>0?r.Wd=!0:t.Es.size>0?Ee(r.Wd):t.Is.size>0&&(Ee(r.Wd),r.Wd=!1))})),[4,this.cf(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,or(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.Nd=function(t,e){this.nf("applyOnlineStateChange()");var n=[];this.zd.forEach((function(e,r){var i=r.view.Nd(t);i.snapshot&&n.push(i.snapshot)})),this.Gd._f(t),this.Gd.h_(n),this.onlineState=t},t.prototype.fl=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,s,u,a=this;return i.__generator(this,(function(i){switch(i.label){case 0:return this.nf("rejectListens()"),this.jd.nd(t,"rejected",e),n=this.Xd.get(t),(r=n&&n.key)?(this.Jd=this.Jd.remove(r),this.Xd.delete(t),this.lf(),o=(o=new Ct(N.N)).me(r,new wt(r,b.min())),s=Xt().add(r),u=new te(b.min(),new Map,new Ut(Ie),o,s),[2,this.Yu(u)]):[4,this.L_.ic(t,!1).then((function(){return a.af(t,e)})).catch(or)];case 1:return i.sent(),[2]}}))}))},t.prototype.ml=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:this.nf("applySuccessfulWrite()"),e=t.batch.batchId,this.df(e,null),this.ff(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.L_.yo(t)];case 2:return n=r.sent(),this.jd.Yl(e,"acknowledged"),[4,this.cf(n)];case 3:return r.sent(),[3,6];case 4:return[4,or(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.Vl=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(r){switch(r.label){case 0:this.nf("rejectFailedWrite()"),this.df(t,e),this.ff(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.L_.Hu(t)];case 2:return n=r.sent(),this.jd.Yl(t,"rejected",e),[4,this.cf(n)];case 3:return r.sent(),[3,6];case 4:return[4,or(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.Tf=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:return this.Ld.W_()||ge("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.L_.Lo()];case 1:return-1===(e=r.sent())?[2,void t.resolve()]:((n=this.ef.get(e)||[]).push(t),this.ef.set(e,n),[2])}}))}))},t.prototype.ff=function(t){(this.ef.get(t)||[]).forEach((function(t){t.resolve()})),this.ef.delete(t)},t.prototype.Ef=function(t){this.ef.forEach((function(e){e.forEach((function(e){e.reject(new p(l.CANCELLED,t))}))})),this.ef.clear()},t.prototype.uf=function(t,e){var n=this.tf[this.currentUser.s()];n||(n=new Ct(Ie)),n=n.me(t,e),this.tf[this.currentUser.s()]=n},t.prototype.df=function(t,e){var n=this.tf[this.currentUser.s()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.tf[this.currentUser.s()]=n}},t.prototype.af=function(t,e){var n=this;void 0===e&&(e=null),this.jd.td(t);for(var r=0,i=this.Hd.get(t);r<i.length;r++){var o=i[r];this.zd.delete(o),e&&this.Gd.If(o,e)}if(this.Hd.delete(t),this.if){var s=this.Zd.Cn(t);this.Zd.Sn(t),s.forEach((function(t){n.Zd.Fn(t)||n.wf(t)}))}},t.prototype.wf=function(t){var e=this.Jd.get(t);null!==e&&(this.Ld.al(e),this.Jd=this.Jd.remove(t),this.Xd.delete(e),this.lf())},t.prototype.hf=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof li?(this.Zd.gn(i.key,t),this.Rf(i)):i instanceof pi?(ge("SyncEngine","Document no longer in limbo: "+i.key),this.Zd.yn(i.key,t),this.Zd.Fn(i.key)||this.wf(i.key)):be()}},t.prototype.Rf=function(t){var e=t.key;this.Jd.get(e)||(ge("SyncEngine","New document in limbo: "+e),this.Yd.push(e),this.lf())},t.prototype.lf=function(){for(;this.Yd.length>0&&this.Jd.size<this.Kd;){var t=this.Yd.shift(),e=this.sf.next();this.Xd.set(e,new gi(t)),this.Jd=this.Jd.me(t,e),this.Ld.listen(new Dt(_t.Wt(t.path).ee(),e,2,je.vr))}},t.prototype.mf=function(){return this.Jd},t.prototype.Af=function(){return this.Yd},t.prototype.cf=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,s=this;return i.__generator(this,(function(i){switch(i.label){case 0:return n=[],r=[],o=[],this.zd.forEach((function(i,u){o.push(Promise.resolve().then((function(){var e=u.view.yd(t);return e.Sd?s.L_.nc(u.query,!1).then((function(t){var n=t.documents;return u.view.yd(n,e)})):e})).then((function(t){var i=e&&e.as.get(u.targetId),o=u.view.Zn(t,s.if,i);if(s.hf(u.targetId,o.Fd),o.snapshot){s.if&&s.jd.nd(u.targetId,o.snapshot.fromCache?"not-current":"current"),n.push(o.snapshot);var a=qe.Vr(u.targetId,o.snapshot);r.push(a)}})))})),[4,Promise.all(o)];case 1:return i.sent(),this.Gd.h_(n),[4,this.L_.Zu(r)];case 2:return i.sent(),[2]}}))}))},t.prototype.nf=function(t){},t.prototype.pl=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.Ef("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.L_.Qu(t)]):[3,3];case 1:return n=r.sent(),this.jd.Qu(t,n.ju,n.Ku),[4,this.cf(n.Wu)];case 2:r.sent(),r.label=3;case 3:return[4,this.Ld.pl()];case 4:return r.sent(),[2]}}))}))},t.prototype.enableNetwork=function(){return this.Ld.enableNetwork()},t.prototype.disableNetwork=function(){return this.Ld.disableNetwork()},t.prototype.ei=function(t){var e=this.Xd.get(t);if(e&&e.Wd)return Xt().add(e.key);var n=Xt(),r=this.Hd.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.zd.get(s);n=n.He(u.view.pd)}return n},t}(),wi=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,n,r,i,o)||this).L_=e,s.isPrimary=void 0,s}return i.__extends(e,t),Object.defineProperty(e.prototype,"if",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),e.prototype.enableNetwork=function(){return this.L_.ru(!0),t.prototype.enableNetwork.call(this)},e.prototype.disableNetwork=function(){return this.L_.ru(!1),t.prototype.disableNetwork.call(this)},e.prototype.Pf=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:return[4,this.L_.nc(t.query,!0)];case 1:return e=r.sent(),n=t.view.$d(e),[2,(this.isPrimary&&this.hf(t.targetId,n.Fd),n)]}}))}))},e.prototype.Nd=function(e,n){this.if&&0===n&&(t.prototype.Nd.call(this,e,n),this.jd.hd(e)),this.if||1!==n||t.prototype.Nd.call(this,e,n)},e.prototype.Ed=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r;return i.__generator(this,(function(i){switch(i.label){case 0:return this.nf("applyBatchState()"),[4,this.L_.ac(t)];case 1:return null===(r=i.sent())?[3,6]:"pending"!==e?[3,3]:[4,this.Ld.nl()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.df(t,n||null),this.L_.uc(t)):be(),i.label=4;case 4:return[4,this.cf(r)];case 5:return i.sent(),[3,7];case 6:ge("SyncEngine","Cannot apply mutation batch with id: "+t),i.label=7;case 7:return[2]}}))}))},e.prototype.yl=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o,s,u,a,h=this;return i.__generator(this,(function(i){switch(i.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Ld.yl(!0)]);case 1:return i.sent(),e=this.jd.jl(),[4,this.Vf(e.W())];case 2:for(n=i.sent(),r=0,o=n;r<o.length;r++)s=o[r],this.Ld.listen(s);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,u=[],a=Promise.resolve(),this.Hd.forEach((function(t,e){h.jd.ed(e)?u.push(e):a=a.then((function(){return h.af(e),h.L_.ic(e,!0)})),h.Ld.al(e)})),[4,a]);case 4:return i.sent(),[4,this.Vf(u)];case 5:return i.sent(),this.gf(),[4,this.Ld.yl(!1)];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))},e.prototype.gf=function(){var t=this;this.Xd.forEach((function(e,n){t.Ld.al(n)})),this.Zd.Dn(),this.Xd=new Map,this.Jd=new Ct(N.N)},e.prototype.Vf=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o,s,u,a,h,c,f,l,p,d;return i.__generator(this,(function(i){switch(i.label){case 0:e=[],n=[],r=0,o=t,i.label=1;case 1:return r<o.length?(s=o[r],u=void 0,(a=this.Hd.get(s))&&0!==a.length?[4,this.L_.ic(s,!0)]:[3,8]):[3,14];case 2:return i.sent(),[4,this.L_.sc(a[0].ee())];case 3:u=i.sent(),h=0,c=a,i.label=4;case 4:return h<c.length?(f=c[h],l=this.zd.get(f),[4,this.Pf(l)]):[3,7];case 5:(p=i.sent()).snapshot&&n.push(p.snapshot),i.label=6;case 6:return h++,[3,4];case 7:return[3,12];case 8:return[4,this.L_.cc(s)];case 9:return d=i.sent(),[4,this.L_.sc(d)];case 10:return u=i.sent(),[4,this.rf(this.pf(d),s,!1)];case 11:i.sent(),i.label=12;case 12:e.push(u),i.label=13;case 13:return r++,[3,1];case 14:return[2,(this.Gd.h_(n),e)]}}))}))},e.prototype.pf=function(t){return new _t(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},e.prototype.Pu=function(){return this.L_.Pu()},e.prototype.Id=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,o;return i.__generator(this,(function(i){switch(i.label){case 0:return this.isPrimary?(ge("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.Hd.has(t))return[3,8];switch(e){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.L_.Va()];case 3:return r=i.sent(),o=te.ls(t,"current"===e),[4,this.cf(r,o)];case 4:return i.sent(),[3,8];case 5:return[4,this.L_.ic(t,!0)];case 6:return i.sent(),this.af(t,n),[3,8];case 7:be(),i.label=8;case 8:return[2]}}))}))},e.prototype.wd=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,s,u,a,h,c,f,l,p=this;return i.__generator(this,(function(d){switch(d.label){case 0:if(!this.isPrimary)return[3,10];n=0,r=t,d.label=1;case 1:return n<r.length?(o=r[n],this.Hd.has(o)?(ge("SyncEngine","Adding an already active target "+o),[3,5]):[4,this.L_.cc(o)]):[3,6];case 2:return s=d.sent(),[4,this.L_.sc(s)];case 3:return u=d.sent(),[4,this.rf(this.pf(s),u.targetId,!1)];case 4:d.sent(),this.Ld.listen(u),d.label=5;case 5:return n++,[3,1];case 6:a=function(t){return i.__generator(this,(function(e){switch(e.label){case 0:return h.Hd.has(t)?[4,h.L_.ic(t,!1).then((function(){p.Ld.al(t),p.af(t)})).catch(or)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=this,c=0,f=e,d.label=7;case 7:return c<f.length?(l=f[c],[5,a(l)]):[3,10];case 8:d.sent(),d.label=9;case 9:return c++,[3,7];case 10:return[2]}}))}))},e}(mi),bi=function(){this.yf=void 0,this.bf=[]},Ei=function(){function t(t){this.cl=t,this.vf=new ke((function(t){return t.canonicalId()})),this.onlineState="Unknown",this.Sf=new Set,this.cl.subscribe(this)}return t.prototype.listen=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o,s,u;return i.__generator(this,(function(i){switch(i.label){case 0:if(e=t.query,n=!1,(r=this.vf.get(e))||(n=!0,r=new bi),!n)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),o=r,[4,this.cl.listen(e)];case 2:return o.yf=i.sent(),[3,4];case 3:if(s=i.sent(),me("EventManager",u="Initialization of query '"+e+"' failed: "+s),"IndexedDbTransactionError"!==s.name)throw s;return[2,void t.onError(new p(l.UNAVAILABLE,u))];case 4:return this.vf.set(e,r),r.bf.push(t),t.Nd(this.onlineState),r.yf&&t.Df(r.yf)&&this.Cf(),[2]}}))}))},t.prototype.al=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o;return i.__generator(this,(function(i){return e=t.query,n=!1,(r=this.vf.get(e))&&(o=r.bf.indexOf(t))>=0&&(r.bf.splice(o,1),n=0===r.bf.length),n?[2,(this.vf.delete(e),this.cl.al(e))]:[2]}))}))},t.prototype.h_=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.vf.get(o);if(s){for(var u=0,a=s.bf;u<a.length;u++)a[u].Df(i)&&(e=!0);s.yf=i}}e&&this.Cf()},t.prototype.If=function(t,e){var n=this.vf.get(t);if(n)for(var r=0,i=n.bf;r<i.length;r++)i[r].onError(e);this.vf.delete(t)},t.prototype._f=function(t){this.onlineState=t;var e=!1;this.vf.forEach((function(n,r){for(var i=0,o=r.bf;i<o.length;i++)o[i].Nd(t)&&(e=!0)})),e&&this.Cf()},t.prototype.Ff=function(t){this.Sf.add(t),t.next()},t.prototype.Nf=function(t){this.Sf.delete(t)},t.prototype.Cf=function(){this.Sf.forEach((function(t){t.next()}))},t}(),_i=function(){function t(t,e,n){this.query=t,this.kf=e,this.$f=!1,this.Mf=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Df=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new $t(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.$f?this.Lf(t)&&(this.kf.next(t),o=!0):this.xf(t,this.onlineState)&&(this.Of(t),o=!0),this.Mf=t,o},t.prototype.onError=function(t){this.kf.error(t)},t.prototype.Nd=function(t){this.onlineState=t;var e=!1;return this.Mf&&!this.$f&&this.xf(this.Mf,t)&&(this.Of(this.Mf),e=!0),e},t.prototype.xf=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Bf&&n||t.docs.B()&&"Offline"!==e)},t.prototype.Lf=function(t){if(t.docChanges.length>0)return!0;var e=this.Mf&&this.Mf.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Of=function(t){t=$t.os(t.query,t.docs,t.ns,t.fromCache),this.$f=!0,this.kf.next(t)},t}(),Ti=function(){function t(){}return t.prototype.Uu=function(t){this.qf=t},t.prototype.dr=function(t,e,n,r){var i=this;return e.te()||n.isEqual(b.min())?this.Uf(t,e):this.qf.cr(t,r).next((function(o){var u=i.Qf(e,o);return(e.oe()||e.ae())&&i.Sd(e.Bt,u,r,n)?i.Uf(t,e):(ye()<=s.LogLevel.DEBUG&&ge("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),e.toString()),i.qf.dr(t,e,n).next((function(t){return u.forEach((function(e){t=t.me(e.key,e)})),t})))}))},t.prototype.Qf=function(t,e){var n=new Ut((function(e,n){return t.se(e,n)}));return e.forEach((function(e,r){r instanceof mt&&t.matches(r)&&(n=n.add(r))})),n},t.prototype.Sd=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.S(r)>0)},t.prototype.Uf=function(t,e){return ye()<=s.LogLevel.DEBUG&&ge("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.qf.dr(t,e,b.min())},t}(),Ii=function(){function t(t,e){this.rr=t,this.Ao=e,this.nr=[],this.Wf=1,this.lastStreamToken=k.ht,this.jf=new Ut(Oe.An)}return t.prototype.po=function(t){return Pe.resolve(0===this.nr.length)},t.prototype.yo=function(t,e,n){var r=e.batchId,i=this.Kf(r,"acknowledged");return Ee(0===i),this.nr[i],this.lastStreamToken=n,Pe.resolve()},t.prototype.vo=function(t){return Pe.resolve(this.lastStreamToken)},t.prototype.So=function(t,e){return this.lastStreamToken=e,Pe.resolve()},t.prototype.Do=function(t,e,n,r){var i=this.Wf;this.Wf++,this.nr.length>0&&this.nr[this.nr.length-1];var o=new Le(i,e,n,r);this.nr.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.jf=this.jf.add(new Oe(a.key,i)),this.rr.Fo(t,a.key.path.M())}return Pe.resolve(o)},t.prototype.No=function(t,e){return Pe.resolve(this.Gf(e))},t.prototype.Mo=function(t,e){var n=e+1,r=this.zf(n),i=r<0?0:r;return Pe.resolve(this.nr.length>i?this.nr[i]:null)},t.prototype.Lo=function(){return Pe.resolve(0===this.nr.length?-1:this.Wf-1)},t.prototype.xo=function(t){return Pe.resolve(this.nr.slice())},t.prototype.or=function(t,e){var n=this,r=new Oe(e,0),i=new Oe(e,Number.POSITIVE_INFINITY),o=[];return this.jf.Ke([r,i],(function(t){var e=n.Gf(t.Nn);o.push(e)})),Pe.resolve(o)},t.prototype.lr=function(t,e){var n=this,r=new Ut(Ie);return e.forEach((function(t){var e=new Oe(t,0),i=new Oe(t,Number.POSITIVE_INFINITY);n.jf.Ke([e,i],(function(t){r=r.add(t.Nn)}))})),Pe.resolve(this.Hf(r))},t.prototype.Rr=function(t,e){var n=e.path,r=n.length+1,i=n;N.et(i)||(i=i.child(""));var o=new Oe(new N(i),0),s=new Ut(Ie);return this.jf.Ge((function(t){var e=t.key.path;return!!n.q(e)&&(e.length===r&&(s=s.add(t.Nn)),!0)}),o),Pe.resolve(this.Hf(s))},t.prototype.Hf=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Gf(t);null!==r&&n.push(r)})),n},t.prototype.Bo=function(t,e){var n=this;Ee(0===this.Kf(e.batchId,"removed")),this.nr.shift();var r=this.jf;return Pe.forEach(e.mutations,(function(i){var o=new Oe(i.key,e.batchId);return r=r.delete(o),n.Ao.Qo(t,i.key)})).next((function(){n.jf=r}))},t.prototype.Uo=function(t){},t.prototype.Fn=function(t,e){var n=new Oe(e,0),r=this.jf.ze(n);return Pe.resolve(e.isEqual(r&&r.key))},t.prototype.Wo=function(t){return this.nr.length,Pe.resolve()},t.prototype.Kf=function(t,e){return this.zf(t)},t.prototype.zf=function(t){return 0===this.nr.length?0:t-this.nr[0].batchId},t.prototype.Gf=function(t){var e=this.zf(t);return e<0||e>=this.nr.length?null:this.nr[e]},t}(),Ni=function(){function t(t,e){this.rr=t,this.Yf=e,this.docs=new Ct(N.N),this.size=0}return t.prototype.Gn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Yf(e);return this.docs=this.docs.me(r,{Ea:e,size:s,readTime:n}),this.size+=s-o,this.rr.Fo(t,r.path.M())},t.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Yn=function(t,e){var n=this.docs.get(e);return Pe.resolve(n?n.Ea:null)},t.prototype.getEntries=function(t,e){var n=this,r=Bt();return e.forEach((function(t){var e=n.docs.get(t);r=r.me(t,e?e.Ea:null)})),Pe.resolve(r)},t.prototype.dr=function(t,e,n){for(var r=zt(),i=new N(e.path.child("")),o=this.docs.ve(i);o.ke();){var s=o.Ne(),u=s.key,a=s.value,h=a.Ea,c=a.readTime;if(!e.path.q(u.path))break;c.S(n)<=0||h instanceof mt&&e.matches(h)&&(r=r.me(h.key,h))}return Pe.resolve(r)},t.prototype.Jf=function(t,e){return Pe.forEach(this.docs,(function(t){return e(t)}))},t.prototype.ba=function(e){return new t.va(this)},t.prototype.Da=function(t){return Pe.resolve(this.size)},t}();Ni.va=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ca=e,n}return i.__extends(e,t),e.prototype.Zn=function(t){var e=this,n=[];return this.Wn.forEach((function(r,i){i?n.push(e.Ca.Gn(t,i,e.readTime)):e.Ca.Hn(r)})),Pe.Un(n)},e.prototype.Jn=function(t,e){return this.Ca.Yn(t,e)},e.prototype.Xn=function(t,e){return this.Ca.getEntries(t,e)},e}(Ce);var Ai=function(){function t(t){this.persistence=t,this.Xf=new ke((function(t){return t.canonicalId()})),this.lastRemoteSnapshotVersion=b.min(),this.highestTargetId=0,this.Zf=0,this.tT=new Re,this.targetCount=0,this.eT=vn.Ko()}return t.prototype.js=function(t,e){return this.Xf.forEach((function(t,n){return e(n)})),Pe.resolve()},t.prototype.Jo=function(t){return Pe.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Xo=function(t){return Pe.resolve(this.Zf)},t.prototype.zo=function(t){return this.highestTargetId=this.eT.next(),Pe.resolve(this.highestTargetId)},t.prototype.Zo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Zf&&(this.Zf=e),Pe.resolve()},t.prototype.ea=function(t){this.Xf.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.eT=new vn(e),this.highestTargetId=e),t.sequenceNumber>this.Zf&&(this.Zf=t.sequenceNumber)},t.prototype.ta=function(t,e){return this.ea(e),this.targetCount+=1,Pe.resolve()},t.prototype.ia=function(t,e){return this.ea(e),Pe.resolve()},t.prototype.na=function(t,e){return this.Xf.delete(e.target),this.tT.Sn(e.targetId),this.targetCount-=1,Pe.resolve()},t.prototype.Hh=function(t,e,n){var r=this,i=0,o=[];return this.Xf.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.Xf.delete(s),o.push(r.ra(t,u.targetId)),i++)})),Pe.Un(o).next((function(){return i}))},t.prototype.aa=function(t){return Pe.resolve(this.targetCount)},t.prototype.ua=function(t,e){var n=this.Xf.get(e)||null;return Pe.resolve(n)},t.prototype.ca=function(t,e,n){this.tT.pn(e,n);var r=this.persistence.Ao,i=[];return r&&e.forEach((function(e){i.push(r.gn(t,e))})),Pe.Un(i)},t.prototype._a=function(t,e,n){this.tT.vn(e,n);var r=this.persistence.Ao,i=[];return r&&e.forEach((function(e){i.push(r.yn(t,e))})),Pe.Un(i)},t.prototype.ra=function(t,e){return this.tT.Sn(e),Pe.resolve()},t.prototype.la=function(t,e){var n=this.tT.Cn(e);return Pe.resolve(n)},t.prototype.Fn=function(t,e){return Pe.resolve(this.tT.Fn(e))},t}(),xi=function(){function t(t){var e=this;this.sT={},this.su=new je(0),this.qa=!1,this.qa=!0,this.Ao=t(this),this.Ha=new Ai(this),this.rr=new xn,this.ir=new Ni(this.rr,(function(t){return e.Ao.iT(t)}))}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Iu=function(){return this.qa=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Uh",{get:function(){return this.qa},enumerable:!0,configurable:!0}),t.prototype.nu=function(){},t.prototype.yu=function(){return this.rr},t.prototype.Vu=function(t){var e=this.sT[t.s()];return e||(e=new Ii(this.rr,this.Ao),this.sT[t.s()]=e),e},t.prototype.gu=function(){return this.Ha},t.prototype.pu=function(){return this.ir},t.prototype.runTransaction=function(t,e,n){var r=this;ge("MemoryPersistence","Starting transaction:",t);var i=new Si(this.su.next());return this.Ao.nT(),n(i).next((function(t){return r.Ao.rT(i).next((function(){return t}))})).Bn().then((function(t){return i.sr(),t}))},t.prototype.hT=function(t,e){return Pe.Qn(Object.values(this.sT).map((function(n){return function(){return n.Fn(t,e)}})))},t}(),Si=function(t){function e(e){var n=this;return(n=t.call(this)||this).Oa=e,n}return i.__extends(e,t),e}(Me),ki=function(){function t(t){this.persistence=t,this.Su=null,this.oT=null}return t.aT=function(e){return new t(e)},Object.defineProperty(t.prototype,"uT",{get:function(){if(this.oT)return this.oT;throw be()},enumerable:!0,configurable:!0}),t.prototype.Fu=function(t){this.Su=t},t.prototype.gn=function(t,e){return this.uT.delete(e),Pe.resolve()},t.prototype.yn=function(t,e){return this.uT.add(e),Pe.resolve()},t.prototype.Qo=function(t,e){return this.uT.add(e),Pe.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.gu();return r.la(t,e.targetId).next((function(t){t.forEach((function(t){return n.uT.add(t)}))})).next((function(){return r.na(t,e)}))},t.prototype.nT=function(){this.oT=new Set},t.prototype.rT=function(t){var e=this,n=this.persistence.pu().ba();return Pe.forEach(this.uT,(function(r){return e.cT(t,r).next((function(t){t||n.Hn(r)}))})).next((function(){return e.oT=null,n.apply(t)}))},t.prototype.ku=function(t,e){var n=this;return this.cT(t,e).next((function(t){t?n.uT.delete(e):n.uT.add(e)}))},t.prototype.iT=function(t){return 0},t.prototype.cT=function(t,e){var n=this;return Pe.Qn([function(){return n.persistence.gu().Fn(t,e)},function(){return n.persistence.hT(t,e)},function(){return Pe.resolve(n.Su.Fn(e))}])},t}(),Li=function(){function t(){}return t.prototype.initialize=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e=this;return i.__generator(this,(function(n){switch(n.label){case 0:return this.jd=this._T(t),this.persistence=this.lT(t),[4,this.persistence.start()];case 1:return n.sent(),this.dT=this.fT(t),this.L_=this.TT(t),this.Ld=this.ET(t),this.cl=this.IT(t),this.wT=this.RT(t),this.jd.b_=function(t){return e.cl.Nd(t,1)},this.Ld.cl=this.cl,[4,this.L_.start()];case 2:return n.sent(),[4,this.jd.start()];case 3:return n.sent(),[4,this.Ld.start()];case 4:return n.sent(),[4,this.Ld.yl(this.cl.if)];case 5:return n.sent(),[2]}}))}))},t.prototype.RT=function(t){return new Ei(this.cl)},t.prototype.fT=function(t){return null},t.prototype.TT=function(t){return new rr(this.persistence,new Ti,t.mT)},t.prototype.lT=function(t){return new xi(ki.aT)},t.prototype.ET=function(t){var e=this;return new ei(this.L_,t.w_,t.qr,(function(t){return e.cl.Nd(t,0)}),t.platform.AT())},t.prototype._T=function(t){return new fi},t.prototype.IT=function(t){return new mi(this.L_,this.Ld,this.jd,t.mT,t.Kd)},t.prototype.clearPersistence=function(t){throw new p(l.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},t}(),Di=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.initialize=function(e){return i.__awaiter(this,void 0,void 0,(function(){var n=this;return i.__generator(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,this.persistence.iu((function(t){return i.__awaiter(n,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return[4,this.cl.yl(t)];case 1:return e.sent(),this.dT&&(t&&!this.dT.Uh?this.dT.start(this.L_):t||this.dT.stop()),[2]}}))}))}))];case 2:return r.sent(),[2]}}))}))},e.prototype.TT=function(t){return new ir(this.persistence,new Ti,t.mT)},e.prototype.IT=function(t){var e=new wi(this.L_,this.Ld,this.jd,t.mT,t.Kd);return this.jd instanceof ci&&(this.jd.cl=e),e},e.prototype.fT=function(t){var e=this.persistence.Ao.Lh;return new Ye(e,t.qr)},e.prototype.lT=function(t){var e=Zn.vu(t.PT),n=t.platform.Dc(t.PT.ii);return new Zn(t.VT.synchronizeTabs,e,t.clientId,t.platform,Xe.Dh(t.VT.cacheSizeBytes),t.qr,n,this.jd)},e.prototype._T=function(t){if(t.VT.gT&&t.VT.synchronizeTabs){if(!ci.so(t.platform))throw new p(l.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var e=Zn.vu(t.PT);return new ci(t.qr,t.platform,e,t.clientId,t.mT)}return new fi},e.prototype.clearPersistence=function(t){var e=Zn.vu(t);return Zn.clearPersistence(e)},e}(Li),Ri=function(){function t(t,e,n,r){this.platform=t,this.PT=e,this.credentials=n,this.qr=r,this.clientId=Te.cn()}return t.prototype.start=function(t,e){var n=this;this.pT();var r=new Fe,i=new Fe,o=!1;return this.credentials.l((function(s){if(!o)return o=!0,ge("FirestoreClient","Initializing. user=",s.uid),n.yT(t,e,s,i).then(r.resolve,r.reject);n.qr.Hr((function(){return n.pl(s)}))})),this.qr.Hr((function(){return r.promise})),i.promise},t.prototype.enableNetwork=function(){var t=this;return this.pT(),this.qr.enqueue((function(){return t.cl.enableNetwork()}))},t.prototype.yT=function(t,e,n,r){return i.__awaiter(this,void 0,void 0,(function(){var o,s,u,a,h=this;return i.__generator(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),[4,this.platform.bT(this.PT)];case 1:return o=c.sent(),s=this.platform.Dc(this.PT.ii),u=function(t,e,n){return new Zr(t,e,n)}(o,this.credentials,s),[4,t.initialize({qr:this.qr,PT:this.PT,platform:this.platform,w_:u,clientId:this.clientId,mT:n,Kd:100,VT:e})];case 2:return c.sent(),this.persistence=t.persistence,this.jd=t.jd,this.L_=t.L_,this.Ld=t.Ld,this.cl=t.cl,this.dT=t.dT,this.vT=t.wT,this.persistence.nu((function(){return i.__awaiter(h,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),r.resolve(),[3,4];case 3:if(a=c.sent(),r.reject(a),!this.ST(a))throw a;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+a),this.yT(new Li,{gT:!1},n,r))];case 4:return[2]}}))}))},t.prototype.ST=function(t){return"FirebaseError"===t.name?t.code===l.FAILED_PRECONDITION||t.code===l.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.pT=function(){if(this.qr.hh)throw new p(l.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.pl=function(t){return this.qr.Th(),ge("FirestoreClient","Credential Changed. Current user: "+t.uid),this.cl.pl(t)},t.prototype.disableNetwork=function(){var t=this;return this.pT(),this.qr.enqueue((function(){return t.cl.disableNetwork()}))},t.prototype.terminate=function(){var t=this;return this.qr.lh((function(){return i.__awaiter(t,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.dT&&this.dT.stop(),[4,this.Ld.Iu()];case 1:return t.sent(),[4,this.jd.Iu()];case 2:return t.sent(),[4,this.persistence.Iu()];case 3:return t.sent(),this.credentials.T(),[2]}}))}))}))},t.prototype.waitForPendingWrites=function(){var t=this;this.pT();var e=new Fe;return this.qr.Hr((function(){return t.cl.Tf(e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.pT();var i=new _i(t,e,n);return this.qr.Hr((function(){return r.vT.listen(i)})),i},t.prototype.al=function(t){var e=this;this.DT||this.qr.Hr((function(){return e.vT.al(t)}))},t.prototype.CT=function(t){var e=this;return this.pT(),this.qr.enqueue((function(){return e.L_.ec(t)})).then((function(t){if(t instanceof mt)return t;if(t instanceof wt)return null;throw new p(l.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},t.prototype.FT=function(t){var e=this;return this.pT(),this.qr.enqueue((function(){return i.__awaiter(e,void 0,void 0,(function(){var e,n,r;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this.L_.nc(t,!0)];case 1:return e=i.sent(),n=new di(t,e.rc),r=n.yd(e.documents),[2,n.Zn(r,!1).snapshot]}}))}))}))},t.prototype.write=function(t){var e=this;this.pT();var n=new Fe;return this.qr.Hr((function(){return e.cl.write(t,n)})),n.promise},t.prototype.ii=function(){return this.PT.ii},t.prototype.Ff=function(t){var e=this;this.pT(),this.qr.Hr((function(){return e.vT.Ff(t),Promise.resolve()}))},t.prototype.Nf=function(t){this.DT||this.vT.Nf(t)},Object.defineProperty(t.prototype,"DT",{get:function(){return this.qr.hh},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.pT();var n=new Fe;return this.qr.Hr((function(){return e.cl.runTransaction(e.qr,t,n),Promise.resolve()})),n.promise},t}(),Oi=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.NT(this.observer.next,t)},t.prototype.error=function(t){this.NT(this.observer.error,t)},t.prototype.kT=function(){this.muted=!0},t.prototype.NT=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();function Pi(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Ci=function(){function t(t,e,n,r){this.firestore=t,this.timestampsInSnapshots=e,this.$T=n,this.converter=r}return t.prototype.MT=function(t){switch(V(t)){case 0:return null;case 1:return t.booleanValue;case 2:return G(t.integerValue||t.doubleValue);case 3:return this.LT(t.timestampValue);case 4:return this.xT(t);case 5:return t.stringValue;case 6:return new Ar(z(t.bytesValue));case 7:return this.OT(t.referenceValue);case 8:return this.BT(t.geoPointValue);case 9:return this.qT(t.arrayValue);case 10:return this.UT(t.mapValue);default:throw be()}},t.prototype.UT=function(t){var e=this,n={};return x(t.fields||{},(function(t,r){n[t]=e.MT(r)})),n},t.prototype.BT=function(t){return new Cr(G(t.latitude),G(t.longitude))},t.prototype.qT=function(t){var e=this;return(t.values||[]).map((function(t){return e.MT(t)}))},t.prototype.xT=function(t){switch(this.$T){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return O(n)?t(n):n}(t);return null==e?null:this.MT(e);case"estimate":return this.LT(P(t));default:return null}},t.prototype.LT=function(t){var e=B(t),n=new w(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.OT=function(t){var e=_.K(t);Ee(le(e));var n=new Se(e.get(1),e.get(3)),r=new N(e.$(5));return n.isEqual(this.firestore.Lc)||me("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.Lc.projectId+"/"+this.firestore.Lc.database+") instead."),new Fi(r,this.firestore,this.converter)},t}(),Vi=Xe.Nh,Mi=function(){function t(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new p(l.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else lr("settings","non-empty string","host",t.host),this.host=t.host,pr("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(wr("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),pr("settings","object","credentials",t.credentials),this.credentials=t.credentials,pr("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?me("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&me("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,pr("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Xe.$h;else{if(t.cacheSizeBytes!==Vi&&t.cacheSizeBytes<Xe.kh)throw new p(l.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Xe.kh);this.cacheSizeBytes=t.cacheSizeBytes}pr("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Ui=function(){function t(e,n,r){var o=this;if(void 0===r&&(r=new Li),this.QT=null,this.WT=new ze,this.INTERNAL={delete:function(){return i.__awaiter(o,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.jT(),[4,this.KT.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var s=e;this.QT=s,this.Lc=t.GT(s),this.zT=s.name,this.HT=new v(n)}else{var u=e;if(!u.projectId)throw new p(l.INVALID_ARGUMENT,"Must provide projectId");this.Lc=new Se(u.projectId,u.database),this.zT="[DEFAULT]",this.HT=new y}this.YT=r,this.JT=new Mi({}),this.XT=new Fr(this.Lc)}return t.prototype.settings=function(t){ur("Firestore.settings",arguments,1),cr("Firestore.settings","object",1,t);var e=new Mi(t);if(this.KT&&!this.JT.isEqual(e))throw new p(l.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.JT=e,void 0!==e.credentials&&(this.HT=function(t){if(!t)return new y;switch(t.type){case"gapi":var e=t.ZT;return Ee(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new m(e,t.V||"0");case"provider":return t.ZT;default:throw new p(l.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.jT(),this.KT.enableNetwork()},t.prototype.disableNetwork=function(){return this.jT(),this.KT.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.KT)throw new p(l.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1;return t&&(void 0!==t.experimentalTabSynchronization&&me("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.tE(this.YT,{gT:!0,cacheSizeBytes:this.JT.cacheSizeBytes,synchronizeTabs:r})},t.prototype.clearPersistence=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e=this;return i.__generator(this,(function(n){if(void 0!==this.KT&&!this.KT.DT)throw new p(l.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return t=new Fe,[2,(this.WT.oh((function(){return i.__awaiter(e,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=this.eE(),[4,this.YT.clearPersistence(e)];case 1:return r.sent(),t.resolve(),[3,3];case 2:return n=r.sent(),t.reject(n),[3,3];case 3:return[2]}}))}))})),t.promise)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"sE",{get:function(){return this.jT(),this.KT.DT},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.jT(),this.KT.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.jT(),Pi(t))return this.iE(t);cr("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.iE(e)},t.prototype.iE=function(t){var e=this,n=new Oi({next:function(){t.next&&t.next()},error:function(t){throw be()}});return this.KT.Ff(n),function(){n.kT(),e.KT.Nf(n)}},t.prototype.jT=function(){return this.KT||this.tE(new Li,{gT:!1}),this.KT},t.prototype.eE=function(){return new xe(this.Lc,this.zT,this.JT.host,this.JT.ssl,this.JT.forceLongPolling)},t.prototype.tE=function(t,e){var n=this.eE();return this.KT=new Ri(pe.nt(),n,this.HT,this.WT),this.KT.start(t,e)},t.GT=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new p(l.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new p(l.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Se(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.QT)throw new p(l.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.QT},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return ur("Firestore.collection",arguments,1),cr("Firestore.collection","non-empty string",1,t),this.jT(),new Hi(_.K(t),this)},t.prototype.doc=function(t){return ur("Firestore.doc",arguments,1),cr("Firestore.doc","non-empty string",1,t),this.jT(),Fi.nE(_.K(t),this)},t.prototype.collectionGroup=function(t){if(ur("Firestore.collectionGroup",arguments,1),cr("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new p(l.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.jT(),new Wi(new _t(_.G,t),this)},t.prototype.runTransaction=function(t){var e=this;return ur("Firestore.runTransaction",arguments,1),cr("Firestore.runTransaction","function",1,t),this.jT().transaction((function(n){return t(new qi(e,n))}))},t.prototype.batch=function(){return this.jT(),new ji(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(ye()){case s.LogLevel.DEBUG:return"debug";case s.LogLevel.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(ur("Firestore.setLogLevel",arguments,1),cr("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":ve(s.LogLevel.DEBUG);break;case"error":ve(s.LogLevel.ERROR);break;case"silent":ve(s.LogLevel.SILENT);break;default:throw new p(l.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype.rE=function(){return this.JT.timestampsInSnapshots},t}(),qi=function(){function t(t,e){this.hE=t,this.oE=e}return t.prototype.get=function(t){var e=this;ur("Transaction.get",arguments,1);var n=Ji("Transaction.get",t,this.hE);return this.oE.V_([n.xc]).then((function(t){if(!t||1!==t.length)return be();var r=t[0];if(r instanceof wt)return new Gi(e.hE,n.xc,null,!1,!1,n.aE);if(r instanceof mt)return new Gi(e.hE,n.xc,r,!1,!1,n.aE);throw be()}))},t.prototype.set=function(t,e,n){hr("Transaction.set",arguments,2,3);var r=Ji("Transaction.set",t,this.hE);n=Xi("Transaction.set",n);var i=$i(r.aE,e,"Transaction.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.hE.XT.Nc(s,o,n.mergeFields):this.hE.XT.Cc(s,o);return this.oE.set(r.xc,u),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof xr?(ar("Transaction.update",arguments,3),r=Ji("Transaction.update",t,this.hE),i=this.hE.XT.$c("Transaction.update",e,n,o)):(ur("Transaction.update",arguments,2),r=Ji("Transaction.update",t,this.hE),i=this.hE.XT.kc("Transaction.update",e)),this.oE.update(r.xc,i),this},t.prototype.delete=function(t){ur("Transaction.delete",arguments,1);var e=Ji("Transaction.delete",t,this.hE);return this.oE.delete(e.xc),this},t}(),ji=function(){function t(t){this.hE=t,this.uE=[],this.cE=!1}return t.prototype.set=function(t,e,n){hr("WriteBatch.set",arguments,2,3),this._E();var r=Ji("WriteBatch.set",t,this.hE);n=Xi("WriteBatch.set",n);var i=$i(r.aE,e,"WriteBatch.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.hE.XT.Nc(s,o,n.mergeFields):this.hE.XT.Cc(s,o);return this.uE=this.uE.concat(u.gc(r.xc,ot.ft())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this._E(),"string"==typeof e||e instanceof xr?(ar("WriteBatch.update",arguments,3),r=Ji("WriteBatch.update",t,this.hE),i=this.hE.XT.$c("WriteBatch.update",e,n,o)):(ur("WriteBatch.update",arguments,2),r=Ji("WriteBatch.update",t,this.hE),i=this.hE.XT.kc("WriteBatch.update",e)),this.uE=this.uE.concat(i.gc(r.xc,ot.exists(!0))),this},t.prototype.delete=function(t){ur("WriteBatch.delete",arguments,1),this._E();var e=Ji("WriteBatch.delete",t,this.hE);return this.uE=this.uE.concat(new ct(e.xc,ot.ft())),this},t.prototype.commit=function(){return this._E(),this.cE=!0,this.uE.length>0?this.hE.jT().write(this.uE):Promise.resolve()},t.prototype._E=function(){if(this.cE)throw new p(l.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Fi=function(){function t(t,e,n){this.xc=t,this.firestore=e,this.aE=n,this.KT=this.firestore.jT()}return t.nE=function(e,n,r){if(e.length%2!=0)throw new p(l.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.j()+" has "+e.length);return new t(new N(e),n,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this.xc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Hi(this.xc.path.M(),this.firestore,this.aE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.xc.path.j()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(ur("DocumentReference.collection",arguments,1),cr("DocumentReference.collection","non-empty string",1,t),!t)throw new p(l.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=_.K(t);return new Hi(this.xc.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw br("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this.xc.isEqual(e.xc)&&this.aE===e.aE},t.prototype.set=function(t,e){hr("DocumentReference.set",arguments,1,2),e=Xi("DocumentReference.set",e);var n=$i(this.aE,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.XT.Nc(i,r,e.mergeFields):this.firestore.XT.Cc(i,r);return this.KT.write(o.gc(this.xc,ot.ft()))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof xr?(ar("DocumentReference.update",arguments,2),n=this.firestore.XT.$c("DocumentReference.update",t,e,r)):(ur("DocumentReference.update",arguments,1),n=this.firestore.XT.kc("DocumentReference.update",t)),this.KT.write(n.gc(this.xc,ot.exists(!0)))},t.prototype.delete=function(){return ur("DocumentReference.delete",arguments,0),this.KT.write([new ct(this.xc,ot.ft())])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];hr("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||Pi(t[i])||(wr("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),pr("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return Pi(t[i])?n=t[i]:(cr("DocumentReference.onSnapshot","function",i,t[i]),fr("DocumentReference.onSnapshot","function",i+1,t[i+1]),fr("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.lE(o,n)},t.prototype.lE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Oi({next:function(t){if(e.next){var r=t.docs.get(n.xc);e.next(new Gi(n.firestore,n.xc,r,t.fromCache,t.hasPendingWrites,n.aE))}},error:r}),o=this.KT.listen(_t.Wt(this.xc.path),i,t);return function(){i.kT(),n.KT.al(o)}},t.prototype.get=function(t){var e=this;return hr("DocumentReference.get",arguments,0,1),Qi("DocumentReference.get",t),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.jT().CT(e.xc).then((function(t){n(new Gi(e.firestore,e.xc,t,!0,t instanceof mt&&t.At,e.aE))}),r):e.dE(n,r,t)}))},t.prototype.dE=function(t,e,n){var r=this.lE({includeMetadataChanges:!0,Bf:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new p(l.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new p(l.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t.prototype.withConverter=function(e){return new t(this.xc,this.firestore,e)},t}(),Bi=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Gi=function(){function t(t,e,n,r,i,o){this.hE=t,this.xc=e,this.fE=n,this.TE=r,this.EE=i,this.aE=o}return t.prototype.data=function(t){if(hr("DocumentSnapshot.data",arguments,0,1),t=Yi("DocumentSnapshot.data",t),this.fE){if(this.aE){var e=new zi(this.hE,this.xc,this.fE,this.TE,this.EE);return this.aE.fromFirestore(e,t)}return new Ci(this.hE,this.hE.rE(),t.serverTimestamps,void 0).MT(this.fE.Mt())}},t.prototype.get=function(t,e){if(hr("DocumentSnapshot.get",arguments,1,2),e=Yi("DocumentSnapshot.get",e),this.fE){var n=this.fE.data().field(Kr("DocumentSnapshot.get",t));if(null!==n)return new Ci(this.hE,this.hE.rE(),e.serverTimestamps,this.aE).MT(n)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.xc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Fi(this.xc,this.hE,this.aE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.fE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Bi(this.EE,this.TE)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw br("isEqual","DocumentSnapshot",1,e);return this.hE===e.hE&&this.TE===e.TE&&this.xc.isEqual(e.xc)&&(null===this.fE?null===e.fE:this.fE.isEqual(e.fE))&&this.aE===e.aE},t}(),zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(Gi),Wi=function(){function t(t,e,n){this.IE=t,this.firestore=e,this.aE=n}return t.prototype.where=function(e,n,r){ur("Query.where",arguments,3),mr("Query.where",3,r);var i,o=function(t,e,n,r){if(!e.some((function(t){return t===r})))throw new p(l.INVALID_ARGUMENT,"Invalid value "+gr(r)+" provided to function Query.where() for its "+_r(2)+" argument. Acceptable values: "+e.join(", "));return r}(0,["<","<=","==",">=",">","array-contains","in","array-contains-any"],0,n),s=Kr("Query.where",e);if(s.Y()){if("array-contains"===o||"array-contains-any"===o)throw new p(l.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o){this.wE(r,o);for(var u=[],a=0,h=r;a<h.length;a++){var c=h[a];u.push(this.RE(c))}i={arrayValue:{values:u}}}else i=this.RE(r)}else"in"!==o&&"array-contains-any"!==o||this.wE(r,o),i=this.firestore.XT.Mc("Query.where",r,"in"===o);var f=Tt.create(s,o,i);return this.mE(f),new t(this.IE.Gt(f),this.firestore,this.aE)},t.prototype.orderBy=function(e,n){var r;if(hr("Query.orderBy",arguments,1,2),fr("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new p(l.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}if(null!==this.IE.startAt)throw new p(l.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.IE.endAt)throw new p(l.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Kr("Query.orderBy",e),o=new Lt(i,r);return this.AE(o),new t(this.IE.zt(o),this.firestore,this.aE)},t.prototype.limit=function(e){return ur("Query.limit",arguments,1),cr("Query.limit","number",1,e),Er("Query.limit",1,e),new t(this.IE.Ht(e),this.firestore,this.aE)},t.prototype.limitToLast=function(e){return ur("Query.limitToLast",arguments,1),cr("Query.limitToLast","number",1,e),Er("Query.limitToLast",1,e),new t(this.IE.Yt(e),this.firestore,this.aE)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ar("Query.startAt",arguments,1);var i=this.PE("Query.startAt",e,n,!0);return new t(this.IE.Jt(i),this.firestore,this.aE)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ar("Query.startAfter",arguments,1);var i=this.PE("Query.startAfter",e,n,!1);return new t(this.IE.Jt(i),this.firestore,this.aE)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ar("Query.endBefore",arguments,1);var i=this.PE("Query.endBefore",e,n,!0);return new t(this.IE.Xt(i),this.firestore,this.aE)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ar("Query.endAt",arguments,1);var i=this.PE("Query.endAt",e,n,!1);return new t(this.IE.Xt(i),this.firestore,this.aE)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw br("isEqual","Query",1,e);return this.firestore===e.firestore&&this.IE.isEqual(e.IE)},t.prototype.withConverter=function(e){return new t(this.IE,this.firestore,e)},t.prototype.PE=function(t,e,n,r){if(mr(t,1,e),e instanceof Gi){if(n.length>0)throw new p(l.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new p(l.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.VE(i.fE,r)}var o=[e].concat(n);return this.gE(t,o,r)},t.prototype.VE=function(t,e){for(var n=[],r=0,i=this.IE.orderBy;r<i.length;r++){var o=i[r];if(o.field.Y())n.push(W(this.firestore.Lc,t.key));else{var s=t.field(o.field);if(O(s))throw new p(l.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.j();throw new p(l.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new kt(n,e)},t.prototype.gE=function(t,e,n){var r=this.IE.Ot;if(e.length>r.length)throw new p(l.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.Y()){if("string"!=typeof s)throw new p(l.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.IE._e()&&-1!==s.indexOf("/"))throw new p(l.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.IE.path.child(_.K(s));if(!N.et(u))throw new p(l.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new N(u);i.push(W(this.firestore.Lc,a))}else{var h=this.firestore.XT.Mc(t,s);i.push(h)}}return new kt(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];hr("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||Pi(t[i])||(wr("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),pr("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),Pi(t[i])?n=t[i]:(cr("Query.onSnapshot","function",i,t[i]),fr("Query.onSnapshot","function",i+1,t[i+1]),fr("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.pE(this.IE),this.lE(r,n)},t.prototype.lE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Oi({next:function(t){e.next&&e.next(new Ki(n.firestore,n.IE,t,n.aE))},error:r}),o=this.firestore.jT(),s=o.listen(this.IE,i,t);return function(){i.kT(),o.al(s)}},t.prototype.pE=function(t){if(t.ae()&&0===t.Ot.length)throw new p(l.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},t.prototype.get=function(t){var e=this;return hr("Query.get",arguments,0,1),Qi("Query.get",t),this.pE(this.IE),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.jT().FT(e.IE).then((function(t){n(new Ki(e.firestore,e.IE,t,e.aE))}),r):e.dE(n,r,t)}))},t.prototype.dE=function(t,e,n){var r=this.lE({includeMetadataChanges:!0,Bf:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new p(l.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.RE=function(t){if("string"==typeof t){if(""===t)throw new p(l.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.IE._e()&&-1!==t.indexOf("/"))throw new p(l.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.IE.path.child(_.K(t));if(!N.et(e))throw new p(l.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return W(this.firestore.Lc,new N(e))}if(t instanceof Fi){var n=t;return W(this.firestore.Lc,n.xc)}throw new p(l.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+gr(t)+".")},t.prototype.wE=function(t,e){if(!Array.isArray(t)||0===t.length)throw new p(l.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new p(l.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new p(l.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new p(l.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.mE=function(t){if(t instanceof Tt){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.ue()){var o=this.IE.jt();if(null!==o&&!o.isEqual(t.field))throw new p(l.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.IE.Kt();null!==s&&this.yE(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.IE.ce(n)),null===u&&r&&(u=this.IE.ce(e)),null!=u)throw u===t.op?new p(l.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new p(l.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},t.prototype.AE=function(t){if(null===this.IE.Kt()){var e=this.IE.jt();null!==e&&this.yE(e,t.field)}},t.prototype.yE=function(t,e){if(!e.isEqual(t))throw new p(l.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Ki=function(){function t(t,e,n,r){this.hE=t,this.bE=e,this.vE=n,this.aE=r,this.SE=null,this.DE=null,this.metadata=new Bi(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.vE.docs.B()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.vE.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;hr("QuerySnapshot.forEach",arguments,1,2),cr("QuerySnapshot.forEach","function",1,t),this.vE.docs.forEach((function(r){t.call(e,n.CE(r))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new Wi(this.bE,this.hE,this.aE)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(wr("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),pr("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.vE.hs)throw new p(l.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.SE&&this.DE===e||(this.SE=function(t,e,n,r){if(n.ss.B()){var i=0;return n.docChanges.map((function(e){var o=new zi(t,e.doc.key,e.doc,n.fromCache,n.ns.has(e.doc.key),r);return e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}}))}var o=n.ss;return n.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var i=new zi(t,e.doc.key,e.doc,n.fromCache,n.ns.has(e.doc.key),r),s=-1,u=-1;return 0!==e.type&&(s=o.indexOf(e.doc.key),o=o.delete(e.doc.key)),1!==e.type&&(u=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:Zi(e.type),doc:i,oldIndex:s,newIndex:u}}))}(this.hE,e,this.vE,this.aE),this.DE=e),this.SE},t.prototype.isEqual=function(e){if(!(e instanceof t))throw br("isEqual","QuerySnapshot",1,e);return this.hE===e.hE&&this.bE.isEqual(e.bE)&&this.vE.isEqual(e.vE)&&this.aE===e.aE},t.prototype.CE=function(t){return new zi(this.hE,t.key,t,this.metadata.fromCache,this.vE.ns.has(t.key),this.aE)},t}(),Hi=function(t){function e(e,n,r){var i=this;if((i=t.call(this,_t.Wt(e),n,r)||this).FE=e,e.length%2!=1)throw new p(l.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.j()+" has "+e.length);return i}return i.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.IE.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.IE.path.M();return t.B()?null:new Fi(new N(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.IE.path.j()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(hr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Te.cn()),cr("CollectionReference.doc","non-empty string",1,t),""===t)throw new p(l.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=_.K(t);return Fi.nE(this.IE.path.child(e),this.firestore,this.aE)},e.prototype.add=function(t){ur("CollectionReference.add",arguments,1),cr("CollectionReference.add","object",1,this.aE?this.aE.toFirestore(t):t);var e=this.doc();return e.set(t).then((function(){return e}))},e.prototype.withConverter=function(t){return new e(this.FE,this.firestore,t)},e}(Wi);function Xi(t,e){if(void 0===e)return{merge:!1};if(wr(t,e,["merge","mergeFields"]),pr(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new p(l.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+gr(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new p(l.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+o+" was: "+gr(r[o]))}(t,"mergeFields",0,r,(function(t){return"string"==typeof t||t instanceof xr}))}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new p(l.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Yi(t,e){return void 0===e?{}:(wr(t,e,["serverTimestamps"]),dr(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Qi(t,e){fr(t,"object",1,e),e&&(wr(t,e,["source"]),dr(t,0,"source",e.source,["default","server","cache"]))}function Ji(t,e,n){if(e instanceof Fi){if(e.firestore!==n)throw new p(l.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw br(t,"DocumentReference",1,e)}function Zi(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return be()}}function $i(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}function to(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new p(l.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var eo=to(Ui,"Use firebase.firestore() instead."),no=to(qi,"Use firebase.firestore().runTransaction() instead."),ro=to(ji,"Use firebase.firestore().batch() instead."),io=to(Fi,"Use firebase.firestore().doc() instead."),oo=to(Gi),so=to(zi),uo=to(Wi),ao=to(Ki),ho=to(Hi,"Use firebase.firestore().collection() instead."),co=to(function(){function t(){}return t.delete=function(){return sr("FieldValue.delete",arguments),new Lr},t.serverTimestamp=function(){return sr("FieldValue.serverTimestamp",arguments),new Dr},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ar("FieldValue.arrayUnion",arguments,1),new Rr(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ar("FieldValue.arrayRemove",arguments,1),new Or(t)},t.increment=function(t){return cr("FieldValue.increment","number",1,t),ur("FieldValue.increment",arguments,1),new Pr(t)},t.prototype.isEqual=function(t){return this===t},t}(),"Use FieldValue.<field>() instead."),fo=to(Ar,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),lo={Firestore:eo,GeoPoint:Cr,Timestamp:w,Blob:fo,Transaction:no,WriteBatch:ro,DocumentReference:io,DocumentSnapshot:oo,Query:uo,QueryDocumentSnapshot:so,QuerySnapshot:ao,CollectionReference:ho,FieldPath:xr,FieldValue:co,setLogLevel:Ui.setLogLevel,CACHE_SIZE_UNLIMITED:Vi},po=function(){function t(){}return t.prototype.Q_=function(t){},t.prototype.Iu=function(){},t}(),yo=function(){function t(){var t=this;this.NE=function(){return t.kE()},this.$E=function(){return t.ME()},this.LE=[],this.xE()}return t.prototype.Q_=function(t){this.LE.push(t)},t.prototype.Iu=function(){window.removeEventListener("online",this.NE),window.removeEventListener("offline",this.$E)},t.prototype.xE=function(){window.addEventListener("online",this.NE),window.addEventListener("offline",this.$E)},t.prototype.kE=function(){ge("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.LE;t<e.length;t++)(0,e[t])(0)},t.prototype.ME=function(){ge("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.LE;t<e.length;t++)(0,e[t])(1)},t.so=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),vo=function(){function t(t){this.OE=t.OE,this.BE=t.BE}return t.prototype.n_=function(t){this.qE=t},t.prototype.Zc=function(t){this.UE=t},t.prototype.onMessage=function(t){this.QE=t},t.prototype.close=function(){this.BE()},t.prototype.send=function(t){this.OE(t)},t.prototype.WE=function(){this.qE()},t.prototype.jE=function(t){this.UE(t)},t.prototype.KE=function(t){this.QE(t)},t}(),go={BatchGetDocuments:"batchGet",Commit:"commit"},mo="gl-js/ fire/"+c,wo=function(){function t(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.GE=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.zE=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=mo},t.prototype.E_=function(t,e,n){var r=this,i=this.HE(t);return new Promise((function(o,s){var u=new h.XhrIo;u.listenOnce(h.EventType.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case h.ErrorCode.NO_ERROR:var e=u.getResponseJson();ge("Connection","XHR received:",JSON.stringify(e)),o(e);break;case h.ErrorCode.TIMEOUT:ge("Connection",'RPC "'+t+'" timed out'),s(new p(l.DEADLINE_EXCEEDED,"Request time out"));break;case h.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(ge("Connection",'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(l).indexOf(e)>=0?e:l.UNKNOWN}(r.status);s(new p(i,r.message))}else s(new p(l.UNKNOWN,"Server responded with status "+u.getStatus()))}else ge("Connection",'RPC "'+t+'" failed'),s(new p(l.UNAVAILABLE,"Connection failed."));break;default:be()}}finally{ge("Connection",'RPC "'+t+'" completed.')}}));var a=Object.assign({},e);delete a.database;var c=JSON.stringify(a);ge("Connection","XHR sending: ",i+" "+c);var f={"Content-Type":"text/plain"};r.zE(f,n),u.send(i,"POST",c,f,15)}))},t.prototype.I_=function(t,e,n){return this.E_(t,e,n)},t.prototype.r_=function(t,e){var n=[this.GE,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=h.createWebChannelTransport(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.zE(i.initMessageHeaders,e),u.isMobileCordova()||u.isReactNative()||u.isElectron()||u.isIE()||u.isUWP()||u.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");ge("Connection","Creating WebChannel: "+o+" "+i);var s=r.createWebChannel(o,i),a=!1,c=!1,f=new vo({OE:function(t){c?ge("Connection","Not sending because WebChannel is closed:",t):(a||(ge("Connection","Opening WebChannel transport."),s.open(),a=!0),ge("Connection","WebChannel sending:",t),s.send(t))},BE:function(){return s.close()}}),d=function(t,e){s.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return d(h.WebChannel.EventType.OPEN,(function(){c||ge("Connection","WebChannel transport opened.")})),d(h.WebChannel.EventType.CLOSE,(function(){c||(c=!0,ge("Connection","WebChannel transport closed"),f.jE())})),d(h.WebChannel.EventType.ERROR,(function(t){c||(c=!0,ge("Connection","WebChannel transport errored:",t),f.jE(new p(l.UNAVAILABLE,"The operation could not be completed")))})),d(h.WebChannel.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];Ee(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){ge("Connection","WebChannel received error:",i);var o=i.status,u=function(t){var e=yt[t];if(void 0!==e)return Pt(e)}(o),a=i.message;void 0===u&&(u=l.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),c=!0,f.jE(new p(u,a)),s.close()}else ge("Connection","WebChannel received:",n),f.KE(n)}})),setTimeout((function(){f.WE()}),0),f},t.prototype.HE=function(t){var e=go[t];return this.GE+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},t}();function bo(t){!function(t,e){t.INTERNAL.registerComponent(new a.Component("firestore",(function(t){return function(t,e){return new Ui(t,e,new Di)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},lo)))}(t),t.registerVersion("@firebase/firestore","1.14.3")}pe.an(new(function(){function t(){this._c="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.bT=function(t){return Promise.resolve(new wo(t))},t.prototype.AT=function(){return yo.so()?new yo:new po},t.prototype.Dc=function(t){return new fe(t,{hi:!0})},t.prototype.un=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t.prototype._n=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n},t}())),bo(o),e.__PRIVATE_registerFirestore=bo},42:function(t,e,n){"use strict";n.r(e),function(t){function r(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}n.d(e,"ErrorCode",(function(){return Qn})),n.d(e,"EventType",(function(){return Jn})),n.d(e,"WebChannel",(function(){return Zn})),n.d(e,"XhrIo",(function(){return $n})),n.d(e,"createWebChannelTransport",(function(){return Yn}));var i,o="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},s=s||{},u=o||self;function a(){}function h(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function c(t){var e=h(t);return"array"==e||"object"==e&&"number"==typeof t.length}function f(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var l="closure_uid_"+(1e9*Math.random()>>>0),p=0;function d(t,e,n){return t.call.apply(t.bind,arguments)}function y(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function v(t,e,n){return(v=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?d:y).apply(null,arguments)}function g(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var m=Date.now||function(){return+new Date};function w(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function b(){this.j=this.j,this.i=this.i}b.prototype.j=!1,b.prototype.da=function(){if(!this.j&&(this.j=!0,this.C(),0))(function(t){Object.prototype.hasOwnProperty.call(t,l)&&t[l]||(t[l]=++p)})(this)},b.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var E=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},_=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"===typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function T(t){return Array.prototype.concat.apply([],arguments)}function I(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function N(t){return/^[\s\xa0]*$/.test(t)}var A,x=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function S(t,e){return-1!=t.indexOf(e)}function k(t,e){return t<e?-1:t>e?1:0}t:{var L=u.navigator;if(L){var D=L.userAgent;if(D){A=D;break t}}A=""}function R(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function O(t){var e={};for(var n in t)e[n]=t[n];return e}var P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<P.length;o++)n=P[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function V(t){return V[" "](t),t}V[" "]=a;var M,U=S(A,"Opera"),q=S(A,"Trident")||S(A,"MSIE"),j=S(A,"Edge"),F=j||q,B=S(A,"Gecko")&&!(S(A.toLowerCase(),"webkit")&&!S(A,"Edge"))&&!(S(A,"Trident")||S(A,"MSIE"))&&!S(A,"Edge"),G=S(A.toLowerCase(),"webkit")&&!S(A,"Edge");function z(){var t=u.document;return t?t.documentMode:void 0}t:{var W="",K=function(){var t=A;return B?/rv:([^\);]+)(\)|;)/.exec(t):j?/Edge\/([\d\.]+)/.exec(t):q?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):G?/WebKit\/(\S+)/.exec(t):U?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(K&&(W=K?K[1]:""),q){var H=z();if(null!=H&&H>parseFloat(W)){M=String(H);break t}}M=W}var X,Y={};function Q(t){return function(t,e){var n=Y;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=x(String(M)).split("."),r=x(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=k(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||k(0==s[2].length,0==u[2].length)||k(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}if(u.document&&q){var J=z();X=J||(parseInt(M,10)||void 0)}else X=void 0;var Z=X,$=!q||9<=Number(Z),tt=q&&!Q("9"),et=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",a,e),u.removeEventListener("test",a,e)}catch(n){}return t}();function nt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function rt(t,e){if(nt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(B){t:{try{V(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:it[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}nt.prototype.b=function(){this.defaultPrevented=!0},w(rt,nt);var it={2:"touch",3:"pen",4:"mouse"};rt.prototype.b=function(){rt.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,tt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var ot="closure_listenable_"+(1e6*Math.random()|0),st=0;function ut(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++st,this.V=this.X=!1}function at(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function ht(t){this.src=t,this.a={},this.b=0}function ct(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=E(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(at(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ft(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}ht.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=ft(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new ut(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var lt="closure_lm_"+(1e6*Math.random()|0),pt={};function dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=_t(r),e&&e[ot]?e.sa(n,r,f(i)?!!i.capture:!!i,o):yt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)dt(t,e[o],n,r,i);return null}return n=_t(n),t&&t[ot]?t.ra(e,n,f(r)?!!r.capture:!!r,i):yt(t,e,n,!1,r,i)}function yt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=f(i)?!!i.capture:!!i;if(s&&!$)return null;var u=bt(t);if(u||(t[lt]=u=new ht(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=wt,e=$?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(gt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function vt(t){if("number"!==typeof t&&t&&!t.V){var e=t.src;if(e&&e[ot])ct(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(gt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=bt(e))?(ct(n,t),0==n.b&&(n.src=null,e[lt]=null)):at(t)}}}function gt(t){return t in pt?pt[t]:pt[t]="on"+t}function mt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&vt(t),n.call(r,e)}function wt(t,e){if(t.V)return!0;if(!$){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return mt(t,e=new rt(e,this))}return mt(t,new rt(e,this))}function bt(t){return(t=t[lt])instanceof ht?t:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function _t(t){return"function"==h(t)?t:(t[Et]||(t[Et]=function(e){return t.handleEvent(e)}),t[Et])}function Tt(){b.call(this),this.c=new ht(this),this.J=this,this.A=null}function It(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var u=s.listener,a=s.aa||s.src;s.X&&ct(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}w(Tt,b),Tt.prototype[ot]=!0,(i=Tt.prototype).addEventListener=function(t,e,n,r){dt(this,t,e,n,r)},i.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=f(i)?!!i.capture:!!i,r=_t(r),e&&e[ot]?(e=e.c,(n=String(n).toString())in e.a&&(-1<(r=ft(s=e.a[n],r,i,o))&&(at(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--)))):e&&(e=bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=ft(n,r,i,o)),(r=-1<e?n[e]:null)&&vt(r))}(this,t,e,n,r)},i.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"===typeof t)t=new nt(t,n);else if(t instanceof nt)t.target=t.target||n;else{var i=t;C(t=new nt(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=It(s,r,!0,t)&&i}if(i=It(s=t.a=n,r,!0,t)&&i,i=It(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=It(s=t.a=e[o],r,!1,t)&&i;return i},i.C=function(){if(Tt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)at(n[r]);delete e.a[t],e.b--}}this.A=null},i.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},i.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Nt=u.JSON.stringify;function At(){this.b=this.a=null}var xt,St=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Lt}),(function(t){t.reset()}),100);function kt(){var t=Pt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Lt(){this.next=this.b=this.a=null}function Dt(t){u.setTimeout((function(){throw t}),0)}function Rt(t,e){xt||function(){var t=u.Promise.resolve(void 0);xt=function(){t.then(Ct)}}(),Ot||(xt(),Ot=!0),Pt.add(t,e)}At.prototype.add=function(t,e){var n=St.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Lt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Lt.prototype.reset=function(){this.next=this.b=this.a=null};var Ot=!1,Pt=new At;function Ct(){for(var t;t=kt();){try{t.a.call(t.b)}catch(n){Dt(n)}var e=St;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}Ot=!1}function Vt(t,e){Tt.call(this),this.b=t||1,this.a=e||u,this.f=v(this.Ua,this),this.g=m()}function Mt(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Ut(t,e,n){if("function"==h(t))n&&(t=v(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=v(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function qt(t,e,n){b.call(this),this.f=null!=n?v(t,n):t,this.c=e,this.b=v(this.Pa,this),this.a=[]}function jt(t){t.T=Ut(t.b,t.c),t.f.apply(null,t.a)}function Ft(t){b.call(this),this.b=t,this.a={}}w(Vt,Tt),(i=Vt.prototype).Z=!1,i.L=null,i.Ua=function(){if(this.Z){var t=m()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(Mt(this),this.start()))}},i.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=m())},i.C=function(){Vt.M.C.call(this),Mt(this),delete this.a},w(qt,b),(i=qt.prototype).ba=!1,i.T=null,i.Ia=function(t){this.a=arguments,this.T?this.ba=!0:jt(this)},i.C=function(){qt.M.C.call(this),this.T&&(u.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},i.Pa=function(){this.T=null,this.ba&&(this.ba=!1,jt(this))},w(Ft,b);var Bt=[];function Gt(t,e,n,r){Array.isArray(n)||(n&&(Bt[0]=n.toString()),n=Bt);for(var i=0;i<n.length;i++){var o=dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function zt(t){R(t.a,(function(t,e){this.a.hasOwnProperty(e)&&vt(t)}),t),t.a={}}function Wt(){}Ft.prototype.C=function(){Ft.M.C.call(this),zt(this)},Ft.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Kt=null;function Ht(){return Kt=Kt||new Tt}function Xt(t){nt.call(this,"serverreachability",t)}function Yt(t){var e=Ht();e.dispatchEvent(new Xt(e,t))}function Qt(t){nt.call(this,"statevent",t)}function Jt(t){var e=Ht();e.dispatchEvent(new Qt(e,t))}function Zt(t){nt.call(this,"timingevent",t)}function $t(t,e){if("function"!=h(t))throw Error("Fn must not be null and must be a function");return u.setTimeout((function(){t()}),e)}w(Xt,nt),w(Qt,nt),w(Zt,nt);var te={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},ee={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function ne(){}function re(t){var e;return(e=t.a)||(e=t.a={}),e}function ie(){}ne.prototype.a=null;var oe,se={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function ue(){nt.call(this,"d")}function ae(){nt.call(this,"c")}function he(){}function ce(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new Ft(this),this.N=fe,t=F?125:void 0,this.O=new Vt(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}w(ue,nt),w(ae,nt),w(he,ne),oe=new he;var fe=45e3,le={},pe={};function de(t,e,n){t.B=1,t.f=Ve(Le(e)),t.j=n,t.F=!0,ye(t,null)}function ye(t,e){t.s=m(),me(t),t.A=Le(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),Ye(n.b,"t",r),t.w=0,t.a=Fn(t.g,t.g.w?e:null),0<t.J&&(t.D=new qt(v(t.ya,t,t.a),t.J)),Gt(t.G,t.a,"readystatechange",t.Sa),e=t.m?O(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),Yt(1)}function ve(t,e,n){for(var r=!0;!t.l&&t.w<n.length;){var i=ge(t,n);if(i==pe){4==e&&(t.c=4,Jt(14),r=!1);break}if(i==le){t.c=4,Jt(15),r=!1;break}Te(t,i)}4==e&&0==n.length&&(t.c=1,Jt(16),r=!1),t.b=t.b&&r,r||(_e(t),Ee(t))}function ge(t,e){var n=t.w,r=e.indexOf("\n",n);return-1==r?pe:(n=Number(e.substring(n,r)),isNaN(n)?le:(r+=1)+n>e.length?pe:(e=e.substr(r,n),t.w=r+n,e))}function me(t){t.P=m()+t.N,we(t,t.N)}function we(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=$t(v(t.Qa,t),e)}function be(t){t.h&&(u.clearTimeout(t.h),t.h=null)}function Ee(t){0==t.g.u||t.l||Vn(t.g,t)}function _e(t){be(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,Mt(t.O),zt(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Te(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||nn(n.b,t)))if(n.A=t.H,!t.o&&nn(n.b,t)&&3==n.u){try{var r=n.ja.a.parse(e)}catch(y){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;Cn(n),n.a.cancel(),n.a=null}Pn(n),Jt(18)}}else n.ia=i[1],0<n.ia-n.G&&37500>i[2]&&n.U&&0==n.m&&!n.l&&(n.l=$t(v(n.Na,n),6e3));if(1>=en(n.b)&&n.O){try{n.O()}catch(y){}n.O=void 0}}else Un(n,11)}else if((t.o||n.a==t)&&Cn(n),!N(e))for(e=r=n.ja.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.G=i[0],i=i[1],2==n.u)if("c"==i[0]){n.B=i[1],n.R=i[2];var o=i[3];null!=o&&(n.oa=o);var s=i[5];null!=s&&"number"===typeof s&&0<s&&(n.D=1.5*s);var u=n,a=t.a;if(a){var h=a.a?a.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var c=u.b;!c.a&&(S(h,"spdy")||S(h,"quic")||S(h,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(rn(c,c.b),c.b=null))}if(u.s){var f=a.a?a.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.ha=f,Ce(u.v,u.s,f))}}n.u=3,n.c&&n.c.na();var l=t;if((u=n).ea=jn(u,u.w?u.R:null,u.P),l.o){on(u.b,l);var p=l,d=u.D;d&&p.setTimeout(d),p.h&&(be(p),me(p)),u.a=l}else On(u);0<n.f.length&&kn(n)}else"stop"!=i[0]&&"close"!=i[0]||Un(n,7);else 3==n.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Un(n,7):An(n):"noop"!=i[0]&&n.c&&n.c.ma(i),n.m=0);Yt(4)}catch(y){}}function Ie(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(c(t)||"string"===typeof t)_(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(c(t)||"string"===typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"===typeof t)return t.split("");if(c(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ne(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ne)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ae(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)xe(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(i=ce.prototype).setTimeout=function(t){this.N=t},i.Sa=function(t){t=t.target;var e=this.D;e&&3==_n(t)?e.Ia():this.ya(t)},i.ya=function(t){try{if(t==this.a)t:{var e=_n(this.a),n=this.a.qa(),r=this.a.S();if(!(3>e||3==e&&!F&&!this.a.Y())){this.l||4!=e||7==n||Yt(8==n||0>=r?3:2),be(this);var i=this.a.S();this.H=i;var o=this.a.Y();if(this.b=200==i){if(this.R&&!this.o){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,Jt(12),_e(this),Ee(this);break t}this.o=!0,Te(this,a)}this.F?(ve(this,e,o),F&&this.b&&3==e&&(Gt(this.G,this.O,"tick",this.Ra),this.O.start())):Te(this,o),4==e&&_e(this),this.b&&!this.l&&(4==e?Vn(this.g,this):(this.b=!1,me(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,Jt(12)):(this.c=0,Jt(13)),_e(this),Ee(this)}}}catch(h){}},i.Ra=function(){if(this.a){var t=_n(this.a),e=this.a.Y();this.w<e.length&&(be(this),ve(this,t,e),this.b&&4!=t&&me(this))}},i.cancel=function(){this.l=!0,_e(this)},i.Qa=function(){this.h=null;var t=m();0<=t-this.P?(2!=this.B&&(Yt(3),Jt(17)),_e(this),this.c=2,Ee(this)):we(this,this.P-t)},(i=Ne.prototype).I=function(){Ae(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},i.K=function(){return Ae(this),this.a.concat()},i.get=function(t,e){return xe(this.b,t)?this.b[t]:e},i.set=function(t,e){xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},i.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Se=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ke(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof ke){this.a=void 0!==e?e:t.a,De(this,t.f),this.j=t.j,Re(this,t.c),Oe(this,t.h),this.g=t.g,e=t.b;var n=new We;n.c=e.c,e.a&&(n.a=new Ne(e.a),n.b=e.b),Pe(this,n),this.i=t.i}else t&&(n=String(t).match(Se))?(this.a=!!e,De(this,n[1]||"",!0),this.j=Me(n[2]||""),Re(this,n[3]||"",!0),Oe(this,n[4]),this.g=Me(n[5]||"",!0),Pe(this,n[6]||"",!0),this.i=Me(n[7]||"")):(this.a=!!e,this.b=new We(null,this.a))}function Le(t){return new ke(t)}function De(t,e,n){t.f=n?Me(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Re(t,e,n){t.c=n?Me(e,!0):e}function Oe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Pe(t,e,n){e instanceof We?(t.b=e,function(t,e){e&&!t.f&&(Ke(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(He(this,e),Ye(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Ue(e,Ge)),t.b=new We(e,t.a))}function Ce(t,e,n){t.b.set(e,n)}function Ve(t){return Ce(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^m()).toString(36)),t}function Me(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ue(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,qe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function qe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ue(e,je,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Ue(e,je,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ue(n,"/"==n.charAt(0)?Be:Fe,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ue(n,ze)),t.join("")};var je=/[#\/\?@]/g,Fe=/[#\?:]/g,Be=/[#\?]/g,Ge=/[#\?@]/g,ze=/#/g;function We(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Ke(t){t.a||(t.a=new Ne,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function He(t,e){Ke(t),e=Qe(t,e),xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ae(t)))}function Xe(t,e){return Ke(t),e=Qe(t,e),xe(t.a.b,e)}function Ye(t,e,n){He(t,e),0<n.length&&(t.c=null,t.a.set(Qe(t,e),I(n)),t.b+=n.length)}function Qe(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Je(t,e){this.b=t,this.a=e}function Ze(t){this.g=t||$e,u.PerformanceNavigationTiming?t=0<(t=u.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(u.ca&&u.ca.ua&&u.ca.ua()&&u.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(i=We.prototype).add=function(t,e){Ke(this),this.c=null,t=Qe(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},i.forEach=function(t,e){Ke(this),this.a.forEach((function(n,r){_(n,(function(n){t.call(e,n,r,this)}),this)}),this)},i.K=function(){Ke(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},i.I=function(t){Ke(this);var e=[];if("string"===typeof t)Xe(this,t)&&(e=T(e,this.a.get(Qe(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=T(e,t[n])}return e},i.set=function(t,e){return Ke(this),this.c=null,Xe(this,t=Qe(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},i.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},i.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.I(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var $e=10;function tn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function en(t){return t.b?1:t.a?t.a.size:0}function nn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function rn(t,e){t.a?t.a.add(e):t.b=e}function on(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function sn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null!=t.a&&0!==t.a.size){var i=t.c;try{for(var o=r(t.a.values()),s=o.next();!s.done;s=o.next()){var u=s.value;i=i.concat(u.i)}}catch(a){e={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return i}return I(t.c)}function un(){}function an(){this.a=new un}function hn(t,e,n){var r=n||"";try{Ie(t,(function(t,n){var i=t;f(t)&&(i=Nt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function cn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Ze.prototype.cancel=function(){var t,e;if(this.c=sn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=r(this.a.values()),i=n.next();!i.done;i=n.next()){i.value.cancel()}}catch(o){t={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},un.prototype.stringify=function(t){return u.JSON.stringify(t,void 0)},un.prototype.parse=function(t){return u.JSON.parse(t,void 0)};var fn=u.JSON.parse;function ln(t){Tt.call(this),this.headers=new Ne,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=pn,this.B=this.F=!1}w(ln,Tt);var pn="",dn=/^https?$/i,yn=["POST","PUT"];function vn(t){return"content-type"==t.toLowerCase()}function gn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,mn(t),bn(t)}function mn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function wn(t){if(t.b&&"undefined"!=typeof s&&(!t.s[1]||4!=_n(t)||2!=t.S()))if(t.l&&4==_n(t))Ut(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==_n(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.D).match(Se)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!dn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var h=2<_n(t)?t.a.statusText:""}catch(c){h=""}t.f=h+" ["+t.S()+"]",mn(t)}}finally{bn(t)}}}function bn(t,e){if(t.a){En(t);var n=t.a,r=t.s[0]?a:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function En(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(u.clearTimeout(t.m),t.m=null)}function _n(t){return t.a?t.a.readyState:0}function Tn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return R(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):Ce(t,e,n))}function In(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Nn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=In("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=In("baseRetryDelayMs",5e3,t),this.Ga=In("retryDelaySeedMs",1e4,t),this.Da=In("forwardChannelMaxRetries",2,t),this.ga=In("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new Ze(t&&t.concurrentRequestLimit),this.ja=new an,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function An(t){if(xn(t),3==t.u){var e=t.H++,n=Le(t.v);Ce(n,"SID",t.B),Ce(n,"RID",e),Ce(n,"TYPE","terminate"),Dn(t,n),(e=new ce(t,e,void 0)).B=2,e.f=Ve(Le(n)),n=!1,u.navigator&&u.navigator.sendBeacon&&(n=u.navigator.sendBeacon(e.f.toString(),"")),!n&&u.Image&&((new Image).src=e.f,n=!0),n||(e.a=Fn(e.g,null),e.a.$(e.f)),e.s=m(),me(e)}qn(t)}function xn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(u.clearTimeout(t.i),t.i=null),Cn(t),t.b.cancel(),t.g&&("number"===typeof t.g&&u.clearTimeout(t.g),t.g=null)}function Sn(t,e){t.f.push(new Je(t.Fa++,e)),3==t.u&&kn(t)}function kn(t){tn(t.b)||t.g||(t.g=!0,Rt(t.xa,t),t.o=0)}function Ln(t,e){var n;n=e?e.W:t.H++;var r=Le(t.v);Ce(r,"SID",t.B),Ce(r,"RID",n),Ce(r,"AID",t.G),Dn(t,r),t.h&&t.j&&Tn(r,t.h,t.j),n=new ce(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Rn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),rn(t.b,n),de(n,r,e)}function Dn(t,e){t.c&&Ie({},(function(t,n){Ce(e,n,t)}))}function Rn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?v(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if(0>(h-=o))o=Math.max(0,i[a].b-100),u=!1;else try{hn(c,s,"req"+h+"_")}catch(f){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function On(t){t.a||t.i||(t.J=1,Rt(t.wa,t),t.m=0)}function Pn(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=$t(v(t.wa,t),Mn(t,t.m)),t.m++,!0)}function Cn(t){null!=t.l&&(u.clearTimeout(t.l),t.l=null)}function Vn(t,e){var n=null;if(t.a==e){Cn(t),t.a=null;var r=2}else{if(!nn(t.b,e))return;n=e.i,on(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==r){n=e.j?e.j.length:0,e=m()-e.s;var i=t.o;(r=Ht()).dispatchEvent(new Zt(r,n,e,i)),kn(t)}else On(t);else if(3==(i=e.c)||0==i&&0<t.A||!(1==r&&function(t,e){return!(en(t.b)>=t.b.f-(t.g?1:0))&&(t.g?(t.f=e.i.concat(t.f),!0):!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da))&&(t.g=$t(v(t.xa,t,e),Mn(t,t.o)),t.o++,!0))}(t,e)||2==r&&Pn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Un(t,5);break;case 4:Un(t,10);break;case 3:Un(t,6);break;default:Un(t,2)}}function Mn(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function Un(t,e){if(2==e){var n=null;t.c&&(n=null);var r=v(t.Ta,t);n||(n=new ke("//www.google.com/images/cleardot.gif"),u.location&&"http"==u.location.protocol||De(n,"https"),Ve(n)),function(t,e){var n=new Wt;if(u.Image){var r=new Image;r.onload=g(cn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=g(cn,n,r,"TestLoadImage: error",!1,e),r.onabort=g(cn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=g(cn,n,r,"TestLoadImage: timeout",!1,e),u.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Jt(2);t.u=0,t.c&&t.c.la(e),qn(t),xn(t)}function qn(t){t.u=0,t.A=-1,t.c&&(0==sn(t.b).length&&0==t.f.length||(t.b.c.length=0,I(t.f),t.f.length=0),t.c.ka())}function jn(t,e,n){var r=function(t){return t instanceof ke?Le(t):new ke(t,void 0)}(n);if(""!=r.c)e&&Re(r,e+"."+r.c),Oe(r,r.h);else{var i=u.location;r=function(t,e,n,r){var i=new ke(null,void 0);return t&&De(i,t),e&&Re(i,e),n&&Oe(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.N&&R(t.N,(function(t,e){Ce(r,e,t)})),e=t.s,n=t.ha,e&&n&&Ce(r,e,n),Ce(r,"VER",t.oa),Dn(t,r),r}function Fn(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new ln(t.Ea)).F=t.w,e}function Bn(){}function Gn(){if(q&&!(10<=Number(Z)))throw Error("Environmental error: no available transport.")}function zn(t,e){Tt.call(this),this.a=new Nn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!N(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!N(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Hn(this)}function Wn(t){ue.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Kn(){ae.call(this),this.status=1}function Hn(t){this.a=t}(i=ln.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?re(this.G):re(oe),this.a.onreadystatechange=v(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(o){return void gn(this,o)}t=n||"";var i=new Ne(this.headers);r&&Ie(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=vn,n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}(i.K()),n=u.FormData&&t instanceof u.FormData,!(0<=E(yn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{En(this),0<this.o&&((this.B=function(t){return q&&Q(9)&&"number"===typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=v(this.ta,this)):this.m=Ut(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){gn(this,o)}},i.ta=function(){"undefined"!=typeof s&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},i.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),bn(this))},i.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),bn(this,!0)),ln.M.C.call(this)},i.va=function(){this.j||(this.w||this.l||this.g?wn(this):this.Oa())},i.Oa=function(){wn(this)},i.S=function(){try{return 2<_n(this)?this.a.status:-1}catch(t){return-1}},i.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},i.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),fn(e)}},i.qa=function(){return this.h},i.Ma=function(){return"string"===typeof this.f?this.f:String(this.f)},(i=Nn.prototype).oa=8,i.u=1,i.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random());var e,n=new ce(this,t=this.H++,void 0),r=this.j;if(this.F&&(r?C(r=O(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"===typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Rn(this,n,e),Ce(i=Le(this.v),"RID",t),Ce(i,"CVER",22),this.s&&Ce(i,"X-HTTP-Session-Id",this.s),Dn(this,i),this.h&&r&&Tn(i,this.h,r),rn(this.b,n),this.fa?(Ce(i,"$req",e),Ce(i,"SID","null"),n.R=!0,de(n,i,null)):de(n,i,e),this.u=2}}else 3==this.u&&(t?Ln(this,t):0==this.f.length||tn(this.b)||Ln(this))},i.wa=function(){this.i=null,this.a=new ce(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Le(this.ea);Ce(t,"RID","rpc"),Ce(t,"SID",this.B),Ce(t,"CI",this.U?"0":"1"),Ce(t,"AID",this.G),Dn(this,t),Ce(t,"TYPE","xmlhttp"),this.h&&this.j&&Tn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=Ve(Le(t)),e.j=null,e.F=!0,ye(e,n)},i.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,Pn(this),Jt(19))},i.Ta=function(t){Jt(t?2:1)},(i=Bn.prototype).na=function(){},i.ma=function(){},i.la=function(){},i.ka=function(){},i.Ha=function(){},Gn.prototype.a=function(t,e){return new zn(t,e)},w(zn,Tt),(i=zn.prototype).addEventListener=function(t,e,n,r){zn.M.addEventListener.call(this,t,e,n,r)},i.removeEventListener=function(t,e,n,r){zn.M.removeEventListener.call(this,t,e,n,r)},i.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;Jt(0),t.P=e,t.N=n||{},t.U=t.W,t.v=jn(t,null,t.P),kn(t)},i.close=function(){An(this.a)},i.La=function(t){if("string"===typeof t){var e={};e.__data__=t,Sn(this.a,e)}else this.g?((e={}).__data__=Nt(t),Sn(this.a,e)):Sn(this.a,t)},i.C=function(){this.a.c=null,delete this.f,An(this.a),delete this.a,zn.M.C.call(this)},w(Wn,ue),w(Kn,ae),w(Hn,Bn),Hn.prototype.na=function(){this.a.dispatchEvent("a")},Hn.prototype.ma=function(t){this.a.dispatchEvent(new Wn(t))},Hn.prototype.la=function(t){this.a.dispatchEvent(new Kn(t))},Hn.prototype.ka=function(){this.a.dispatchEvent("b")},Gn.prototype.createWebChannel=Gn.prototype.a,zn.prototype.send=zn.prototype.La,zn.prototype.open=zn.prototype.Ka,zn.prototype.close=zn.prototype.close,te.NO_ERROR=0,te.TIMEOUT=8,te.HTTP_ERROR=6,ee.COMPLETE="complete",ie.EventType=se,se.OPEN="a",se.CLOSE="b",se.ERROR="c",se.MESSAGE="d",Tt.prototype.listen=Tt.prototype.ra,ln.prototype.listenOnce=ln.prototype.sa,ln.prototype.getLastError=ln.prototype.Ma,ln.prototype.getLastErrorCode=ln.prototype.qa,ln.prototype.getStatus=ln.prototype.S,ln.prototype.getResponseJson=ln.prototype.Ja,ln.prototype.getResponseText=ln.prototype.Y,ln.prototype.send=ln.prototype.$;var Xn={createWebChannelTransport:function(){return new Gn},ErrorCode:te,EventType:ee,WebChannel:ie,XhrIo:ln},Yn=Xn.createWebChannelTransport,Qn=Xn.ErrorCode,Jn=Xn.EventType,Zn=Xn.WebChannel,$n=Xn.XhrIo;e.default=Xn}.call(this,n(23))},48:function(t,e,n){"use strict";n.r(e);n(41)}}]);
//# sourceMappingURL=5.21dff40f.chunk.js.map